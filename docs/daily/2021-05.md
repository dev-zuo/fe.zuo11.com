# 2021年05月技术日常
## 2021/05/27 
### nginx emerg bind to 0.0.0.0:80 failed <10013:
## 2021/05/16
### MVC 与 MVVM 的理解
## 2021/05/15
### spring-boot 解决跨域问题
### data 无法定义下划线开头的变量
在 vue 中，如果 data 中定义了以下划线开头的变量名，是无法获取到值的，一直是 undefined，为什么会这样呢？

在官方文档 API 中有搜索 data 可以查到: **以 _ 或 $ 开头的 property 不会被 Vue 实例代理，因为它们可能和 Vue 内置的 property、API 方法冲突**

![vue_data_property.png](/images/daily/vue_data_property.png)

另外，如果项目中开启了 ESLint 会自动提示该错误 "vue/no-reserved-keys" 不能使用保留关键字，如下图：

![data_reserved_eslint.png](/images/daily/data_reserved_eslint.png)

因此 ESLint 比我们想象的更加实用，它不仅仅只是单纯的 JS 语法检查。

### mac 其他文件占用很多，使用柠檬清理
mac 存储空间里面的其他文件占用较多，它主要是一些碎片文件、缓存等，一般不通过工具软件很难清理。如下图：

![macos_disk_other.png](/images/daily/macos_disk_other.png)

mac 清理工具中，CleanMyMac 算是比较知名的一个，但它是收费的，这里介绍一款国产免费的清理工具 - [腾讯柠檬清理](https://lemon.qq.com/)

![ningmeng_clear.png.png](/images/daily/ningmeng_clear.png)

关于柠檬清理与其他同类产品的对比，官方写了一遍总结，可以看看 [腾讯柠檬清理，真的比CleanMyMac好用么？](https://lemon.qq.com/blog/articles/004-lemon-vs-cleanmymac.html)
## 2021/05/10 
### if 或函数嵌套层级较多时通过改变代码组织方式减少代码嵌套
在 if 或函数嵌套层级较多，代码会逐渐变的不好理解、维护。一般可以通过改变代码组织方式，来减少代码嵌套层级，这里主要介绍下面几种方法：
1. 将嵌套的匿名函数赋值到一个变量中，变为命名函数，减少函数内代码的嵌套层级
2. if 优化，逻辑假时 true，减少 if 中包含大量代码的情况
3. 使用三元运算符减少 if 层级
4. 使用逻辑运算符减少 if 层级
5. 使用策略模式减少 if、else 层级

来看一个简单的例子，在 vue 实例中，watch 深度监听 userInfo 对象，里面的处理函数中有 if，有数组遍历函数，层级会比较深
```html
<script>
export default {
  data() {
    return {
      userInfo: {}
    };
  },
  watch: {
    userInfo: {
      handler(value) {
        if (value.name) {
          let indexMap = this.arrList.reduce(() => {
            console.log("test1");
            // 可能存在 if 或函数嵌套
          });

          this.list.forEach(item => {
            if (indexMap[item.index]) {
              console.log("test2");
            }
          });
        }
      },
      deep: true
    }
  }
};
</script>
```
下面来具体看减少代码嵌套层级的几种思路：

1. 匿名函数提取成变量

```js
if (condition) {
  let indexMap = this.arrList.reduce(() => {
    console.log("test1");
    // 可能存在的 if 或函数嵌套
  });
}

// 可以优化为下面这种，这样就避免了函数代码直接嵌套在 reduce 方法内部
if (condition) {
  const reduceFunc = () => {
    console.log("test1");
    // 可能存在的 if 或函数嵌套
  }
  let indexMap = this.arrList.reduce(reduceFunc);
}
```
2. if 优化，逻辑假时 true，减少 if 中包含大量代码的情况
```js
function func() {
  if (condition) {
    // 一大段代码
    // 可能存在 if 等嵌套层级的代码
  }
}
// 可以优化为下面这种，这样可以将一大段代码从 if (condition) 嵌套中解放出来
function func() {
  if (!condition) {
    return false // 条件不满足时结束函数
  }
  // 一大段代码
  // 可能存在 if 等嵌套层级的代码
}
```
3. 三元运算符
```js
function func() {
  let a = '1'
  if (b) {
    a = '2'
  }
}
// 可以优化为
function func() {
  let a = b ? '2' : '1'
}
```
4. 逻辑运算符
```js
function func() {
  if (callback) {
    callback()
  }
}
// 可以优化为
function func() {
  callback && callback()
}
```
5. 策略模式
```js
function func() {
  if (type === 'a') {
    // 执行内容 1
  } else if (type === 'b') {
    // 执行内容 2
  } else if (type === 'c') {
    // 执行内容 3
  }
  // 后续代码
}

// 使用策略模式优化
function func() {
  let handlerA = () => { console.log('执行内容1') }
  let handlerB = () => { console.log('执行内容2') }
  let handlerC = () => { console.log('执行内容3') }
  let handlerMap = {
    a: handlerA,
    b: handlerB,
    c: handlerC
  }
  handlerMap[type] && handlerMap[type]()
  // 后续代码
}
```
## 2021/05/04 周二
### Vscode Live Server 插件 Open With Live Server 没反应，无法打开浏览器
在调试单个 html 文件时，可以使用 Live Server 插件，快速开启 http 服务，并打开当前页面。

![live-server.png](/images/daily/live-server.png)

但目前这个插件可能会出现没反应，打不开的情况，可以使用 **Preview on Web Server** 来代替

![preview-on-server.png](/images/daily/preview-on-server.png)

使用方法基本一致，右键可以选择浏览器打开，或者在 vscode 侧边栏预览

![launch-on-browser.png](/images/daily/launch-on-browser.png)


### v-if 和 v-show 生命周期钩子函数有什么不同
在 vue 中我们知道 v-if 和 v-show 都可以用来控制内容的显示与隐藏，他们的区别是
1. v-if 是惰性加载，只有为 true 时，才真正渲染，否则页面是不存在该元素的。为 false 时，直接从 dom 移除。
2. v-show 是根据 css display 属性来显示和隐藏组件的

![v-show.gif](/images/daily/v-show.gif)

那么他们的生命周期钩子函数有什么区别呢？

1. v-show 控制隐藏或显示的组件，一进入就立即加载，执行 beforeCreate、created、beforeMount、mounted，中间切换显示和隐藏不会触发钩子函数
2. v-if 只有为 true 时，才会正常执行加载的钩子函数，否则不会加载。当切换时，实时挂载(created/mounted)、卸载组件(destoryed)。

使用场景：v-if 适合在 true、false 切换不频繁的场景，当为 false 时，可以减少初次渲染时间。如果切换很频繁 v-if 会不断的挂载、卸载组件，会加大开销，这时使用 v-show 就比较好，尽管它的初始开销会大一点。

