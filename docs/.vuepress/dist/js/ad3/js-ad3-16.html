<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>16. DOM2 和 DOM3 - JS高程4 | 左小白的前端笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="DOM1（DOM Level 1）主要定义了 HTML 和 XML 文档的底层结构。DOM2（DOM Level 2）和 DOM3 级则在这些结构的基础上加入了更多的交互能力，支持更高级的 XML 特性。DOM2 和 DOM3 是按照模块化的思路来定制标准的，每个模块之间有一定关联，但分别针对某个 DOM 子集，这些模式如下">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.b41fd11a.css" as="style"><link rel="preload" href="/assets/js/app.0bf21a3f.js" as="script"><link rel="preload" href="/assets/js/2.3f8a6b0b.js" as="script"><link rel="preload" href="/assets/js/76.0c3efae1.js" as="script"><link rel="preload" href="/assets/js/3.018b29e2.js" as="script"><link rel="prefetch" href="/assets/js/10.57230952.js"><link rel="prefetch" href="/assets/js/100.e578cf98.js"><link rel="prefetch" href="/assets/js/101.c335944d.js"><link rel="prefetch" href="/assets/js/102.59769da8.js"><link rel="prefetch" href="/assets/js/103.4919b623.js"><link rel="prefetch" href="/assets/js/104.7fe84002.js"><link rel="prefetch" href="/assets/js/105.ddedb83f.js"><link rel="prefetch" href="/assets/js/106.1fb63622.js"><link rel="prefetch" href="/assets/js/107.2b187808.js"><link rel="prefetch" href="/assets/js/108.8f3d5697.js"><link rel="prefetch" href="/assets/js/109.92d36734.js"><link rel="prefetch" href="/assets/js/11.9dc4d318.js"><link rel="prefetch" href="/assets/js/110.cd88ac77.js"><link rel="prefetch" href="/assets/js/111.12009e8d.js"><link rel="prefetch" href="/assets/js/112.e5c55eb4.js"><link rel="prefetch" href="/assets/js/113.4919bdd4.js"><link rel="prefetch" href="/assets/js/114.dcaf0907.js"><link rel="prefetch" href="/assets/js/115.ef10c8bf.js"><link rel="prefetch" href="/assets/js/116.ee1048fb.js"><link rel="prefetch" href="/assets/js/117.755e22c9.js"><link rel="prefetch" href="/assets/js/118.1ef0e114.js"><link rel="prefetch" href="/assets/js/119.6bf38fb4.js"><link rel="prefetch" href="/assets/js/12.40fc9c5a.js"><link rel="prefetch" href="/assets/js/120.b88059fa.js"><link rel="prefetch" href="/assets/js/121.41bab6f4.js"><link rel="prefetch" href="/assets/js/122.0f544020.js"><link rel="prefetch" href="/assets/js/123.77dd2a30.js"><link rel="prefetch" href="/assets/js/124.15b09dbe.js"><link rel="prefetch" href="/assets/js/125.513515e1.js"><link rel="prefetch" href="/assets/js/126.ddc5a463.js"><link rel="prefetch" href="/assets/js/127.fc469abf.js"><link rel="prefetch" href="/assets/js/128.e6e3b457.js"><link rel="prefetch" href="/assets/js/129.1967580f.js"><link rel="prefetch" href="/assets/js/13.986f7498.js"><link rel="prefetch" href="/assets/js/130.42a72e18.js"><link rel="prefetch" href="/assets/js/131.7eb22a2c.js"><link rel="prefetch" href="/assets/js/132.34350e73.js"><link rel="prefetch" href="/assets/js/133.41fcbd8e.js"><link rel="prefetch" href="/assets/js/134.a0eee4de.js"><link rel="prefetch" href="/assets/js/135.36a70bf4.js"><link rel="prefetch" href="/assets/js/136.e7a92be5.js"><link rel="prefetch" href="/assets/js/137.fdea42b5.js"><link rel="prefetch" href="/assets/js/138.bbd75d1f.js"><link rel="prefetch" href="/assets/js/139.b995a099.js"><link rel="prefetch" href="/assets/js/14.1898890b.js"><link rel="prefetch" href="/assets/js/140.6d940105.js"><link rel="prefetch" href="/assets/js/141.9278b1f0.js"><link rel="prefetch" href="/assets/js/142.bb7a043f.js"><link rel="prefetch" href="/assets/js/143.0c428588.js"><link rel="prefetch" href="/assets/js/144.c9c789b3.js"><link rel="prefetch" href="/assets/js/145.9ad8dfa6.js"><link rel="prefetch" href="/assets/js/146.2759ffa3.js"><link rel="prefetch" href="/assets/js/147.fa54787f.js"><link rel="prefetch" href="/assets/js/148.983ee0a5.js"><link rel="prefetch" href="/assets/js/149.2f7704fe.js"><link rel="prefetch" href="/assets/js/15.5469b4a1.js"><link rel="prefetch" href="/assets/js/150.8d43e986.js"><link rel="prefetch" href="/assets/js/151.b5db9fb6.js"><link rel="prefetch" href="/assets/js/152.5b9728d4.js"><link rel="prefetch" href="/assets/js/153.6f0f7af8.js"><link rel="prefetch" href="/assets/js/154.6cb7fdcc.js"><link rel="prefetch" href="/assets/js/155.38d08870.js"><link rel="prefetch" href="/assets/js/156.6e034fca.js"><link rel="prefetch" href="/assets/js/157.1ca78d6e.js"><link rel="prefetch" href="/assets/js/158.b2fe456f.js"><link rel="prefetch" href="/assets/js/159.395b73d0.js"><link rel="prefetch" href="/assets/js/16.1191ebc2.js"><link rel="prefetch" href="/assets/js/160.e7676793.js"><link rel="prefetch" href="/assets/js/161.cd998bb1.js"><link rel="prefetch" href="/assets/js/162.fd413fe6.js"><link rel="prefetch" href="/assets/js/17.08eb5070.js"><link rel="prefetch" href="/assets/js/18.549c446f.js"><link rel="prefetch" href="/assets/js/19.c6c2139d.js"><link rel="prefetch" href="/assets/js/20.5e6c30dc.js"><link rel="prefetch" href="/assets/js/21.9f0ce5d2.js"><link rel="prefetch" href="/assets/js/22.59722d7f.js"><link rel="prefetch" href="/assets/js/23.886ef483.js"><link rel="prefetch" href="/assets/js/24.0d55fdfc.js"><link rel="prefetch" href="/assets/js/25.b513497e.js"><link rel="prefetch" href="/assets/js/26.38b016e3.js"><link rel="prefetch" href="/assets/js/27.51d9bd77.js"><link rel="prefetch" href="/assets/js/28.eebd8b4e.js"><link rel="prefetch" href="/assets/js/29.f81e9274.js"><link rel="prefetch" href="/assets/js/30.f8b68fed.js"><link rel="prefetch" href="/assets/js/31.84f7c8e8.js"><link rel="prefetch" href="/assets/js/32.ff88cb29.js"><link rel="prefetch" href="/assets/js/33.db9f818a.js"><link rel="prefetch" href="/assets/js/34.8528d11c.js"><link rel="prefetch" href="/assets/js/35.8bc50305.js"><link rel="prefetch" href="/assets/js/36.9bf7c6ff.js"><link rel="prefetch" href="/assets/js/37.fbced13e.js"><link rel="prefetch" href="/assets/js/38.2e4e4f00.js"><link rel="prefetch" href="/assets/js/39.fc6e9198.js"><link rel="prefetch" href="/assets/js/4.450bd9c8.js"><link rel="prefetch" href="/assets/js/40.9b113905.js"><link rel="prefetch" href="/assets/js/41.aa3d1bb9.js"><link rel="prefetch" href="/assets/js/42.154c7e55.js"><link rel="prefetch" href="/assets/js/43.05418d59.js"><link rel="prefetch" href="/assets/js/44.7d1b30f3.js"><link rel="prefetch" href="/assets/js/45.235bbacb.js"><link rel="prefetch" href="/assets/js/46.5df48da3.js"><link rel="prefetch" href="/assets/js/47.36b5639f.js"><link rel="prefetch" href="/assets/js/48.bfd892d3.js"><link rel="prefetch" href="/assets/js/49.a66a16bf.js"><link rel="prefetch" href="/assets/js/5.0322d224.js"><link rel="prefetch" href="/assets/js/50.78efb680.js"><link rel="prefetch" href="/assets/js/51.01901ccc.js"><link rel="prefetch" href="/assets/js/52.e6f696eb.js"><link rel="prefetch" href="/assets/js/53.0484ca91.js"><link rel="prefetch" href="/assets/js/54.737263db.js"><link rel="prefetch" href="/assets/js/55.b3d19b3e.js"><link rel="prefetch" href="/assets/js/56.e0a198b8.js"><link rel="prefetch" href="/assets/js/57.66a8fa47.js"><link rel="prefetch" href="/assets/js/58.07738bb5.js"><link rel="prefetch" href="/assets/js/59.192ce926.js"><link rel="prefetch" href="/assets/js/6.8b6802aa.js"><link rel="prefetch" href="/assets/js/60.dcdf7f83.js"><link rel="prefetch" href="/assets/js/61.28314073.js"><link rel="prefetch" href="/assets/js/62.6215c441.js"><link rel="prefetch" href="/assets/js/63.6008b1cd.js"><link rel="prefetch" href="/assets/js/64.3bc7d0de.js"><link rel="prefetch" href="/assets/js/65.db30ed35.js"><link rel="prefetch" href="/assets/js/66.d15f8a2e.js"><link rel="prefetch" href="/assets/js/67.0ced457a.js"><link rel="prefetch" href="/assets/js/68.b1ebe57b.js"><link rel="prefetch" href="/assets/js/69.c5e2e8e2.js"><link rel="prefetch" href="/assets/js/7.55c6af5e.js"><link rel="prefetch" href="/assets/js/70.9558cbe6.js"><link rel="prefetch" href="/assets/js/71.7bafeaae.js"><link rel="prefetch" href="/assets/js/72.11495184.js"><link rel="prefetch" href="/assets/js/73.f4583008.js"><link rel="prefetch" href="/assets/js/74.266c0400.js"><link rel="prefetch" href="/assets/js/75.564fdd78.js"><link rel="prefetch" href="/assets/js/77.329d2bb7.js"><link rel="prefetch" href="/assets/js/78.6399e38c.js"><link rel="prefetch" href="/assets/js/79.8585163e.js"><link rel="prefetch" href="/assets/js/8.143ffc63.js"><link rel="prefetch" href="/assets/js/80.7b73a97a.js"><link rel="prefetch" href="/assets/js/81.6193b516.js"><link rel="prefetch" href="/assets/js/82.e484c003.js"><link rel="prefetch" href="/assets/js/83.5779c505.js"><link rel="prefetch" href="/assets/js/84.57692423.js"><link rel="prefetch" href="/assets/js/85.196c5e69.js"><link rel="prefetch" href="/assets/js/86.98fa0bbb.js"><link rel="prefetch" href="/assets/js/87.d228fd1e.js"><link rel="prefetch" href="/assets/js/88.66941670.js"><link rel="prefetch" href="/assets/js/89.c53e9e59.js"><link rel="prefetch" href="/assets/js/9.fbf33cae.js"><link rel="prefetch" href="/assets/js/90.ecdad557.js"><link rel="prefetch" href="/assets/js/91.cd7ab71b.js"><link rel="prefetch" href="/assets/js/92.c9874bab.js"><link rel="prefetch" href="/assets/js/93.55306c79.js"><link rel="prefetch" href="/assets/js/94.6beb55f4.js"><link rel="prefetch" href="/assets/js/95.99b7412d.js"><link rel="prefetch" href="/assets/js/96.3298dad6.js"><link rel="prefetch" href="/assets/js/97.9c189b49.js"><link rel="prefetch" href="/assets/js/98.02b0e19b.js"><link rel="prefetch" href="/assets/js/99.6b4d6823.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b41fd11a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">左小白的前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/nav.html" class="nav-link">
  前端网址导航
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><span class="title">前端进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端进阶" class="mobile-dropdown-title"><span class="title">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/daily/" class="nav-link">
  技术日常记录
</a></li><li class="dropdown-item"><!----> <a href="/server/docker.html" class="nav-link">
  Docker 基础
</a></li><li class="dropdown-item"><h4>
          Vue.js
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/base/1.html" class="nav-link">
  Vue.js 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vue-router.html" class="nav-link">
  Vue Router 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vuex.html" class="nav-link">
  Vuex 笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          前端工程化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ts/base-1.html" class="nav-link">
  TypeScript 入门教程笔记
</a></li><li class="dropdown-subitem"><a href="/node/base/1.html" class="nav-link">
  Node.js 笔记
</a></li><li class="dropdown-subitem"><a href="/webpack/base.html" class="nav-link">
  webpack 基础
</a></li></ul></li><li class="dropdown-item"><h4>
          数据可视化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/visual/echarts.html" class="nav-link">
  Echarts 笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          JS/ES6
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/es6/es6-1.html" class="nav-link">
  ES6标准入门(第三版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/ad3/js-ad3-1.html" class="nav-link">
  JavaScript高级程序设计(第四版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/js-dom-art.html" class="nav-link">
  JavaScript DOM编程艺术(第二版)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          CSS/CSS3
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/css/less.html" class="nav-link">
  CSS 预处理器 Less.js
</a></li><li class="dropdown-subitem"><a href="/css/flex-grid.html" class="nav-link">
  Flex与Grid布局
</a></li><li class="dropdown-subitem"><a href="/css/html5-css-1.html" class="nav-link">
  HTML5权威指南(CSS部分)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          HTML/HTML5
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html5/html/1.html" class="nav-link">
  HTML5权威指南(HTML部分)笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/base/js-data-struct.html" class="nav-link">
  学习JavaScript数据结构与算法(第三版)笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/mocha-test.html" class="nav-link">
  Mocha - JavaScript测试框架
</a></li><li class="dropdown-item"><!----> <a href="/base/git.html" class="nav-link">
  Git 笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/markdown.html" class="nav-link">
  Markdown 基础语法
</a></li><li class="dropdown-item"><!----> <a href="/base/dbtheory/1.html" class="nav-link">
  数据库系统原理笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源项目" class="dropdown-title"><span class="title">开源项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="开源项目" class="mobile-dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zuoxiaobai/service-monitor" target="_blank" rel="noopener noreferrer" class="nav-link external">
  service-monitor
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://vuechart.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @guoqzuo/vue-chart
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://zuoblog.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zuo-blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="http://www.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/zuoxiaobai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/nav.html" class="nav-link">
  前端网址导航
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><span class="title">前端进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端进阶" class="mobile-dropdown-title"><span class="title">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/daily/" class="nav-link">
  技术日常记录
</a></li><li class="dropdown-item"><!----> <a href="/server/docker.html" class="nav-link">
  Docker 基础
</a></li><li class="dropdown-item"><h4>
          Vue.js
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/base/1.html" class="nav-link">
  Vue.js 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vue-router.html" class="nav-link">
  Vue Router 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vuex.html" class="nav-link">
  Vuex 笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          前端工程化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ts/base-1.html" class="nav-link">
  TypeScript 入门教程笔记
</a></li><li class="dropdown-subitem"><a href="/node/base/1.html" class="nav-link">
  Node.js 笔记
</a></li><li class="dropdown-subitem"><a href="/webpack/base.html" class="nav-link">
  webpack 基础
</a></li></ul></li><li class="dropdown-item"><h4>
          数据可视化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/visual/echarts.html" class="nav-link">
  Echarts 笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          JS/ES6
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/es6/es6-1.html" class="nav-link">
  ES6标准入门(第三版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/ad3/js-ad3-1.html" class="nav-link">
  JavaScript高级程序设计(第四版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/js-dom-art.html" class="nav-link">
  JavaScript DOM编程艺术(第二版)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          CSS/CSS3
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/css/less.html" class="nav-link">
  CSS 预处理器 Less.js
</a></li><li class="dropdown-subitem"><a href="/css/flex-grid.html" class="nav-link">
  Flex与Grid布局
</a></li><li class="dropdown-subitem"><a href="/css/html5-css-1.html" class="nav-link">
  HTML5权威指南(CSS部分)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          HTML/HTML5
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html5/html/1.html" class="nav-link">
  HTML5权威指南(HTML部分)笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/base/js-data-struct.html" class="nav-link">
  学习JavaScript数据结构与算法(第三版)笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/mocha-test.html" class="nav-link">
  Mocha - JavaScript测试框架
</a></li><li class="dropdown-item"><!----> <a href="/base/git.html" class="nav-link">
  Git 笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/markdown.html" class="nav-link">
  Markdown 基础语法
</a></li><li class="dropdown-item"><!----> <a href="/base/dbtheory/1.html" class="nav-link">
  数据库系统原理笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源项目" class="dropdown-title"><span class="title">开源项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="开源项目" class="mobile-dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zuoxiaobai/service-monitor" target="_blank" rel="noopener noreferrer" class="nav-link external">
  service-monitor
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://vuechart.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @guoqzuo/vue-chart
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://zuoblog.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zuo-blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="http://www.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/zuoxiaobai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JS/ES6</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ES6标准入门(第三版)笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>JavaScript高级程序设计(第四版)笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/ad3/js-ad4-diff.html" class="sidebar-link">第四版相比第三版有哪些更新 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-1.html" class="sidebar-link">1. 什么是JavaScript - JS高程4</a></li><li><a href="/js/ad3/js-ad3-2.html" class="sidebar-link">2. 在HTML中使用JavaScript - JS高程4</a></li><li><a href="/js/ad3/js-ad3-3.html" class="sidebar-link">3. ES基本概念(语言基础) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-4.html" class="sidebar-link">4. 变量、作用域与内存 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-5.html" class="sidebar-link">5. 基本引用类型 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-6.html" class="sidebar-link">6. 集合引用类型 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-7.html" class="sidebar-link">7. 迭代器与生成器(Iterator 与 Generator) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-8.html" class="sidebar-link">8. 对象、类与面向对象编程 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-9.html" class="sidebar-link">9. 代理与反射(Proxy与Reflect) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-10.html" class="sidebar-link">10. 函数 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-11.html" class="sidebar-link">11. 期约与异步函数(Promise与async/await) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-12.html" class="sidebar-link">12. BOM - JS高程4</a></li><li><a href="/js/ad3/js-ad3-13.html" class="sidebar-link">13. 客户端检测 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-14.html" class="sidebar-link">14. DOM - JS高程4</a></li><li><a href="/js/ad3/js-ad3-15.html" class="sidebar-link">15. DOM扩展 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-16.html" aria-current="page" class="active sidebar-link">16. DOM2 和 DOM3 - JS高程4</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#dom-的变化-演进" class="sidebar-link">DOM 的变化/演进</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#针对-xml-命名空间的变化" class="sidebar-link">针对 XML 命名空间的变化</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#其他方面的变化" class="sidebar-link">其他方面的变化</a></li></ul></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#样式" class="sidebar-link">样式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#存取-访问和设置-元素样式" class="sidebar-link">存取(访问和设置)元素样式</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#操作样式表" class="sidebar-link">操作样式表</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#元素尺寸-元素大小" class="sidebar-link">元素尺寸/元素大小</a></li></ul></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#dom-遍历" class="sidebar-link">DOM 遍历</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#nodeiterator" class="sidebar-link">NodeIterator</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#treewalker" class="sidebar-link">TreeWalker</a></li></ul></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#范围-range" class="sidebar-link">范围(range)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#简单选择" class="sidebar-link">简单选择</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#复杂选择" class="sidebar-link">复杂选择</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#操作范围" class="sidebar-link">操作范围</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#范围插入" class="sidebar-link">范围插入</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-16.html#范围折叠-比较-复制-清理" class="sidebar-link">范围折叠/比较/复制/清理</a></li></ul></li></ul></li><li><a href="/js/ad3/js-ad3-17.html" class="sidebar-link">17. 事件 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-18.html" class="sidebar-link">18. 动画与 Canvas 图形 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-19.html" class="sidebar-link">19. 表单脚本 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-20.html" class="sidebar-link">20. JavaScript API - JS高程4</a></li><li><a href="/js/ad3/js-ad3-21.html" class="sidebar-link">21. 错误处理与调试 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-22.html" class="sidebar-link">22. 处理 XML - JS高程4</a></li><li><a href="/js/ad3/js-ad3-23.html" class="sidebar-link">23. JSON - JS高程4</a></li><li><a href="/js/ad3/js-ad3-24.html" class="sidebar-link">24. 网络请求与远程资源 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-25.html" class="sidebar-link">25. 客户端存储 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-26.html" class="sidebar-link">26. 模块(Modules) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-27.html" class="sidebar-link">27. 工作者线程(Web Workers) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-28.html" class="sidebar-link">28. 最佳实践 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-old.html" class="sidebar-link">第三版其他内容(高级技巧) - JS高程4</a></li></ul></section></li><li><a href="/js/js-dom-art.html" class="sidebar-link">JavaScript DOM 编程艺术(第二版)笔记</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_16-dom2-和-dom3"><a href="#_16-dom2-和-dom3" class="header-anchor">#</a> 16. DOM2 和 DOM3</h1> <p>DOM1（DOM Level 1）主要定义了 HTML 和 XML 文档的底层结构。DOM2（DOM Level 2）和 DOM3 级则在这些结构的基础上加入了更多的交互能力，支持更高级的 XML 特性。DOM2 和 DOM3 是按照模块化的思路来定制标准的，每个模块之间有一定关联，但分别针对某个 DOM 子集，这些模式如下：</p> <ul><li><code>DOM Core</code> 在 DOM1 核心部分的基础上，为节点添加方法和属性</li> <li><code>DOM Views</code> 为文档定义了基于样式信息的不同视图</li> <li><code>DOM Events</code> 定义通过事件实现 DOM 文档交互</li> <li><code>DOM style</code> 定义了如何以编程的方式来访问和改变 CSS 样式</li> <li><code>DOM Traveral and Range</code> 新增遍历 DOM 文档和选择文档内容的接口</li> <li><code>DOM HTML</code> 在 DOM1 HTML 部分的基础上，增加属性、方法和新接口</li> <li><code>DOM Mutation Observers</code> 定义基于 DOM 变化触发回调的接口，这个模块是 DOM4 模块，用于取代 Mutation Events</li></ul> <h2 id="dom-的变化-演进"><a href="#dom-的变化-演进" class="header-anchor">#</a> DOM 的变化/演进</h2> <p>DOM2 和 DOM3 Core 模块的目的在于扩展 DOM API，以满足操作 XML 的所有需求，并提供更好的错误处理及特性检测能力。确定浏览器是否支持某些DOM 模块，返回 true，则支持，否则表示不支持</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第四版已删除下面的例子</span>
document<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span><span class="token function">hasFeature</span><span class="token punctuation">(</span><span class="token string">'Core'</span><span class="token punctuation">,</span> <span class="token string">'2.0'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span><span class="token function">hasFeature</span><span class="token punctuation">(</span><span class="token string">'Core'</span><span class="token punctuation">,</span> <span class="token string">'3.0'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span><span class="token function">hasFeature</span><span class="token punctuation">(</span><span class="token string">'HTML'</span><span class="token punctuation">,</span> <span class="token string">'2.0'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span><span class="token function">hasFeature</span><span class="token punctuation">(</span><span class="token string">'Views'</span><span class="token punctuation">,</span> <span class="token string">'2.0'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span><span class="token function">hasFeature</span><span class="token punctuation">(</span><span class="token string">'XML'</span><span class="token punctuation">,</span> <span class="token string">'2.0'</span><span class="token punctuation">)</span>
document<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span><span class="token function">hasFeature</span><span class="token punctuation">(</span><span class="token string">'CSS2'</span><span class="token punctuation">,</span> <span class="token string">'2.0'</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="针对-xml-命名空间的变化"><a href="#针对-xml-命名空间的变化" class="header-anchor">#</a> 针对 XML 命名空间的变化</h3> <p>针对 XML 命名空间的变化(p461), createElementNS()，createElementNS() 等，一般尾部带有 NS 的，基本就是命名空间相关的。</p> <h3 id="其他方面的变化"><a href="#其他方面的变化" class="header-anchor">#</a> 其他方面的变化</h3> <p>除了命名空间相关的变化，DOM2 Core 还对 DOM 的其他部分做了一些更新。主要关注 DOM API 的完整性与可靠性。</p> <h4 id="documenttype-类型的变化"><a href="#documenttype-类型的变化" class="header-anchor">#</a> DocumentType 类型的变化</h4> <p>DocumentType 类型（document.doctype）新增了三个属性： publicId, systemId, internalSubset。一般 HTML 文档中几乎不会涉及文档类型的内部子集，XML 文档中稍微多一点。</p> <h4 id="document-类型变化"><a href="#document-类型变化" class="header-anchor">#</a> Document 类型变化</h4> <ul><li>新增 importNode() 方法，类似 cloneNode()，用于复制节点。多用于 XML 文档</li> <li>DOM2 View 为 Document 新增 defaultView 属性，指向当前的 window。</li> <li>DOM2 Core 为 document.implementation 对象新增了 createDocumentType(), createDocument() 用于创建文档类型、文档节点。主要是 XML 使用。</li> <li>DOM2 HTML 为 document.implementation 对象新增了 createHTMLDocument(title) 方法，用于创建 HTML 文档</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> newNode <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">importNode</span><span class="token punctuation">(</span>oldNode<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 导入节点以及其所有子节点</span>
document<span class="token punctuation">.</span><span class="token function">importNode</span><span class="token punctuation">(</span>oldNode<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 仅复制本节点，不包含子节点</span>

document<span class="token punctuation">.</span>defaultView <span class="token operator">===</span> window <span class="token comment">// true</span>

<span class="token comment">// 创建 title 为 'new Doc' 的 HTML 文档(document)</span>
document<span class="token punctuation">.</span>implementation<span class="token punctuation">.</span><span class="token function">createHTMLDocument</span><span class="token punctuation">(</span><span class="token string">'new Doc'</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="node-的变化"><a href="#node-的变化" class="header-anchor">#</a> Node 的变化</h4> <p>DOM3 新增两个用于比较节点的方法：</p> <ul><li>isSameNode() A.isSameNode(B)，两节点是否引用的是同一个对象。</li> <li>isEqualNode() A.isEqualNode(B) 两节点是否有相同的类型、相同的属性等。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> div1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
div1<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'css'</span><span class="token punctuation">,</span> <span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> div2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
div2<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'css'</span><span class="token punctuation">,</span> <span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

div1<span class="token punctuation">.</span><span class="token function">isSameNode</span><span class="token punctuation">(</span>div1<span class="token punctuation">)</span> <span class="token comment">// true</span>
div1<span class="token punctuation">.</span><span class="token function">isSameNode</span><span class="token punctuation">(</span>div2<span class="token punctuation">)</span> <span class="token comment">// false</span>
div1<span class="token punctuation">.</span><span class="token function">isEqualNode</span><span class="token punctuation">(</span>div2<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre></div><p>DOM3 增加了给 DOM 节点附加额外数据的方法：setUserData(key, value, handlerFunc) 在 HTML 中已过时，浏览器不支持，参考：<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Node/setUserData" target="_blank" rel="noopener noreferrer">Node.setUserData() | MDN<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="框架-内嵌窗格-的变化"><a href="#框架-内嵌窗格-的变化" class="header-anchor">#</a> 框架(内嵌窗格)的变化</h4> <p>框架和内嵌框架分别用 HTMLFrameElement 和 HTMLIFrameElement(iframe) 表示。DOM2 HTML 为 HTMLIFrameElement 中新增了一个属性 contentDocument, 指向框架内容的文档对象。contentWindow 返回对应 iframe 的 window。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> iframe <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;myIframe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> iframeDoc <span class="token operator">=</span> iframe<span class="token punctuation">.</span>contentDocument <span class="token operator">||</span> iframe<span class="token punctuation">.</span>contentWindow<span class="token punctuation">.</span>document
</code></pre></div><h2 id="样式"><a href="#样式" class="header-anchor">#</a> 样式</h2> <p>HTML 中的样式有 3 种定义方式：外部样式表(<code>使用&lt;link&gt;导入</code>)、文档样式表(<code>使用&lt;style&gt;元素</code>)、元素特定样式(<code>使用 style 属性</code>)。DOM2 Style 为这 3 种应用样式的机制，都提供了 API。</p> <h3 id="存取-访问和设置-元素样式"><a href="#存取-访问和设置-元素样式" class="header-anchor">#</a> 存取(访问和设置)元素样式</h3> <p>JS 可以通过 element.style 访问和设置 通过 style 属性为 element(对应元素) 设置的 css 样式。</p> <ul><li>style 属性是 CSSStyleDeclaration 类型的实例。通过 style 获取的样式不包含通过层叠机制从文档样式或外部样式继承来的样式。</li> <li>css 属性在 JS style 中都有对应的属性，css 属性名使用连字符（font-family），在 JS 中需要转为驼峰大小写形式（fontFamily）</li> <li>在使用 style 设置尺寸时，都需要包含单位。标准模式下，style.width 设置为 20，会导致被忽略，因为没有度量单位。混杂模式下是可以的，但为了兼容，建议都加上单位。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> myDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myDiv<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">'测试'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>myDiv<span class="token punctuation">)</span>

myDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">;</span>
myDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'100px'</span><span class="token punctuation">;</span>
myDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'200px'</span><span class="token punctuation">;</span> <span class="token comment">// 不加单位可能会被忽略 200</span>

myDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token string">'1px solid black'</span><span class="token punctuation">;</span>
myDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText
<span class="token comment">// &quot;background-color: red; width: 100px; height: 200px; border: 1px solid black;&quot;</span>
</code></pre></div><p>DOM2 Style 规范在 style 对象上定义了一些属性和方法。</p> <ul><li><code>cssText</code> 获取元素 style 属性中的 CSS 代码</li> <li><code>length</code> 获取元素 style 属性中的 css 属性数量。无法写，赋值会无效</li> <li>`parentRule，表示 CSS 信息的 CSSRule 对象</li> <li><code>getPropertyPriority(prop)</code> 获取 css 属性的优先级，如果是 <code>!important</code> 返回 &quot;important&quot; ，否则返回 &quot;&quot;</li> <li><code>getProperyValue(prop)</code> 获取 css 属性的值</li> <li><code>item(index)</code> 获取索引为 index 的 CSS属性名，<code>element.style.item(index)</code> 等价于 <code>element.style[index]</code></li> <li><code>setProperty(prop, value, priority)</code> 设置 css 属性，priority 为优先级，&quot;important&quot; 或 &quot;&quot;</li> <li><code>removeProperty(prop)</code> 移除css属性</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
	<span class="token selector">#normal-div</span> <span class="token punctuation">{</span>
		<span class="token property">color</span><span class="token punctuation">:</span> blue<span class="token punctuation">;</span>
		<span class="token property">background-color</span><span class="token punctuation">:</span> #f00<span class="token punctuation">;</span>
		<span class="token property">display</span><span class="token punctuation">:</span>block<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inner-div<span class="token punctuation">&quot;</span></span> <span class="token style-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token style language-css"><span class="token property">color</span><span class="token punctuation">:</span>red<span class="token punctuation">;</span><span class="token property">width</span><span class="token punctuation">:</span>100px<span class="token punctuation">;</span><span class="token property">height</span><span class="token punctuation">:</span> 200px<span class="token punctuation">;</span><span class="token property">font-size</span><span class="token punctuation">:</span>29px</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
	内联样式div
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>normal-div<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>正常样式<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">let</span> innerDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'inner-div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">let</span> normalDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'normal-div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	
	<span class="token function">alert</span><span class="token punctuation">(</span>innerDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText<span class="token punctuation">)</span> 
	<span class="token comment">// &quot;color: red; width: 100px; height: 200px; font-size: 29px;&quot;</span>
	<span class="token function">alert</span><span class="token punctuation">(</span>normalDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText<span class="token punctuation">)</span> <span class="token comment">// &quot;&quot;</span>
	normalDiv<span class="token punctuation">.</span>cssText <span class="token operator">=</span> <span class="token string">'color:white'</span> <span class="token comment">// 设置内联样式</span>

	<span class="token function">alert</span><span class="token punctuation">(</span>innerDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token comment">// 4</span>
	<span class="token function">alert</span><span class="token punctuation">(</span>normalDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token comment">// 0</span>
	
	<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> innerDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">let</span> propertyName <span class="token operator">=</span> innerDiv<span class="token punctuation">.</span>style<span class="token punctuation">[</span>i<span class="token punctuation">]</span> 
		<span class="token comment">// 或者 innerDiv.style.item(i), color、width、height</span>
		<span class="token function">alert</span><span class="token punctuation">(</span>propertyName<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">let</span> pn <span class="token operator">=</span> innerDiv<span class="token punctuation">.</span>style<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// color</span>
	innerDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">getPropertyValue</span><span class="token punctuation">(</span>pn<span class="token punctuation">)</span> <span class="token comment">// &quot;red&quot;</span>
	innerDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">getPropertyPriority</span><span class="token punctuation">(</span>pn<span class="token punctuation">)</span> <span class="token comment">// &quot;&quot;</span>
	
	normalDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">,</span> <span class="token string">'white'</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> 
	<span class="token comment">// normalDiV.style.cssText  // &quot;color: white&quot;</span>
	normalDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">setProperty</span><span class="token punctuation">(</span><span class="token string">'font-size'</span><span class="token punctuation">,</span> <span class="token string">'20px'</span><span class="token punctuation">,</span> <span class="token string">&quot;important&quot;</span><span class="token punctuation">)</span> 
	<span class="token comment">// &quot;color: white; font-size: 20px !important;&quot;</span>
	normalDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">getPropertyPriority</span><span class="token punctuation">(</span><span class="token string">'font-size'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;important&quot;</span>
	normalDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span><span class="token function">removeProperty</span><span class="token punctuation">(</span><span class="token string">'color'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 移除对应的css属性</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="访问层叠规则计算后的样式"><a href="#访问层叠规则计算后的样式" class="header-anchor">#</a> 访问层叠规则计算后的样式</h4> <p>由于 style 对象只是读取的元素通过 style 属性设置的样式，不包含从其他样式表层叠继承的样式信息。DOM2 Style 在 document.defaultView 上新增了 <code>getComputedStyle(元素, 伪元素字符串)</code> 方法来获取包含元素计算后的样式，它也是 CSSStyleDeclaration 类型的实例。</p> <p>document.defaultView.getComputedStyle(element, null)，第二个参数是伪元素字符串如&quot;:after&quot;, 如果不需要，就传null</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> innerDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'inner-div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> normalDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'normal-div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
normalDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> computedStyle <span class="token operator">=</span> document<span class="token punctuation">.</span>defaultView<span class="token punctuation">.</span><span class="token function">getComputedStyle</span><span class="token punctuation">(</span>normalDiv<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span> 
innerDiv<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token comment">// &quot;&quot;</span>
computedStyle<span class="token punctuation">.</span>color <span class="token comment">// 有的浏览器是 rgb(0,0,255) 有的是 #0000ff</span>

</code></pre></div><h3 id="操作样式表"><a href="#操作样式表" class="header-anchor">#</a> 操作样式表</h3> <blockquote><p>可以获取、操作 <code>&lt;style&gt;</code> 元素和 <code>&lt;link&gt;</code> 元素导入的样式信息，他们里面的每一行样式信息都是一条 CSS 规则，可以进行读取和设置</p></blockquote> <p>CSSStyleSheet 类型表示 CSS 样式表，包括使用 <code>&lt;link&gt;</code> 元素和 <code>&lt;style&gt;</code> 元素定义的样式表。</p> <ul><li><code>&lt;link&gt;</code> 元素本身是 HTMLLinkElement</li> <li><code>&lt;style&gt;</code> 元素本身是 HTMLStyleElement</li> <li><code>CSSStyleSheet</code> 是一个通用的样式表类型，可以表示在 <code>&lt;link&gt;</code> 和 <code>&lt;style&gt;</code> 两个 HTML 元素定义的样式</li> <li><code>document.styleSheets</code> 类型是 StyleSheetList 类数组对象。每一个子项都是 CSSStyleSheet 类型。表示文档中可用的 <code>&lt;style&gt;</code>、以及 rel 属性为 'stylesheet' 的 <code>&lt;link&gt;</code> 元素样式表集合。</li> <li>CSSStyleSheet 从 StyleSheet 类型继承了如下属性，除了 disabled 可以写，其他都只读。
<ul><li><code>disabled</code>, 布尔值，是否禁用样式表，默认为 false</li> <li><code>href</code>，如果是 <code>&lt;link&gt;</code> 样式表，返回样式表的 URL，如果是 <code>&lt;style&gt;</code> 样式表，返回 null</li> <li><code>type</code>: &quot;text/css&quot;</li> <li><code>ownerNode</code>，一般为 'style' 或 'link'，如果当前样式表是通过 <code>@import</code> 被包含在另一个样式表中，则这个属性值为 null</li> <li><code>title</code>，ownerNode 的 title 属性</li> <li><code>parentStyleSheet</code> 如果样式表是通过 <code>@import</code> 导入的，则这个属性指向导入它的样式表。</li></ul></li> <li>CSSStyleSheet 还支持如下属性
<ul><li><code>cssRules</code> 当前样式表包含的样式规则集合，CSSRuleList (CSSStyleRule 对象数组)。如果 cssRules 不支持，就取 rules 属性值。</li> <li><code>ownerRule</code> 如果样式表是 <code>@import</code> 导入，则指向导入的那一行规则，否则为 null</li> <li><code>deleteRule(index)</code> 删除 cssRules 中索引为 index 的样式规则</li> <li><code>insertRule(rule, index)</code> 在指定位置向 cssRules 中插入规则</li></ul></li> <li>CSSRule 表示样式表中的一条规则，CSSStyleRule 继承自它，表示样式信息，CSSStyleRule 有如下属性
<ul><li><code>cssText</code> 返回整条规则文本</li> <li><code>parentRule</code> 如果这条规则被其他规则（如 <code>@media</code>）包含，则指向包含的规则，否则为 null</li> <li><code>parentStyleSheet</code> 包含当前规则的样式表</li> <li><code>selectorText</code> 返回规则的选择符文本</li> <li><code>style</code> 返回 CSSStyleDeclaration 对象，可以设置获取当前规则中的样式</li> <li><code>type</code> 数值常量，表示规则类型。对于样式规则，它始终为 1。</li></ul></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span>styleSheets 
<span class="token comment">// StyleSheetList { 0: CSSStyleSheet, 1: CSSStyleSheet, ... }</span>
document<span class="token punctuation">.</span>styleSheets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rules <span class="token comment">// </span>
<span class="token comment">// CSSRuleList (CSSStyleRule 对象数组) </span>
<span class="token comment">// 记录了 css 文件或 style 标签里的样式信息 List</span>
document<span class="token punctuation">.</span>styleSheets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token comment">// CSSStyleRule 对象，每一条记录，可以通过.selectorText和.cssText 获取到对应的选择器和样式信息</span>
</code></pre></div><p>操作规则（获取、新增、删除）示例：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
style例子：
&lt;style&gt;
  #normal-div {
    color: blue;
    background-color: #f00;
    display:block;
  }
  div.box {
    width: 100px;
    height: 200px;
    background-color: blue;
  }
&lt;/style&gt;
*/</span>
<span class="token comment">// 1.获取 &lt;style&gt; 里的样式信息CSSRule</span>
<span class="token keyword">let</span> sheet <span class="token operator">=</span> document<span class="token punctuation">.</span>styleSheets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> rules <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cssRules <span class="token operator">||</span> sheet<span class="token punctuation">.</span>rules
<span class="token comment">// 获取第一个&lt;style&gt;里的样式信息</span>
rules<span class="token punctuation">.</span>length <span class="token comment">// 2   ，分别为 #normal-div 及 div.box 的相关样式</span>
rules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>selectorText <span class="token comment">// &quot;#normal-div&quot;</span>
rules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cssText  
<span class="token comment">// &quot;#normal-div { color: blue; background-color: rgb(255, 0, 0); display: block; }&quot;</span>
rules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText 
<span class="token comment">//  &quot;color: blue; background-color: rgb(255, 0, 0); display: block;&quot;</span>
rules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token comment">// &quot;blue&quot;</span>
rules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'white'</span> <span class="token comment">// 可以直接设置样式</span>

rules<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>selectorText <span class="token comment">// &quot;div.box&quot;</span>
rules<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cssText  
<span class="token comment">// &quot;div.box { width: 100px; height: 200px; background-color: blue; }&quot;</span>
rules<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>cssText 
<span class="token comment">// &quot;width: 100px; height: 200px; background-color: blue;&quot;</span>
rules<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token comment">// &quot;100px&quot;</span>

<span class="token comment">// 2. 创建CSSRule</span>
<span class="token keyword">let</span> sheet <span class="token operator">=</span> document<span class="token punctuation">.</span>styleSheets<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// sheet.insertRule(cssText, pos)</span>
sheet<span class="token punctuation">.</span><span class="token function">insertRule</span><span class="token punctuation">(</span><span class="token string">&quot;body {background-color: yellow;}&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment">// 页面被改为yellow背景</span>
sheet<span class="token punctuation">.</span>rules<span class="token punctuation">.</span>length <span class="token comment">// 3</span>

<span class="token comment">// 3. 移除CSSRule</span>
sheet<span class="token punctuation">.</span><span class="token function">deleteRule</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 删除一个rules里面的规则</span>
</code></pre></div><p>一般 Web 开发中很少用到上面的方法。更多的方法是使用 14 章介绍的动态样式加载技术。</p> <h3 id="元素尺寸-元素大小"><a href="#元素尺寸-元素大小" class="header-anchor">#</a> 元素尺寸/元素大小</h3> <p>下面介绍的属性和方法并不是 DOM2 Style 规范中定义的，但与 HTML 元素的样式有关。DOM 一直缺乏页面中元素实际尺寸的规范。IE 率先增加了一些属性，向开发者暴露元素尺寸信息，这些属性现在已经得到所有主流浏览器支持。</p> <p>元素从内到外：元素内容 - 内边距(padding) - 边框(boder) - 外边距(margin)</p> <h4 id="元素偏移量-偏移尺寸"><a href="#元素偏移量-偏移尺寸" class="header-anchor">#</a> 元素偏移量/偏移尺寸</h4> <ul><li>element.offsetHeight  元素内容 + 内边距(padding) + 边框(border)</li> <li>element.offsetWidth   元素内容 + 内边距(padding) + 边框(border)</li> <li>element.offsetTop     元素边框到父元素边框顶部之间的距离</li> <li>element.offsetLeft    元素边框到父元素边框左侧部之间的距离</li> <li>element.offsetLeft 与 element.offsetTop 都是相对于父元素的。真实的偏移量，要加上 element.offsetParent</li></ul> <p>这些偏移尺寸属性都是只读的，每次访问都会重新计算。使用时可以把该值放在一个局部变量中，避免影响性能。</p> <h4 id="元素客户端尺寸-client-dimensions"><a href="#元素客户端尺寸-client-dimensions" class="header-anchor">#</a> 元素客户端尺寸(client dimensions)</h4> <p>元素客户端尺寸就是<strong>元素内部的空间</strong>。不包含border，margin，滚动条占用的空间。</p> <ul><li>element.clientHeight  元素内容 + 内边距</li> <li>element.clientWidth   元素内容 + 内边距</li></ul> <h4 id="滚动大小"><a href="#滚动大小" class="header-anchor">#</a> 滚动大小</h4> <ul><li>element.scrollHeight  元素整个区域的高度</li> <li>element.scrollWidth  整个区域的宽度</li> <li>element.scrollLeft 被隐藏区域左侧的像素宽度</li> <li>element.scrollTop  被隐藏区域顶部的像素高度</li></ul> <p>结合滚动事件监听可以做一个页面百分比显示模块，scrollWidth 和 scrollHeight 可以用来确定元素内容的实际尺寸。clientWith 和 clientHeight 是视口的大小，不包含滚动区域。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// demo</span>
<span class="token comment">// &lt;div id=&quot;inner-div&quot; style=&quot;height: 100px;overflow:scroll;color:red;width:100px;height: 200px;font-size:29px;margin:10px;padding:20px;border:2px solid #ccc;&quot;&gt;</span>
<span class="token comment">// &lt;/div&gt;</span>
<span class="token keyword">let</span> k2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'inner-div'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
k2<span class="token punctuation">.</span>offsetHeight <span class="token comment">// 144 边框(border) + 内边距(padding) + 元素height</span>
k2<span class="token punctuation">.</span>offsetWidth <span class="token comment">// 144 边框(border) + 内边距(padding) + 元素width</span>
k2<span class="token punctuation">.</span>offsetLeft <span class="token comment">// 距离左边的距离</span>
k2<span class="token punctuation">.</span>offsetTop <span class="token comment">// 距离顶部的距离</span>

<span class="token comment">// clientWidth 内边距(padding) + 元素width</span>
<span class="token comment">// clientHeight 内边距(padding) + 元素height</span>

k2<span class="token punctuation">.</span>scrollHeight <span class="token comment">// 703  实际可见为100左右</span>
k2<span class="token punctuation">.</span>scrollTop <span class="token comment">// 0 改变该参数，可以设置滚动位置</span>

k2<span class="token punctuation">.</span>scrollWidth <span class="token comment">// 横向滚动相关</span>
k2<span class="token punctuation">.</span>scrollLeft  <span class="token comment">// 可以设置横向滚动位置</span>
</code></pre></div><h4 id="确定元素尺寸"><a href="#确定元素尺寸" class="header-anchor">#</a> 确定元素尺寸</h4> <p>element.getBoundingClientRect()，返回一个 DOMRect 对象，包含 left、top、right、bottom、height、width 属性，给出了元素在页面中相对于视口的位置。其中 e.right = e.left + e.width，e.bottom = e.top + e.height</p> <h2 id="dom-遍历"><a href="#dom-遍历" class="header-anchor">#</a> DOM 遍历</h2> <p>DOM2 Traversal and Range 模块，定义了两个类型用于辅助顺序遍历 DOM 结构：NodeIterator, TreeWalker。他们可以从某个起点开始执行对 DOM 结构的优先遍历。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Example<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>b</span><span class="token punctuation">&gt;</span></span>Hello<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>b</span><span class="token punctuation">&gt;</span></span> world!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>sss
</code></pre></div><p>遍历节点顺序：</p> <p><img src="/images/js/domIterator.png" alt="DOM Iterator"></p> <h3 id="nodeiterator"><a href="#nodeiterator" class="header-anchor">#</a> NodeIterator</h3> <p>NodeIterator 节点遍历器，可以通过 document.createNodeIterator() 方法创建 NodeIterator 实列，然后用nextNode(), previousNode()，访问前一个节点，或后一个节点。</p> <p>document.createNodeIterator(root, whatToShow, filter, entityReferenceExpansion)</p> <ul><li>root 作为 DOM 树中搜索起点的元素节点</li> <li>whatToShow 可选，表示需要访问哪些节点？可以过滤节点，可选值值如下：除了 SHOW_ALL，其他的可以用 | 来组合多个
<ul><li>NodeFilter.SHOW_ALL: 显示所有类型的节点</li> <li>NodeFilter.SHOW_ELEMENT：显示元素节点</li> <li>NodeFilter.SHOW_ATTRIBUTE 属性节点，由于 DOM 的结构，实际用不上</li> <li>NodeFilter.SHOW_TEXT：显示文本节点</li> <li>NodeFilter.SHOW_COMMENT：显示注释节点</li> <li>NodeFilter.SHOW_DOCUMENT：显示文档节点</li> <li>NodeFilter.SHOW_DOCUMENT_TYPE：显示文档类型节点</li> <li>...</li></ul></li> <li>filter 可选, 一个 NodeFilter 对象或函数，表示是否接收或跳过特定节点</li> <li>entiryReferenceExpansion 可选, 布尔值，是否要扩展实体引用，在 HTML 文档中没效果。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> iterator <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createNodeIterator</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span>  <span class="token comment">// 第二个字段等同于 NodeFilter.SHOW_ALL</span>
<span class="token keyword">let</span> node <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">nextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>node <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">nodeType: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeType<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, nodeName: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, nodeValue: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, tagName: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>tagName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  node <span class="token operator">=</span> iterator<span class="token punctuation">.</span><span class="token function">nextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 所有节点，包含doctype、回车空的textNode</span>
<span class="token comment">// nodeType: 9, nodeName: #document, nodeValue: null, tagName: undefined</span>
<span class="token comment">// nodeType: 10, nodeName: html, nodeValue: null, tagName: undefined</span>
<span class="token comment">// nodeType: 1, nodeName: HTML, nodeValue: null, tagName: HTML</span>
<span class="token comment">// nodeType: 1, nodeName: HEAD, nodeValue: null, tagName: HEAD</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: </span>
<span class="token comment">// 		, tagName: undefined</span>
<span class="token comment">// nodeType: 1, nodeName: META, nodeValue: null, tagName: META</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: </span>
<span class="token comment">// 		, tagName: undefined</span>
<span class="token comment">// nodeType: 1, nodeName: TITLE, nodeValue: null, tagName: TITLE</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: Example, tagName: undefined</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: </span>
<span class="token comment">// 	, tagName: undefined</span>
<span class="token comment">// nodeType: 1, nodeName: BODY, nodeValue: null, tagName: BODY</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: </span>
<span class="token comment">// 		, tagName: undefined</span>
<span class="token comment">// nodeType: 1, nodeName: P, nodeValue: null, tagName: P</span>
<span class="token comment">// nodeType: 1, nodeName: B, nodeValue: null, tagName: B</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: Hello, tagName: undefined</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue:  world!, tagName: undefined</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: </span>
<span class="token comment">// 	</span>
<span class="token comment">// , tagName: undefined</span>
<span class="token comment">// null</span>
</code></pre></div><p>使用 filter 参数过滤节点，该参数可以使一个 NodeFilter 对象，对象只有一个 acceptNode() 方法，如果要跳过该节点，返回 NodeFilter.FILTER_SKIP，否则返回 NodeFilter.FILTER_ACCEPT。filter 参数也可以使与 acceptNode 形式一样的函数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> filter <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">acceptNode</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果是空的文本节点，过滤掉</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>nodeType <span class="token operator">===</span> <span class="token number">3</span> <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>nodeValue<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">''</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> NodeFilter<span class="token punctuation">.</span><span class="token constant">FILTER_SKIP</span><span class="token punctuation">;</span> <span class="token comment">// 跳过该节点</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> NodeFilter<span class="token punctuation">.</span><span class="token constant">FILTER_ACCEPT</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 等价于</span>
<span class="token comment">// let filter = function(node) {</span>
<span class="token comment">// 	if (node.nodeType === 3 &amp;&amp; node.nodeValue.trim() === '') {</span>
<span class="token comment">// 		return NodeFilter.FILTER_SKIP; // 跳过该节点</span>
<span class="token comment">// 	} else {</span>
<span class="token comment">// 		return NodeFilter.FILTER_ACCEPT;</span>
<span class="token comment">// 	}</span>
<span class="token comment">// } </span>
<span class="token keyword">let</span> iterator2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createNodeIterator</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> NodeFilter<span class="token punctuation">.</span><span class="token constant">SHOW_ELEMENT</span> <span class="token operator">|</span> NodeFilter<span class="token punctuation">.</span><span class="token constant">SHOW_TEXT</span><span class="token punctuation">,</span> filter<span class="token punctuation">)</span>
<span class="token comment">// 只显示元素节点和文本节点</span>
<span class="token keyword">let</span> node <span class="token operator">=</span> iterator2<span class="token punctuation">.</span><span class="token function">nextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token comment">// 第一个nextNode() 会返回根节点。遍历到最后一个节点，会是null</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>node <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">nodeType: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeType<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, nodeName: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, nodeValue: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">', tagName: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>tagName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  node <span class="token operator">=</span> iterator2<span class="token punctuation">.</span><span class="token function">nextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// nodeType: 1, nodeName: HTML, nodeValue: 'null', tagName: HTML</span>
<span class="token comment">// nodeType: 1, nodeName: HEAD, nodeValue: 'null', tagName: HEAD</span>
<span class="token comment">// nodeType: 1, nodeName: META, nodeValue: 'null', tagName: META</span>
<span class="token comment">// nodeType: 1, nodeName: TITLE, nodeValue: 'null', tagName: TITLE</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: 'Example', tagName: undefined</span>
<span class="token comment">// nodeType: 1, nodeName: BODY, nodeValue: 'null', tagName: BODY</span>
<span class="token comment">// nodeType: 1, nodeName: P, nodeValue: 'null', tagName: P</span>
<span class="token comment">// nodeType: 1, nodeName: B, nodeValue: 'null', tagName: B</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: 'Hello', tagName: undefined</span>
<span class="token comment">// nodeType: 3, nodeName: #text, nodeValue: ' world!', tagName: undefined</span>
<span class="token comment">// null</span>


<span class="token keyword">let</span> iterator3 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createNodeIterator</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> NodeFilter<span class="token punctuation">.</span><span class="token constant">SHOW_ELEMENT</span><span class="token punctuation">)</span> <span class="token comment">// 只显示元素节点</span>
<span class="token keyword">let</span> node <span class="token operator">=</span> iterator3<span class="token punctuation">.</span><span class="token function">nextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 第一个nextNode() 会返回根节点。遍历到最后一个节点，会是null</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>node <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">nodeType: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeType<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, nodeName: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, nodeValue: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">', tagName: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>tagName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  node <span class="token operator">=</span> iterator3<span class="token punctuation">.</span><span class="token function">nextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// nodeType: 1, nodeName: HTML, nodeValue: 'null', tagName: HTML</span>
<span class="token comment">// nodeType: 1, nodeName: HEAD, nodeValue: 'null', tagName: HEAD</span>
<span class="token comment">// nodeType: 1, nodeName: META, nodeValue: 'null', tagName: META</span>
<span class="token comment">// nodeType: 1, nodeName: TITLE, nodeValue: 'null', tagName: TITLE</span>
<span class="token comment">// nodeType: 1, nodeName: BODY, nodeValue: 'null', tagName: BODY</span>
<span class="token comment">// nodeType: 1, nodeName: P, nodeValue: 'null', tagName: P</span>
<span class="token comment">// nodeType: 1, nodeName: B, nodeValue: 'null', tagName: B</span>
<span class="token comment">// null</span>

</code></pre></div><h3 id="treewalker"><a href="#treewalker" class="header-anchor">#</a> TreeWalker</h3> <p>TreeWalker，是 NodeIterator 的一个更高级的版本，支持 parentNode(), firstChild(), lastChild(), nextSibling(), previousSibling()，可以用 document.createTreewalker() 方法创建 TreeWalker 实例。参数和 document.createNodeIterator() 一致</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// TreeWalker 里面的 filter 新增 NodeFilter.FILTER_REJECT 参数</span>
<span class="token comment">// NodeFilter.FILTER_SKIP  跳过节点，到子树的下一个节点</span>
<span class="token comment">// NodeFilter.FILTER_REJECT 跳过节点及该节点的整个子树</span>
<span class="token comment">// NodeFilter.FILTER_ACCEPT 不过滤节点</span>
<span class="token keyword">let</span> walker <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTreeWalker</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> NodeFilter<span class="token punctuation">.</span><span class="token constant">SHOW_ELEMENT</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> node <span class="token operator">=</span> walker<span class="token punctuation">.</span><span class="token function">nextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 第一个nextNode() 会返回根节点。遍历到最后一个节点，会是null</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>node <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">nodeType: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeType<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, nodeName: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">, nodeValue: '</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>nodeValue<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">', tagName: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>node<span class="token punctuation">.</span>tagName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  node <span class="token operator">=</span> walker<span class="token punctuation">.</span><span class="token function">nextNode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// nodeType: 1, nodeName: HTML, nodeValue: 'null', tagName: HTML</span>
<span class="token comment">// nodeType: 1, nodeName: HEAD, nodeValue: 'null', tagName: HEAD</span>
<span class="token comment">// nodeType: 1, nodeName: META, nodeValue: 'null', tagName: META</span>
<span class="token comment">// nodeType: 1, nodeName: TITLE, nodeValue: 'null', tagName: TITLE</span>
<span class="token comment">// nodeType: 1, nodeName: BODY, nodeValue: 'null', tagName: BODY</span>
<span class="token comment">// nodeType: 1, nodeName: P, nodeValue: 'null', tagName: P</span>
<span class="token comment">// nodeType: 1, nodeName: B, nodeValue: 'null', tagName: B</span>
<span class="token comment">// null</span>

<span class="token comment">// walker.firstChild()</span>
<span class="token comment">// walker.nextSibling()</span>
<span class="token comment">// walker.currentNode // 当前节点，给该节点赋值，可以改变起点。</span>
</code></pre></div><p>更多详情，参考 p482，相关文章：<a href="https://www.cnblogs.com/venoral/archive/2016/05/16/5499358.html" target="_blank" rel="noopener noreferrer">玩转DOM遍历——用NodeIterator实现getElementById，getElementsByTagName方法 - venoral - 博客园<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="范围-range"><a href="#范围-range" class="header-anchor">#</a> 范围(range)</h2> <p>为了支持对页面更细致的控制，DOM2 Tarversal and Range 模块定义了范围接口。范围可用于在文档中选择内容，而不用考虑节点之间的界限。在 DOM 操作的粒度不够时可以使用。document.createRange() 方法用于创建一个 DOM 范围对象，类型为 Range，包含如下属性</p> <ul><li><code>startContainer</code> 范围起点所在的节点，即选区中的第一个节点的父节点。</li> <li><code>startOffset</code> 范围起点在 startContainer 中的偏移量。如果 startContainer 是文本节点、注释节点或CData区块节点，startOffset 表示跳过的字符数, 否则表示范围中第一个节点的索引。</li> <li><code>endContainer</code> 范围重点所在的节点，即选区中最后一个子节点的父节点</li> <li><code>endOffset</code> 范围起点在 startContainer 中的偏移量（与 startOffset 中偏移量的含义相同）</li> <li><code>commonAncestorContainer</code>， 祖先节点，文档中以 startContainer 和 endContainer 为后代的最深的节点。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> range <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 
range<span class="token punctuation">.</span>startContainer <span class="token comment">// #document</span>
range<span class="token punctuation">.</span>startContainer <span class="token operator">===</span> document <span class="token comment">// true</span>
range<span class="token punctuation">.</span>endContainer <span class="token operator">===</span> document <span class="token comment">// true</span>
</code></pre></div><h3 id="简单选择"><a href="#简单选择" class="header-anchor">#</a> 简单选择</h3> <p>通过范围选择文档中某个部分最简单的方式是使用 selectNode() 和 selectNodeContents()。两个方法都接收一个节点作为参数，并将该节点的信息调价到调用它的范围。更多细节参考 p483</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// &lt;body&gt;</span>
<span class="token comment">//   &lt;p id=&quot;p1&quot;&gt;&lt;b&gt;Hello&lt;/b&gt; world!&lt;/p&gt;</span>
<span class="token comment">// &lt;/body&gt;</span>

<span class="token keyword">let</span> range1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> range2 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

range1<span class="token punctuation">.</span><span class="token function">selectNode</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token comment">// range1 包含 &lt;p id=&quot;p1&quot;&gt;&lt;b&gt;Hello&lt;/b&gt; world!&lt;/p&gt;</span>
range2<span class="token punctuation">.</span><span class="token function">selectNodeContents</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">// range2 包含 &lt;b&gt;Hello&lt;/b&gt; world!</span>
</code></pre></div><h3 id="复杂选择"><a href="#复杂选择" class="header-anchor">#</a> 复杂选择</h3> <p>setStart()、setEnd() 两个方法可以创建更复杂的范围。它们都接收两个参数：参照节点和偏移量。如果是 setStart() 参照节点会成为 startContainer，偏移量赋值给 startOffset。对于 startEnd() 参照节点会成为 endContainer，偏移量会赋值给 endOffset。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// &lt;body&gt;</span>
<span class="token comment">//   &lt;p id=&quot;p1&quot;&gt;&lt;b&gt;Hello&lt;/b&gt; world!&lt;/p&gt;</span>
<span class="token comment">// &lt;/body&gt;</span>
<span class="token keyword">let</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    helloNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>firstChild<span class="token punctuation">,</span> <span class="token comment">// &quot;Hello&quot;</span>
    worldNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>lastChild<span class="token punctuation">;</span> <span class="token comment">// &quot; world!&quot; textNode</span>
    
<span class="token keyword">let</span> range <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">setStart</span><span class="token punctuation">(</span>helloNode<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">setEnd</span><span class="token punctuation">(</span>worldNode<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// range &quot;llo&lt;/b&gt; wo&quot;</span>
</code></pre></div><h3 id="操作范围"><a href="#操作范围" class="header-anchor">#</a> 操作范围</h3> <p>操作 DOM 范围中的内容</p> <ul><li>range.deleteContents() 删除范围中的内容</li> <li>range.extractContents() 删除范围中的文本内容，并返回对应的文档片段 nodeType 为 11，DocumentFragment</li> <li>range.cloneContents() 如果不想把范围中文档中删除，可以使用 cloneContents() 复制文档片段</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// &lt;body&gt;</span>
<span class="token comment">//   &lt;p id=&quot;p1&quot;&gt;&lt;b&gt;Hello&lt;/b&gt; world!&lt;/p&gt;</span>
<span class="token comment">// &lt;/body&gt;</span>
<span class="token comment">// 1. 删除范围中的文本内容 deleteContents()</span>
<span class="token keyword">let</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    helloNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>firstChild<span class="token punctuation">;</span> <span class="token comment">// &quot;hello&quot;</span>
    worldNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>lastChild<span class="token punctuation">;</span> <span class="token comment">// &quot; world!&quot; textNode</span>
    
<span class="token keyword">let</span> range <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">setStart</span><span class="token punctuation">(</span>helloNode<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">setEnd</span><span class="token punctuation">(</span>worldNode<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// range   &quot;llo&lt;/b&gt; wo&quot;</span>
range<span class="token punctuation">.</span><span class="token function">deleteContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &lt;p id=&quot;p1&quot;&gt;&lt;b&gt;He&lt;/b&gt;rld!&lt;/p&gt;</span>

<span class="token comment">// 2. 删除范围中的文本内容，并返回对应的文档片段 extractContents()</span>
<span class="token keyword">let</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    helloNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>firstChild<span class="token punctuation">;</span> <span class="token comment">// &quot;hello&quot;</span>
    worldNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>lastChild<span class="token punctuation">;</span> <span class="token comment">// &quot; world!&quot; textNode</span>
    
<span class="token keyword">let</span> range <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">setStart</span><span class="token punctuation">(</span>helloNode<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">setEnd</span><span class="token punctuation">(</span>worldNode<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// range   &quot;llo&lt;/b&gt; wo&quot;</span>
<span class="token keyword">let</span> fragment <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">extractContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p1<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fragment<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &lt;body&gt;</span>
<span class="token comment">// 	&lt;p id=&quot;p1&quot;&gt;&lt;b&gt;He&lt;/b&gt;rld!&lt;/p&gt;	</span>
<span class="token comment">// 	&lt;b&gt;llo&lt;/b&gt; wo</span>
<span class="token comment">// &lt;/body&gt;</span>
</code></pre></div><h3 id="范围插入"><a href="#范围插入" class="header-anchor">#</a> 范围插入</h3> <p>向 DOM 范围中插入内容</p> <ul><li>range.insertNode(元素内容) 在 range 中插入内容</li> <li>range.surroundContents(元素) 提取 range 中的内容，用对应的元素节点包裹，再插入对应的位置</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. range.insertNode(), 在 range 中插入内容</span>
<span class="token keyword">let</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    helloNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>firstChild<span class="token punctuation">;</span> <span class="token comment">// &quot;hello&quot;</span>
    worldNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>lastChild<span class="token punctuation">;</span> <span class="token comment">// &quot; world!&quot; textNode</span>
    
<span class="token keyword">let</span> range <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">setStart</span><span class="token punctuation">(</span>helloNode<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">setEnd</span><span class="token punctuation">(</span>worldNode<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// range &quot;llo&lt;/b&gt; wo&quot;</span>

<span class="token keyword">let</span> span <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">'red'</span><span class="token punctuation">;</span>
span<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">'Inserted text'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">insertNode</span><span class="token punctuation">(</span>span<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// &lt;p id=&quot;p1&quot;&gt;&lt;b&gt;He  插入到这里  llo&lt;/b&gt; world!&lt;/p&gt;</span>
<span class="token comment">// html 内容</span>
<span class="token comment">// &lt;p id=&quot;p1&quot;&gt;&lt;b&gt;He&lt;span style=&quot;color:red&quot;&gt;Inserted text&lt;/span&gt;llo&lt;/b&gt; world!&lt;/p&gt;</span>

<span class="token comment">// 2. range.surroundContents(), 提取range中的内容，用对应的元素节点包裹，再插入对应的位置</span>
<span class="token keyword">let</span> p1 <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'p1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    helloNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>firstChild<span class="token punctuation">.</span>firstChild<span class="token punctuation">;</span> <span class="token comment">// &quot;hello&quot;</span>
    worldNode <span class="token operator">=</span> p1<span class="token punctuation">.</span>lastChild<span class="token punctuation">;</span> <span class="token comment">// &quot; world!&quot; textNode    </span>
<span class="token keyword">let</span> range <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">selectNode</span><span class="token punctuation">(</span>helloNode<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> span <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
span<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">'yellow'</span><span class="token punctuation">;</span>
range<span class="token punctuation">.</span><span class="token function">surroundContents</span><span class="token punctuation">(</span>span<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// &lt;p id=&quot;p1&quot;&gt;&lt;b&gt;&lt;span style=&quot;background-color:yellow&quot;&gt;Hello&lt;/span&gt;&lt;/b&gt; world!&lt;/p&gt;</span>
</code></pre></div><h3 id="范围折叠-比较-复制-清理"><a href="#范围折叠-比较-复制-清理" class="header-anchor">#</a> 范围折叠/比较/复制/清理</h3> <p><strong>范围折叠</strong> 如果范围没有选择文档的任何部分，则称为折叠(collapsed)。</p> <div class="language-js extra-class"><pre class="language-js"><code>range<span class="token punctuation">.</span><span class="token function">collapse</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// 折叠到起点位置</span>
range<span class="token punctuation">.</span><span class="token function">collapse</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token comment">// 折叠到结束位置</span>
</code></pre></div><p><strong>范围比较</strong>，比较 DOM 范围 range1.compareBoundaryPoints(比较方式常量, range2)。比较方式常量值，可选如下，如果相等，返回 0，range1 的点位于 range2 的点之前，返回 -1， 如果在之后，返回 1</p> <ul><li>Range.START_TO_START(0) 比较 range1 和 range2 的起点</li> <li>Range.START_TO_END(1) 比较 range1 的起点和 range2 的终点</li> <li>Range.END_TO_END(2) 比较 range1 和 range2 的终点</li> <li>Range.END_TO_START(3) 比较 range1 的终点和 range2 的起点</li></ul> <p><strong>复制 DOM 范围</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> newRange <span class="token operator">=</span> range<span class="token punctuation">.</span><span class="token function">cloneRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>清理 DOM 范围</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>range<span class="token punctuation">.</span><span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 从文档中分离</span>
range <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// 解除引用</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020/11/26 下午9:42:02</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/js/ad3/js-ad3-15.html" class="prev">
        15. DOM扩展 - JS高程4
      </a></span> <span class="next"><a href="/js/ad3/js-ad3-17.html">
        17. 事件 - JS高程4
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.0bf21a3f.js" defer></script><script src="/assets/js/2.3f8a6b0b.js" defer></script><script src="/assets/js/76.0c3efae1.js" defer></script><script src="/assets/js/3.018b29e2.js" defer></script>
  </body>
</html>
