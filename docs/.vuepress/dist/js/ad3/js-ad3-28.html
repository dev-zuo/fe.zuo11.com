<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>28. 最佳实践 - JS高程4 | 左小白的前端笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="主要介绍三个部分内容：编写可维护的代码、保证代码性能、上线部署。随着 Web 应用程序越来越复杂，编写可维护的代码越来越重要，因为大多数开发者都需要花大量时间去维护别人写的代码。代码可维护性好，可以保证其他开发者更好的完成自己的工作。">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.b41fd11a.css" as="style"><link rel="preload" href="/assets/js/app.0bf21a3f.js" as="script"><link rel="preload" href="/assets/js/2.3f8a6b0b.js" as="script"><link rel="preload" href="/assets/js/89.c53e9e59.js" as="script"><link rel="preload" href="/assets/js/3.018b29e2.js" as="script"><link rel="prefetch" href="/assets/js/10.57230952.js"><link rel="prefetch" href="/assets/js/100.e578cf98.js"><link rel="prefetch" href="/assets/js/101.c335944d.js"><link rel="prefetch" href="/assets/js/102.59769da8.js"><link rel="prefetch" href="/assets/js/103.4919b623.js"><link rel="prefetch" href="/assets/js/104.7fe84002.js"><link rel="prefetch" href="/assets/js/105.ddedb83f.js"><link rel="prefetch" href="/assets/js/106.1fb63622.js"><link rel="prefetch" href="/assets/js/107.2b187808.js"><link rel="prefetch" href="/assets/js/108.8f3d5697.js"><link rel="prefetch" href="/assets/js/109.92d36734.js"><link rel="prefetch" href="/assets/js/11.9dc4d318.js"><link rel="prefetch" href="/assets/js/110.cd88ac77.js"><link rel="prefetch" href="/assets/js/111.12009e8d.js"><link rel="prefetch" href="/assets/js/112.e5c55eb4.js"><link rel="prefetch" href="/assets/js/113.4919bdd4.js"><link rel="prefetch" href="/assets/js/114.dcaf0907.js"><link rel="prefetch" href="/assets/js/115.ef10c8bf.js"><link rel="prefetch" href="/assets/js/116.ee1048fb.js"><link rel="prefetch" href="/assets/js/117.755e22c9.js"><link rel="prefetch" href="/assets/js/118.1ef0e114.js"><link rel="prefetch" href="/assets/js/119.6bf38fb4.js"><link rel="prefetch" href="/assets/js/12.40fc9c5a.js"><link rel="prefetch" href="/assets/js/120.b88059fa.js"><link rel="prefetch" href="/assets/js/121.41bab6f4.js"><link rel="prefetch" href="/assets/js/122.0f544020.js"><link rel="prefetch" href="/assets/js/123.77dd2a30.js"><link rel="prefetch" href="/assets/js/124.15b09dbe.js"><link rel="prefetch" href="/assets/js/125.513515e1.js"><link rel="prefetch" href="/assets/js/126.ddc5a463.js"><link rel="prefetch" href="/assets/js/127.fc469abf.js"><link rel="prefetch" href="/assets/js/128.e6e3b457.js"><link rel="prefetch" href="/assets/js/129.1967580f.js"><link rel="prefetch" href="/assets/js/13.986f7498.js"><link rel="prefetch" href="/assets/js/130.42a72e18.js"><link rel="prefetch" href="/assets/js/131.7eb22a2c.js"><link rel="prefetch" href="/assets/js/132.34350e73.js"><link rel="prefetch" href="/assets/js/133.41fcbd8e.js"><link rel="prefetch" href="/assets/js/134.a0eee4de.js"><link rel="prefetch" href="/assets/js/135.36a70bf4.js"><link rel="prefetch" href="/assets/js/136.e7a92be5.js"><link rel="prefetch" href="/assets/js/137.fdea42b5.js"><link rel="prefetch" href="/assets/js/138.bbd75d1f.js"><link rel="prefetch" href="/assets/js/139.b995a099.js"><link rel="prefetch" href="/assets/js/14.1898890b.js"><link rel="prefetch" href="/assets/js/140.6d940105.js"><link rel="prefetch" href="/assets/js/141.9278b1f0.js"><link rel="prefetch" href="/assets/js/142.bb7a043f.js"><link rel="prefetch" href="/assets/js/143.0c428588.js"><link rel="prefetch" href="/assets/js/144.c9c789b3.js"><link rel="prefetch" href="/assets/js/145.9ad8dfa6.js"><link rel="prefetch" href="/assets/js/146.2759ffa3.js"><link rel="prefetch" href="/assets/js/147.fa54787f.js"><link rel="prefetch" href="/assets/js/148.983ee0a5.js"><link rel="prefetch" href="/assets/js/149.2f7704fe.js"><link rel="prefetch" href="/assets/js/15.5469b4a1.js"><link rel="prefetch" href="/assets/js/150.8d43e986.js"><link rel="prefetch" href="/assets/js/151.b5db9fb6.js"><link rel="prefetch" href="/assets/js/152.5b9728d4.js"><link rel="prefetch" href="/assets/js/153.6f0f7af8.js"><link rel="prefetch" href="/assets/js/154.6cb7fdcc.js"><link rel="prefetch" href="/assets/js/155.38d08870.js"><link rel="prefetch" href="/assets/js/156.6e034fca.js"><link rel="prefetch" href="/assets/js/157.1ca78d6e.js"><link rel="prefetch" href="/assets/js/158.b2fe456f.js"><link rel="prefetch" href="/assets/js/159.395b73d0.js"><link rel="prefetch" href="/assets/js/16.1191ebc2.js"><link rel="prefetch" href="/assets/js/160.e7676793.js"><link rel="prefetch" href="/assets/js/161.cd998bb1.js"><link rel="prefetch" href="/assets/js/162.fd413fe6.js"><link rel="prefetch" href="/assets/js/17.08eb5070.js"><link rel="prefetch" href="/assets/js/18.549c446f.js"><link rel="prefetch" href="/assets/js/19.c6c2139d.js"><link rel="prefetch" href="/assets/js/20.5e6c30dc.js"><link rel="prefetch" href="/assets/js/21.9f0ce5d2.js"><link rel="prefetch" href="/assets/js/22.59722d7f.js"><link rel="prefetch" href="/assets/js/23.886ef483.js"><link rel="prefetch" href="/assets/js/24.0d55fdfc.js"><link rel="prefetch" href="/assets/js/25.b513497e.js"><link rel="prefetch" href="/assets/js/26.38b016e3.js"><link rel="prefetch" href="/assets/js/27.51d9bd77.js"><link rel="prefetch" href="/assets/js/28.eebd8b4e.js"><link rel="prefetch" href="/assets/js/29.f81e9274.js"><link rel="prefetch" href="/assets/js/30.f8b68fed.js"><link rel="prefetch" href="/assets/js/31.84f7c8e8.js"><link rel="prefetch" href="/assets/js/32.ff88cb29.js"><link rel="prefetch" href="/assets/js/33.db9f818a.js"><link rel="prefetch" href="/assets/js/34.8528d11c.js"><link rel="prefetch" href="/assets/js/35.8bc50305.js"><link rel="prefetch" href="/assets/js/36.9bf7c6ff.js"><link rel="prefetch" href="/assets/js/37.fbced13e.js"><link rel="prefetch" href="/assets/js/38.2e4e4f00.js"><link rel="prefetch" href="/assets/js/39.fc6e9198.js"><link rel="prefetch" href="/assets/js/4.450bd9c8.js"><link rel="prefetch" href="/assets/js/40.9b113905.js"><link rel="prefetch" href="/assets/js/41.aa3d1bb9.js"><link rel="prefetch" href="/assets/js/42.154c7e55.js"><link rel="prefetch" href="/assets/js/43.05418d59.js"><link rel="prefetch" href="/assets/js/44.7d1b30f3.js"><link rel="prefetch" href="/assets/js/45.235bbacb.js"><link rel="prefetch" href="/assets/js/46.5df48da3.js"><link rel="prefetch" href="/assets/js/47.36b5639f.js"><link rel="prefetch" href="/assets/js/48.bfd892d3.js"><link rel="prefetch" href="/assets/js/49.a66a16bf.js"><link rel="prefetch" href="/assets/js/5.0322d224.js"><link rel="prefetch" href="/assets/js/50.78efb680.js"><link rel="prefetch" href="/assets/js/51.01901ccc.js"><link rel="prefetch" href="/assets/js/52.e6f696eb.js"><link rel="prefetch" href="/assets/js/53.0484ca91.js"><link rel="prefetch" href="/assets/js/54.737263db.js"><link rel="prefetch" href="/assets/js/55.b3d19b3e.js"><link rel="prefetch" href="/assets/js/56.e0a198b8.js"><link rel="prefetch" href="/assets/js/57.66a8fa47.js"><link rel="prefetch" href="/assets/js/58.07738bb5.js"><link rel="prefetch" href="/assets/js/59.192ce926.js"><link rel="prefetch" href="/assets/js/6.8b6802aa.js"><link rel="prefetch" href="/assets/js/60.dcdf7f83.js"><link rel="prefetch" href="/assets/js/61.28314073.js"><link rel="prefetch" href="/assets/js/62.6215c441.js"><link rel="prefetch" href="/assets/js/63.6008b1cd.js"><link rel="prefetch" href="/assets/js/64.3bc7d0de.js"><link rel="prefetch" href="/assets/js/65.db30ed35.js"><link rel="prefetch" href="/assets/js/66.d15f8a2e.js"><link rel="prefetch" href="/assets/js/67.0ced457a.js"><link rel="prefetch" href="/assets/js/68.b1ebe57b.js"><link rel="prefetch" href="/assets/js/69.c5e2e8e2.js"><link rel="prefetch" href="/assets/js/7.55c6af5e.js"><link rel="prefetch" href="/assets/js/70.9558cbe6.js"><link rel="prefetch" href="/assets/js/71.7bafeaae.js"><link rel="prefetch" href="/assets/js/72.11495184.js"><link rel="prefetch" href="/assets/js/73.f4583008.js"><link rel="prefetch" href="/assets/js/74.266c0400.js"><link rel="prefetch" href="/assets/js/75.564fdd78.js"><link rel="prefetch" href="/assets/js/76.0c3efae1.js"><link rel="prefetch" href="/assets/js/77.329d2bb7.js"><link rel="prefetch" href="/assets/js/78.6399e38c.js"><link rel="prefetch" href="/assets/js/79.8585163e.js"><link rel="prefetch" href="/assets/js/8.143ffc63.js"><link rel="prefetch" href="/assets/js/80.7b73a97a.js"><link rel="prefetch" href="/assets/js/81.6193b516.js"><link rel="prefetch" href="/assets/js/82.e484c003.js"><link rel="prefetch" href="/assets/js/83.5779c505.js"><link rel="prefetch" href="/assets/js/84.57692423.js"><link rel="prefetch" href="/assets/js/85.196c5e69.js"><link rel="prefetch" href="/assets/js/86.98fa0bbb.js"><link rel="prefetch" href="/assets/js/87.d228fd1e.js"><link rel="prefetch" href="/assets/js/88.66941670.js"><link rel="prefetch" href="/assets/js/9.fbf33cae.js"><link rel="prefetch" href="/assets/js/90.ecdad557.js"><link rel="prefetch" href="/assets/js/91.cd7ab71b.js"><link rel="prefetch" href="/assets/js/92.c9874bab.js"><link rel="prefetch" href="/assets/js/93.55306c79.js"><link rel="prefetch" href="/assets/js/94.6beb55f4.js"><link rel="prefetch" href="/assets/js/95.99b7412d.js"><link rel="prefetch" href="/assets/js/96.3298dad6.js"><link rel="prefetch" href="/assets/js/97.9c189b49.js"><link rel="prefetch" href="/assets/js/98.02b0e19b.js"><link rel="prefetch" href="/assets/js/99.6b4d6823.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b41fd11a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">左小白的前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/nav.html" class="nav-link">
  前端网址导航
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><span class="title">前端进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端进阶" class="mobile-dropdown-title"><span class="title">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/daily/" class="nav-link">
  技术日常记录
</a></li><li class="dropdown-item"><!----> <a href="/server/docker.html" class="nav-link">
  Docker 基础
</a></li><li class="dropdown-item"><h4>
          Vue.js
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/base/1.html" class="nav-link">
  Vue.js 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vue-router.html" class="nav-link">
  Vue Router 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vuex.html" class="nav-link">
  Vuex 笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          前端工程化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ts/base-1.html" class="nav-link">
  TypeScript 入门教程笔记
</a></li><li class="dropdown-subitem"><a href="/node/base/1.html" class="nav-link">
  Node.js 笔记
</a></li><li class="dropdown-subitem"><a href="/webpack/base.html" class="nav-link">
  webpack 基础
</a></li></ul></li><li class="dropdown-item"><h4>
          数据可视化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/visual/echarts.html" class="nav-link">
  Echarts 笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          JS/ES6
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/es6/es6-1.html" class="nav-link">
  ES6标准入门(第三版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/ad3/js-ad3-1.html" class="nav-link">
  JavaScript高级程序设计(第四版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/js-dom-art.html" class="nav-link">
  JavaScript DOM编程艺术(第二版)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          CSS/CSS3
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/css/less.html" class="nav-link">
  CSS 预处理器 Less.js
</a></li><li class="dropdown-subitem"><a href="/css/flex-grid.html" class="nav-link">
  Flex与Grid布局
</a></li><li class="dropdown-subitem"><a href="/css/html5-css-1.html" class="nav-link">
  HTML5权威指南(CSS部分)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          HTML/HTML5
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html5/html/1.html" class="nav-link">
  HTML5权威指南(HTML部分)笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/base/js-data-struct.html" class="nav-link">
  学习JavaScript数据结构与算法(第三版)笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/mocha-test.html" class="nav-link">
  Mocha - JavaScript测试框架
</a></li><li class="dropdown-item"><!----> <a href="/base/git.html" class="nav-link">
  Git 笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/markdown.html" class="nav-link">
  Markdown 基础语法
</a></li><li class="dropdown-item"><!----> <a href="/base/dbtheory/1.html" class="nav-link">
  数据库系统原理笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源项目" class="dropdown-title"><span class="title">开源项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="开源项目" class="mobile-dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zuoxiaobai/service-monitor" target="_blank" rel="noopener noreferrer" class="nav-link external">
  service-monitor
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://vuechart.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @guoqzuo/vue-chart
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://zuoblog.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zuo-blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="http://www.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/zuoxiaobai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/nav.html" class="nav-link">
  前端网址导航
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><span class="title">前端进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端进阶" class="mobile-dropdown-title"><span class="title">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/daily/" class="nav-link">
  技术日常记录
</a></li><li class="dropdown-item"><!----> <a href="/server/docker.html" class="nav-link">
  Docker 基础
</a></li><li class="dropdown-item"><h4>
          Vue.js
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/base/1.html" class="nav-link">
  Vue.js 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vue-router.html" class="nav-link">
  Vue Router 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vuex.html" class="nav-link">
  Vuex 笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          前端工程化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ts/base-1.html" class="nav-link">
  TypeScript 入门教程笔记
</a></li><li class="dropdown-subitem"><a href="/node/base/1.html" class="nav-link">
  Node.js 笔记
</a></li><li class="dropdown-subitem"><a href="/webpack/base.html" class="nav-link">
  webpack 基础
</a></li></ul></li><li class="dropdown-item"><h4>
          数据可视化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/visual/echarts.html" class="nav-link">
  Echarts 笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          JS/ES6
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/es6/es6-1.html" class="nav-link">
  ES6标准入门(第三版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/ad3/js-ad3-1.html" class="nav-link">
  JavaScript高级程序设计(第四版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/js-dom-art.html" class="nav-link">
  JavaScript DOM编程艺术(第二版)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          CSS/CSS3
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/css/less.html" class="nav-link">
  CSS 预处理器 Less.js
</a></li><li class="dropdown-subitem"><a href="/css/flex-grid.html" class="nav-link">
  Flex与Grid布局
</a></li><li class="dropdown-subitem"><a href="/css/html5-css-1.html" class="nav-link">
  HTML5权威指南(CSS部分)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          HTML/HTML5
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html5/html/1.html" class="nav-link">
  HTML5权威指南(HTML部分)笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/base/js-data-struct.html" class="nav-link">
  学习JavaScript数据结构与算法(第三版)笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/mocha-test.html" class="nav-link">
  Mocha - JavaScript测试框架
</a></li><li class="dropdown-item"><!----> <a href="/base/git.html" class="nav-link">
  Git 笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/markdown.html" class="nav-link">
  Markdown 基础语法
</a></li><li class="dropdown-item"><!----> <a href="/base/dbtheory/1.html" class="nav-link">
  数据库系统原理笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源项目" class="dropdown-title"><span class="title">开源项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="开源项目" class="mobile-dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zuoxiaobai/service-monitor" target="_blank" rel="noopener noreferrer" class="nav-link external">
  service-monitor
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://vuechart.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @guoqzuo/vue-chart
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://zuoblog.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zuo-blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="http://www.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/zuoxiaobai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JS/ES6</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ES6标准入门(第三版)笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>JavaScript高级程序设计(第四版)笔记</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/js/ad3/js-ad4-diff.html" class="sidebar-link">第四版相比第三版有哪些更新 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-1.html" class="sidebar-link">1. 什么是JavaScript - JS高程4</a></li><li><a href="/js/ad3/js-ad3-2.html" class="sidebar-link">2. 在HTML中使用JavaScript - JS高程4</a></li><li><a href="/js/ad3/js-ad3-3.html" class="sidebar-link">3. ES基本概念(语言基础) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-4.html" class="sidebar-link">4. 变量、作用域与内存 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-5.html" class="sidebar-link">5. 基本引用类型 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-6.html" class="sidebar-link">6. 集合引用类型 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-7.html" class="sidebar-link">7. 迭代器与生成器(Iterator 与 Generator) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-8.html" class="sidebar-link">8. 对象、类与面向对象编程 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-9.html" class="sidebar-link">9. 代理与反射(Proxy与Reflect) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-10.html" class="sidebar-link">10. 函数 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-11.html" class="sidebar-link">11. 期约与异步函数(Promise与async/await) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-12.html" class="sidebar-link">12. BOM - JS高程4</a></li><li><a href="/js/ad3/js-ad3-13.html" class="sidebar-link">13. 客户端检测 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-14.html" class="sidebar-link">14. DOM - JS高程4</a></li><li><a href="/js/ad3/js-ad3-15.html" class="sidebar-link">15. DOM扩展 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-16.html" class="sidebar-link">16. DOM2 和 DOM3 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-17.html" class="sidebar-link">17. 事件 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-18.html" class="sidebar-link">18. 动画与 Canvas 图形 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-19.html" class="sidebar-link">19. 表单脚本 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-20.html" class="sidebar-link">20. JavaScript API - JS高程4</a></li><li><a href="/js/ad3/js-ad3-21.html" class="sidebar-link">21. 错误处理与调试 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-22.html" class="sidebar-link">22. 处理 XML - JS高程4</a></li><li><a href="/js/ad3/js-ad3-23.html" class="sidebar-link">23. JSON - JS高程4</a></li><li><a href="/js/ad3/js-ad3-24.html" class="sidebar-link">24. 网络请求与远程资源 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-25.html" class="sidebar-link">25. 客户端存储 - JS高程4</a></li><li><a href="/js/ad3/js-ad3-26.html" class="sidebar-link">26. 模块(Modules) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-27.html" class="sidebar-link">27. 工作者线程(Web Workers) - JS高程4</a></li><li><a href="/js/ad3/js-ad3-28.html" aria-current="page" class="active sidebar-link">28. 最佳实践 - JS高程4</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#可维护性" class="sidebar-link">可维护性</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#什么是可维护的代码" class="sidebar-link">什么是可维护的代码</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#编码规范-代码约定" class="sidebar-link">编码规范（代码约定）</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#松散耦合" class="sidebar-link">松散耦合</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#编码惯例-推荐的编程实践" class="sidebar-link">编码惯例（推荐的编程实践）</a></li></ul></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#性能" class="sidebar-link">性能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#注意作用域" class="sidebar-link">注意作用域</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#选择正确的方法" class="sidebar-link">选择正确的方法</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#最小化语句数" class="sidebar-link">最小化语句数</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#优化dom交互" class="sidebar-link">优化DOM交互</a></li></ul></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#部署" class="sidebar-link">部署</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#构建流程" class="sidebar-link">构建流程</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#验证" class="sidebar-link">验证</a></li><li class="sidebar-sub-header"><a href="/js/ad3/js-ad3-28.html#压缩" class="sidebar-link">压缩</a></li></ul></li></ul></li><li><a href="/js/ad3/js-ad3-old.html" class="sidebar-link">第三版其他内容(高级技巧) - JS高程4</a></li></ul></section></li><li><a href="/js/js-dom-art.html" class="sidebar-link">JavaScript DOM 编程艺术(第二版)笔记</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_28-最佳实践"><a href="#_28-最佳实践" class="header-anchor">#</a> 28. 最佳实践</h1> <p>主要介绍三个部分内容：编写可维护的代码、保证代码性能、上线部署。随着 Web 应用程序越来越复杂，编写可维护的代码越来越重要，因为大多数开发者都需要花大量时间去维护别人写的代码。代码可维护性好，可以保证其他开发者更好的完成自己的工作。</p> <h2 id="可维护性"><a href="#可维护性" class="header-anchor">#</a> 可维护性</h2> <ol><li>什么是可维护的代码</li> <li>编码规范</li> <li>松散耦合</li> <li>编码惯例</li></ol> <h3 id="什么是可维护的代码"><a href="#什么是可维护的代码" class="header-anchor">#</a> 什么是可维护的代码</h3> <p>一般来说，如果代码是可维护的，它应该遵循以下特点</p> <ul><li>容易理解，其他人可以接手代码并理解它的意图，而无需原开发人员完成解释</li> <li>符合常识，代码中的东西一看就能明白，不管其操作过程多复杂</li> <li>容易适配，可用于多个场景，稍微变化，不需要重写方法。</li> <li>容易扩展，在代码构架上已考虑到在未来允许对核心功能进行扩展</li> <li>容易调试，当有地方出错时，代码可以给予你足够的信息来确定问题所在</li></ul> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>能够写出可维护的 JavaScript 代码是一项重要的专业技能。这就是业余爱好者和专业开发人员之间的区别，前者用一个周末就拼凑出一个网站，而后者真正了解自己的技术。</p></div> <h3 id="编码规范-代码约定"><a href="#编码规范-代码约定" class="header-anchor">#</a> 编码规范（代码约定）</h3> <p>一种让代码变得可维护的简单途径就是形成一套 JS 代码的书写约定</p> <ul><li>可读性</li> <li>变量和函数命名</li> <li>变量类型透明化</li></ul> <h4 id="可读性"><a href="#可读性" class="header-anchor">#</a> 可读性</h4> <p><code>缩进</code> 和 <code>注释</code> 可以带来更可读的代码。代码使用同一种缩进，会更易阅读。需要写注释的地方：</p> <ul><li><strong>函数和方法</strong>。需要注释函数的功能、参数代表什么，返回值。</li> <li><strong>大段代码</strong>。用于完成单个任务的多行代码，应该在前面放一个描述任务的注释</li> <li><strong>复杂的算法</strong>。如果使用一种独特的方式解决问题，需要解释是怎么做的。方便别人维护或者自己后面查看理解</li> <li><strong>使用黑科技（Hack）</strong>。由于浏览器差异，JS 会包括一些 hack，需要注明是用来特别处理哪个浏览器的。</li></ul> <h4 id="变量和函数命名"><a href="#变量和函数命名" class="header-anchor">#</a> 变量和函数命名</h4> <p>适当给变量和函数起名字对于增加代码可理解、可维护性是非常重要的。命名的规则一般如下；</p> <ul><li><strong>变量名应该为名词</strong>，如 car 或 person</li> <li><strong>函数名应该以动词开始</strong>，如 getName()，返回布尔值的函数一般以 is 开头，如isEnable()</li> <li>变量和函数都应<strong>使用合乎逻辑的名字</strong>，<s>不要担心长度</s>，代码混淆压缩会处理长度问题（会被转成 a, b, c, d, f, g 等）</li> <li><strong>变量、函数和方法应该以小写字母开头，使用驼峰大小写</strong>（camelCase）形式，如 getName() 和 isPerson。<strong>类名首字母应该大小</strong>。如 Person、RequestFactory。<strong>常量值应该全部大写，并以下划线相接</strong>，比如：REQUEST_TIMEOUT。</li> <li>名称尽量用<strong>描述性和直观的词汇</strong>，<strong>但不要过于冗长</strong>，如果 getName()，一看就是返回名称。</li></ul> <p><strong>要完全避免没有用的变量名，例如不能表示所包含数据类型的变量名。通过适当命名，代码读起来就像故事，更容易理解。</strong></p> <h4 id="变量类型透明"><a href="#变量类型透明" class="header-anchor">#</a> 变量类型透明</h4> <p>由于 JS 中变量是松散类型的，很容易忘记变量所应包含的数据类型，有三种表示数据类型的方式：</p> <ol><li>通过 <strong>初始化</strong> 标明数据类型。ES6之后，可以在函数参数里指定默认值标明参数类型。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 定义一个变量后初始化对应的值，指定变量类型</span>
<span class="token keyword">var</span> found <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 布尔型</span>
<span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>    <span class="token comment">// 数字</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>     <span class="token comment">// 字符串</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 对象</span>
<span class="token comment">// 缺点: 在用于函数参数时会显得用处不大</span>
</code></pre></div><ol start="2"><li>使用 <strong>匈牙利标记法</strong> 标明数据类型，在变量名之前加一个或多个字符来表示数据类型。比如：o 表示对象，s 表示字符串，i 表示整数，f 表示浮点数，b 表示布尔值。缺点：使代码可读性降低，不够直观，破坏了类似句子的阅读流畅性，不推荐使用。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 匈牙利标记法标明数据类型</span>
<span class="token keyword">var</span> bFound<span class="token punctuation">;</span> <span class="token comment">// 布尔型</span>
<span class="token keyword">var</span> iCount<span class="token punctuation">;</span> <span class="token comment">// 整数</span>
<span class="token keyword">var</span> sName<span class="token punctuation">;</span>  <span class="token comment">// 字符串</span>
<span class="token keyword">var</span> oPerson<span class="token punctuation">;</span> <span class="token comment">// 对象</span>
</code></pre></div><ol start="3"><li><strong>使用类型注释</strong>，类型注释放到变量名后面，初始化表达式的前面。缺点：/* */注释无法嵌套。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 指定变量类型的方式使用类型注释</span>
<span class="token keyword">var</span> found  <span class="token comment">/* :Boolean */</span> <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> count  <span class="token comment">/* :int */</span> <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> name   <span class="token comment">/* :String */</span> <span class="token operator">=</span> <span class="token string">&quot;guoqzuo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> person <span class="token comment">/* :Object */</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre></div><p>以上三种方法，可根据实际情况选择合适自己的，但要注意保持一致性。</p> <h3 id="松散耦合"><a href="#松散耦合" class="header-anchor">#</a> 松散耦合</h3> <p>如果应用的某个部分依赖于另一个部分过于紧密，代码就是耦合过紧，难以维护。</p> <ol><li>解耦 HTML/JS</li> <li>解耦 CSS/JS</li> <li>解耦应用程序逻辑/事件处理程序</li></ol> <ul><li><strong>解耦 HTML/JS</strong>，直接写在 HTML 里的 JS，或在 JS 里面写的 HTML 尽量避免。绑定方法及函数最好都写在 JS 里。HTML 呈现尽可能与 JS 保持分离，如果 JS 需要操作 TML，尽量先隐藏再显示，而不是用 JS 生成。理论上这样更优利与维护，可以快速知道是 HTML 的问题还是 JS 的问题。</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 使用了&lt;script&gt;的紧密耦合的 HTML/JS --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;hello world!&quot;</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 使用事件处理程序属性值的紧密耦合的HTML/JS --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Click me<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>doSomething()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 将 HTML 紧密耦合到 JS，下设下面的代码在某个 JS 中 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">function</span> <span class="token function">insertMessage</span><span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> container <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;container&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    container<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;&lt;div class='msg'&gt;&lt;p class='post'&gt;&quot;</span><span class="token operator">+</span> msg <span class="token operator">+</span> <span class="token string">&quot;&lt;/p&gt;&lt;/div&gt;&quot;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li><strong>解耦 CSS/JS</strong>，样式操作尽量只放到 css 中，不要放到 JS 中操作。如果必须，可以使用改变 class 的方式来切换样式</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// CSS 对 JS 的松散耦合</span>
element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
element<span class="token punctuation">.</span>style<span class="token punctuation">.</span>backgroundColor <span class="token operator">=</span> <span class="token string">&quot;blud&quot;</span>

<span class="token comment">// 需要通过 class 来解耦</span>
element<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;edit&quot;</span>
</code></pre></div><ul><li><strong>解耦应用程序逻辑/事件处理程序</strong>，下面的代码中，事件处理程序 handleKeyPress，与应用程序逻辑（当 target.value &gt; 2 时显示错误）耦合。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">handleKeyPress</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode <span class="token operator">===</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target
    <span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'error-msg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;block&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>更好的方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 应用程序逻辑</span>
<span class="token keyword">function</span> <span class="token function">validateValue</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  value <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">&gt;</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'error-msg'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;block&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 事件处理程序</span>
<span class="token keyword">function</span> <span class="token function">handleKeyPress</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>event<span class="token punctuation">.</span>keyCode <span class="token operator">===</span> <span class="token number">13</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> target <span class="token operator">=</span> event<span class="token punctuation">.</span>target
    <span class="token function">validateValue</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样做的好处：</p> <ul><li>如果后续事件也会对应相同应用程序逻辑，则会导致重复代码，分离后如果有变动，改动很小。</li> <li>可以在不添加事件的情况下测试代码，这样创建单元测试或自动化应用程序都会更简单。</li></ul> <p>应用和业务逻辑之间松散耦合的几条原则：</p> <ul><li>不要将 event 对象传给其他方法，只传来自 event 对象中所需的数据</li> <li>任何可以在应用层面的动作都应该可以在不执行任何事件处理程序的情况下进行</li> <li>任何事件处理程序都应该处理该事件，然后将处理交给应用逻辑</li></ul> <h3 id="编码惯例-推荐的编程实践"><a href="#编码惯例-推荐的编程实践" class="header-anchor">#</a> 编码惯例（推荐的编程实践）</h3> <ol><li>尊重对象所有权</li> <li>不声明全局变量</li> <li>避免与 null 进行比较</li> <li>使用常量</li></ol> <p><strong>尊重对象所有权</strong>，如果不是你自己负责创建和维护的某个对象、构造函数或方法。</p> <ul><li>不要为实例或原型添加属性</li> <li>不要为实例或原型添加方法</li> <li>不要重定义已存在的方法</li></ul> <p>推荐方法</p> <ul><li>创建包含所需功能的新对象，并用它与别人的对象交互</li> <li>创建自定义类型，继承需要修改的类型，然后为自定义类型添加额外功能</li></ul> <p><strong>不声明全局变量</strong>，如果需要，最多只创建一个全局变量，用对象的形式包裹</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 两个全局变量要避免</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> <span class="token string">&quot;guoqzuo&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 推荐改为一个全局变量</span>
<span class="token keyword">var</span> MyApplication <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;guoqzuo&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>全局变量为了避免与其他人或其他引入库的名称有冲突，尽量使用特别一点的名称，用项目名称加前缀</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 例如 YAHOO 的 Wrox</span>
<span class="token comment">// 创建全局变量</span>
<span class="token keyword">var</span> Wrox <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Wrox<span class="token punctuation">.</span>ProJS <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 创建Professional JS 命名空间</span>
Wrox<span class="token punctuation">.</span>ProJS<span class="token punctuation">.</span>EventUtil <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Wrox<span class="token punctuation">.</span>ProJS<span class="token punctuation">.</span>CookieUtil <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>避免与 null 进行比较</strong>，如果看到了与null比较的代码，尝试使用以下技术替换：</p> <ul><li>如果值应该是一个引用类型，使用 instanceof 操作检查器构造函数</li> <li>如果值是一个基本类型，使用 typeof 检查其类型</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">sortArray</span><span class="token punctuation">(</span><span class="token parameter">values</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>values <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 避免</span>
    values<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 必须按照所期望的值进行检查，而非按照不期望的那些</span>
<span class="token keyword">function</span> <span class="token function">sortArray</span><span class="token punctuation">(</span><span class="token parameter">values</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>values <span class="token keyword">instanceof</span> <span class="token class-name">Array</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 推荐</span>
    values<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>使用常量</strong>, 下面是需要使用常量的几个地方：</p> <ol><li><strong>重复值</strong>，任何使用超过一次的值都应该抽取为一个常量，这样可以消除一个值改变了，而另一个值没改照成的错误。</li> <li><strong>用户界面的字符串</strong>，任何用于显示给用户的字符串，都应该被抽取出来，以方便国际化。</li> <li><strong>URL</strong>，在web应用中，资源位置很容易变更，推荐用一个公共的地方存放所有的URL。</li> <li><strong>任何可能变化的值</strong>，任何时候如果在代码中使用字面量值，需要问一下自己，这个值以后是否会变化，如果是，就可以把它提取到常量中。</li></ol> <h2 id="性能"><a href="#性能" class="header-anchor">#</a> 性能</h2> <p>JS 是一种解释型语言，比编译型语言要慢的多。Chrome 是第一款内置优化引擎，将 JS 编译为原生代码的浏览器，此后主流浏览器陆续效仿实现了 JS 编译执行。即使到了编译执行的 JS 新阶段，但仍然会存在低效率代码。不过还是有一些方式可以改进代码的整体性能</p> <h3 id="注意作用域"><a href="#注意作用域" class="header-anchor">#</a> 注意作用域</h3> <p>访问全局变量总是要比访问局部变量慢，因为需要遍历作用域链。只要减少花费在作用域链上的时间，就能增加脚本的整体性能</p> <ul><li><strong>避免全局查找</strong>，将一个函数中会用到多次的全局对象存储为局部变量总是没错的。下面的函数看上去完全正常，但包含了三个对全局 document 对象的引用。如果页面有很多图片，for 循环中，需要引用 document 几十甚至上百次，每次都要遍历一次作用域链。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// </span>
<span class="token keyword">function</span> <span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> img <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementByTagName</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token operator">=</span>imgs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>title <span class="token operator">=</span> document<span class="token punctuation">.</span>title <span class="token operator">+</span> <span class="token string">'image'</span> <span class="token operator">+</span> i<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> msg <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  msg<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;Update complete&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以通过创建一个指向 document 的局部变量，来优化。这样在当前函数的作用域内就能找到。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">updateUI</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> doc <span class="token operator">=</span> document<span class="token punctuation">;</span>
  <span class="token keyword">var</span> img <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">getElementByTagName</span><span class="token punctuation">(</span><span class="token string">'img'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len<span class="token operator">=</span>imgs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    imgs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>title <span class="token operator">=</span> doc<span class="token punctuation">.</span>title <span class="token operator">+</span> <span class="token string">'image'</span> <span class="token operator">+</span> i<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> msg <span class="token operator">=</span> doc<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  msg<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">&quot;Update complete&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><strong>避免with语句</strong>（with语句会创建自己的作用域，会增加其中执行代码的作用域长度）</li></ul> <h3 id="选择正确的方法"><a href="#选择正确的方法" class="header-anchor">#</a> 选择正确的方法</h3> <p>算法的复杂度使用 O 符号表示，最简单、最快捷的算法是常数值，即 O(1)。</p> <table><thead><tr><th>表示法</th> <th>说明</th></tr></thead> <tbody><tr><td>O(1)</td> <td>不管有多少值，执行的时间恒定。一般表示简单值何存储在变量中的值。</td></tr> <tr><td>O(log n)</td> <td>总执行时间和值的数量相关，但是要完成算法并不一定要获取每个值，如：二分查找</td></tr> <tr><td>O(n)</td> <td>总执行时间和值的数量相关，如：遍历某个数组中的所有元素</td></tr> <tr><td>O(n²)</td> <td>总执行时间和值的数量有关，每个值至少获取 n 次，如：插入排序</td></tr></tbody></table> <p><strong>1. 避免不必要的属性查找</strong>，使用变量和数组要比访问对象的属性更有效率，后者是一个O(n)操作。对象上的任何属性查找都要比访问变量或者数组花费的时间更长。属性查找越多，执行时间越长。一般只要能减少算法的复杂度，就要尽可能减少。</p> <p><strong>能够使用数组的情况，就不要使用对象，数组访问元素O(1)，对象访问属性时间复杂度O(n)。</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 不推荐</span>
<span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token punctuation">{</span> first<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> second<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> sum <span class="token operator">=</span> values<span class="token punctuation">.</span>first <span class="token operator">+</span> values<span class="token punctuation">.</span>second<span class="token punctuation">;</span>
<span class="token function">alert</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 数组查找的速度比上面的属性查找要快</span>
<span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> sum <span class="token operator">=</span> values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token function">alert</span><span class="token punctuation">(</span>sum<span class="token punctuation">)</span>
</code></pre></div><p>另外避免多次查找获取一个值，例如下面的例子中存在重复的属性查找</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> query <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>可以优化为</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> url <span class="token operator">=</span> window<span class="token punctuation">.</span>location<span class="token punctuation">.</span>href
<span class="token keyword">let</span> query <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'?'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>2. 优化循环</strong>，一个循环的基本优化步骤如下：</p> <ul><li><s>减值迭代</s>，第四版已删除，旧版浏览器效率更高，现代浏览器基本无差别。</li> <li>简化终止条件，由于每次循环过程都会记录终止条件，所以必须保证它尽可能快，也就是说避免属性查找或其他 O(n) 的操作</li> <li>简化循环体，循环体内需要最大限度的优化，确保没有某些可以被很容易移出循环体的密集计算</li> <li>使用后测试循环，for 循环和 while 循环都是先测试循环。而 do-while 这种后测试循环，避免了对终止条件的初始评估，会更快。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>优化 =&gt; 减值迭代、简化终止条件，只执行一次 .length属性查找（前提是改变遍历顺序对功能没影响）</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> values<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>后循环优化 =&gt; 至少要确保处理的值有一个，空数组会导致多余的一次循环，前测试循环可以避免这种情况</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> i <span class="token operator">=</span> values<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token operator">--</span>i <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>3. 展开循环</strong>，如果循环的次数是确定的，消除循环直接调用多次函数，往往更快</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 有限次数的循环</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 消除循环</span>
<span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如果循环中的迭代次数不能事先确定，可以考虑一种叫做 <code>达夫设备（Duff's Device</code> 技术。该技术以其发明者 Tom Duff 命名，最早建议在 C 语言中使用该技术，在 JS 中实现 Duff's device 的是 Jeff Greenberg。它的基本思路是：以 8 的倍数作为迭代次数，从而将循环展开。<strong>对于大型数据集，可以节省很多时间，但如果对于小数据集，额外的开销则可能得不偿失。</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Jeff Greenberg 在 JS 中实现 Duff’s Device(达夫设备)</span>
<span class="token comment">// 假设 values.length &gt; 0</span>
<span class="token keyword">let</span> iterations <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> startAt <span class="token operator">=</span> values<span class="token punctuation">.</span>length <span class="token operator">%</span> <span class="token number">8</span>
<span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">do</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span><span class="token punctuation">(</span>startAt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span> <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">7</span><span class="token operator">:</span> <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">6</span><span class="token operator">:</span> <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">5</span><span class="token operator">:</span> <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">4</span><span class="token operator">:</span> <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span> <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span> <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  startAt <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>iterations <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><p>上面的例子中，switch 中没有用 break，startAt 取余为 0 ，就执行 8 次，为 7 就执行 7 次，再依次递减。<strong>这样展开之后，能够加快数据集的处理速度</strong>。</p> <p>再来看一个更快的达夫设备实现</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Andrew B.King《Speed Up Your Site》快 40% 左右</span>
<span class="token keyword">let</span> iterations <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span>length <span class="token operator">/</span> <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> leftover <span class="token operator">=</span> values<span class="token punctuation">.</span>length <span class="token operator">%</span> <span class="token number">8</span>
<span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>leftover <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">do</span> <span class="token punctuation">{</span>
    <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>leftover <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">do</span> <span class="token punctuation">{</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token function">process</span><span class="token punctuation">(</span>values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">--</span>iterations <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>4. 避免重复解释</strong>，这种问题存在于当 JS 代码尝试解释 JS 代码的时候。使用 eval() 函数或 Function 构造函数，或者 setTimeout() 传入一个字符串参数时，都会发生这种情况</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 某些代码求值 --- 避免！！</span>
<span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">&quot;alert('hello world')&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建新函数 --- 避免！！</span>
<span class="token keyword">var</span> sayHi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">&quot;alert('Hello world!')&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 设置超时 --- 避免!!</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token string">&quot;alert('hello world!')&quot;</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
</code></pre></div><p>修正</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 直接写出来</span>
<span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
<span class="token comment">// 创建新函数，直接写出来</span>
<span class="token keyword">var</span> <span class="token function-variable function">sayHi</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 设置超时函数，直接写出来</span>
<span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'Hello world!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>5. 性能的其它注意事项</strong></p> <ul><li><strong>原生的方法较快</strong>，只要有可能，使用原生的方法而不是自己写一个。原生方法是用诸如 C/C++ 之类的编译型语言写出来的，比 js 要快很多。</li> <li><strong>switch 语句很快</strong>, 如果有复杂的 if-else，使用 switch 会更快，可以通过将 case 语句按照最可能到最不可能的顺序进行组织会更高效。</li> <li><strong>位运算符很快</strong> ，当进行数学运算时，位运算比任何布尔运算或数值计算更快。像求模、逻辑与 和 逻辑或 都可以考虑用位运算替换。</li></ul> <h3 id="最小化语句数"><a href="#最小化语句数" class="header-anchor">#</a> 最小化语句数</h3> <p>找出可以组合为一起的语句组合为一条语句，比执行多条语句要快</p> <ol><li>多个变量声明，合成一个</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 不推荐</span>
<span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> color <span class="token operator">=</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 推荐优化 =&gt; 4个语句转换为一个语句</span>
<span class="token keyword">let</span> count <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span>
    color <span class="token operator">=</span> <span class="token string">&quot;blue&quot;</span><span class="token punctuation">,</span>
    values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="2"><li>插入迭代值</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
i<span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token comment">// 可以优化为</span>
<span class="token keyword">var</span> name <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token operator">++</span><span class="token punctuation">]</span> 
</code></pre></div><ol start="3"><li>使用数组和对象字面量</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用4个语句创建和初始化数组 --- 浪费</span>
<span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
values<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">123</span><span class="token punctuation">;</span>
values<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">456</span><span class="token punctuation">;</span>
values<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">789</span><span class="token punctuation">;</span>

<span class="token comment">// 只用一条语句创建何初始化数组</span>
<span class="token keyword">var</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">124</span><span class="token punctuation">,</span> <span class="token number">456</span><span class="token punctuation">,</span> <span class="token number">789</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 用4个语句创建何初始化对象 --- 浪费</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
person<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'guoqzuo'</span><span class="token punctuation">;</span>
person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">29</span><span class="token punctuation">;</span>
person<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 只用一条语句创建何初始胡对象</span>
<span class="token keyword">var</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;guoqzuo&quot;</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">29</span><span class="token punctuation">,</span>
  <span class="token function-variable function">sayName</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>适当的减少语句可以提升执行速度，但一味的追求语句最小化，可能导致一条语句容纳过多的逻辑，难以理解。</p></div> <h3 id="优化dom交互"><a href="#优化dom交互" class="header-anchor">#</a> 优化DOM交互</h3> <p>在 JS 的各个方面中，DOM 毫无疑问是最慢的一部分，DOM 操作要消耗大量的时间，因为他们往往需要重新渲染整个页面或者某一部分。理解如何优化DOM 的交互可以极大提高脚本完成的速度。</p> <ul><li><ol><li><strong>实时更新最小化</strong>，访问 DOM 时，只要访问的 DOM 部分已经是显示页面的一部分，就是在执行实时更新操作。每一个更新，浏览器要重新计算千项指标以进行更新。实时更新越多，代码执行耗费时间越长。</li></ol></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// ul 添加 10 个 li，每次 for 循环都需要执行实时更新：总共20个实时更新。</span>
<span class="token keyword">var</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myList'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    item<span class="token punctuation">,</span>
    i<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  item <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElementByIf</span><span class="token punctuation">(</span><span class="token string">&quot;li&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  list<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  item<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">&quot;Item&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>用文档碎片（createDocumentFragment）来构建 DOM 结构，只会进行一次现场更新</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'myList'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    fragment <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDocumentFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    item<span class="token punctuation">,</span>
    i<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  item <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElementByIf</span><span class="token punctuation">(</span><span class="token string">&quot;li&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  item<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">&quot;Item&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  fragment<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
list<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>fragement<span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>2. 使用innerHTML</strong>，有两种方法创建新的 dom 结点：使用 createElement() 和 appendChild()，或者 innerHTML。如果是少量 DOM 更新，两种技术区别不大，对于大量 DOM 更改，对使用 innerHTML 比标准 DOM 方法创建同样的 DOM 结构快的多，当赋值 innerHTML 时，后台会创一个 HTML 解析器，使用原生 DOM 调用，而不是 JS 的 DOM 方法创建 DOM 结构。内部方法是编译好的，所以执行的会快很多。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 改写上面的方法</span>
<span class="token keyword">var</span> list <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;myList&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    html <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
    i<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  html <span class="token operator">+=</span> <span class="token string">&quot;&lt;li&gt;Item &quot;</span> <span class="token operator">+</span> i <span class="token operator">+</span> <span class="token string">&quot;&lt;/li&gt;&quot;</span><span class="token punctuation">;</span> 
<span class="token punctuation">}</span>
list<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> html<span class="token punctuation">;</span>
</code></pre></div><ul><li><strong>3. 使用事件代理</strong>，页面上的事件处理数量越多，页面响应用户交互的速度会较慢，尽量可以多个时间相结合。共用一个事件处理程序.</li> <li><strong>4. 注意HTMLCollection</strong>， 不要在循环的判断里使用该对象的 length 属性。只要访问 HTMLCollection ，无论是它的属性还是方法，都会触发查询文档，这个查询文档相当耗时。减少访问 HTMLCollection 的次数，可以极大提升性能。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. 初始化时，优化 len，不用每次遍历都去取; </span>
<span class="token comment">// 2. 每次遍历都先把对应的值用局部全量存起来，避免对 HTMLCollection 查询</span>
<span class="token keyword">let</span> imgs <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementsByTagName</span><span class="token punctuation">(</span><span class="token string">&quot;img&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    image<span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> imgs<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  image <span class="token operator">=</span> images<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
  <span class="token comment">// 处理</span>
<span class="token punctuation">}</span>
</code></pre></div><p>发生以下情况会返回 HTMLCollection 对象:（或者其类似的对象，比如 NodeList、NamedNodeMap）</p> <ul><li>进行了 getElementsByTagName()</li> <li>获取了元素的 childNodes（NodeList），元素的 children 属性是 HTMLCollection</li> <li>获取了元素的 attributes 属性，NamedNodeMap，属性集合类似 HTMLCollection</li> <li>访问了特殊的集合，如 document.forms，document.images 等</li></ul> <h2 id="部署"><a href="#部署" class="header-anchor">#</a> 部署</h2> <p>部署上线之前一般需要打包构建、验证、压缩。这一章主要讲打包构建的一些细节处理。</p> <h3 id="构建流程"><a href="#构建流程" class="header-anchor">#</a> 构建流程</h3> <p>为什么需要构建：</p> <ul><li>知识产权问题：将源码直接部署到服务器，会有安全风险，可以直接看到 JS 代码。</li> <li>文件大小：文件多余的空格、缩进，冗余的函数和变量名存在优化文件 Size 的空间。</li> <li>代码组织：JS 各个模块需要比较好的组织，用以提高性能。</li></ul> <p><strong>任务运行器</strong>：任务运行器可以完成代码检查、打包、转译、启动本地服务器、部署，以及其他可以脚本化的任务。如：Grunt、Gulp。</p> <p><strong>摇树优化（tree shaking）</strong>：可以按需打包，将没有用到的代码，排除在打包文件之外。</p> <p><strong>模块打包器</strong>：Webpack、Rollup等，将基于模块的代码转换为普遍兼容的网页脚本。</p> <h3 id="验证"><a href="#验证" class="header-anchor">#</a> 验证</h3> <p>一般使用 JSLint/ESLint 验证，发现 JS 代码中语法错误和常见的编码错误。</p> <h3 id="压缩"><a href="#压缩" class="header-anchor">#</a> 压缩</h3> <ol><li><strong>代码压缩（compression）</strong>，去掉空格、换行、注释、缩短变量名，函数名或其他标识符。</li> <li><strong>JS 编译（compilation）</strong>，类似于最小化（minification）。删除未使用的代码，将某些代码转换为更简洁的语法，全局函数调用、常量、变量行内化。</li> <li><strong>JS 转译（transpilation）</strong>，使用 Babel 将 ES6+ 代码转换为 ES3/ES5 代码，兼容性更好。</li> <li><strong>HTTP 压缩</strong>，一般 HTTP 请求支持 Content-Encoding，一般是 gzip 压缩或 br，可以减少文件大小，让网络传输更快。</li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020/12/13 上午5:07:38</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/js/ad3/js-ad3-27.html" class="prev">
        27. 工作者线程(Web Workers) - JS高程4
      </a></span> <span class="next"><a href="/js/ad3/js-ad3-old.html">
        第三版其他内容(高级技巧) - JS高程4
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.0bf21a3f.js" defer></script><script src="/assets/js/2.3f8a6b0b.js" defer></script><script src="/assets/js/89.c53e9e59.js" defer></script><script src="/assets/js/3.018b29e2.js" defer></script>
  </body>
</html>
