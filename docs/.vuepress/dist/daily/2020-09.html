<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2020年09月技术日常 | 左小白的前端笔记</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="左小白的前端笔记，归纳整理自己在前端工作、学习中的一些心得笔记，有利于前端知识系统化。包括 Vue.js、前端工程化（TypeScript、Node.js、webpack）、Docker、JS/ES6、CSS/CSS3、HTML/HTML5、数据可视化、计算机基础、英语等笔记。">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.acaf374f.css" as="style"><link rel="preload" href="/assets/js/app.1896936c.js" as="script"><link rel="preload" href="/assets/js/2.4b3539f1.js" as="script"><link rel="preload" href="/assets/js/43.b71e8ebe.js" as="script"><link rel="preload" href="/assets/js/3.e6a4dd76.js" as="script"><link rel="prefetch" href="/assets/js/10.35d8cd15.js"><link rel="prefetch" href="/assets/js/100.bdceea35.js"><link rel="prefetch" href="/assets/js/101.d0d3894b.js"><link rel="prefetch" href="/assets/js/102.6a11a958.js"><link rel="prefetch" href="/assets/js/103.8c09b3d9.js"><link rel="prefetch" href="/assets/js/104.943d878d.js"><link rel="prefetch" href="/assets/js/105.e926c92c.js"><link rel="prefetch" href="/assets/js/106.b94547eb.js"><link rel="prefetch" href="/assets/js/107.7c5a66d3.js"><link rel="prefetch" href="/assets/js/108.4d90552a.js"><link rel="prefetch" href="/assets/js/109.761bf29e.js"><link rel="prefetch" href="/assets/js/11.69640d31.js"><link rel="prefetch" href="/assets/js/110.3dd49573.js"><link rel="prefetch" href="/assets/js/111.0d0c3efb.js"><link rel="prefetch" href="/assets/js/112.c1d010f0.js"><link rel="prefetch" href="/assets/js/113.3cfb05d7.js"><link rel="prefetch" href="/assets/js/114.f5f53339.js"><link rel="prefetch" href="/assets/js/115.d75d14d7.js"><link rel="prefetch" href="/assets/js/116.dfd7381e.js"><link rel="prefetch" href="/assets/js/117.3ded5d6b.js"><link rel="prefetch" href="/assets/js/118.6e3efb2c.js"><link rel="prefetch" href="/assets/js/119.1b91edce.js"><link rel="prefetch" href="/assets/js/12.de62d2b5.js"><link rel="prefetch" href="/assets/js/120.78cd3dbb.js"><link rel="prefetch" href="/assets/js/121.e45e6547.js"><link rel="prefetch" href="/assets/js/122.134dadd1.js"><link rel="prefetch" href="/assets/js/123.7ae2653c.js"><link rel="prefetch" href="/assets/js/124.2153b3b4.js"><link rel="prefetch" href="/assets/js/125.8e6a815e.js"><link rel="prefetch" href="/assets/js/126.aa60aeb5.js"><link rel="prefetch" href="/assets/js/127.e4faeb37.js"><link rel="prefetch" href="/assets/js/128.8bf8ca5b.js"><link rel="prefetch" href="/assets/js/129.864d215e.js"><link rel="prefetch" href="/assets/js/13.82e7edce.js"><link rel="prefetch" href="/assets/js/130.7112ecd6.js"><link rel="prefetch" href="/assets/js/131.15b6f756.js"><link rel="prefetch" href="/assets/js/132.ce65f07e.js"><link rel="prefetch" href="/assets/js/133.c62149d4.js"><link rel="prefetch" href="/assets/js/134.a32dedb3.js"><link rel="prefetch" href="/assets/js/135.dc558866.js"><link rel="prefetch" href="/assets/js/136.e0e9a2a5.js"><link rel="prefetch" href="/assets/js/137.bd672a56.js"><link rel="prefetch" href="/assets/js/138.a671c9bf.js"><link rel="prefetch" href="/assets/js/139.a6ba57ff.js"><link rel="prefetch" href="/assets/js/14.23d6e014.js"><link rel="prefetch" href="/assets/js/140.3c656455.js"><link rel="prefetch" href="/assets/js/141.833d9b8c.js"><link rel="prefetch" href="/assets/js/142.5d1224ae.js"><link rel="prefetch" href="/assets/js/143.e98b3a46.js"><link rel="prefetch" href="/assets/js/144.ca528765.js"><link rel="prefetch" href="/assets/js/145.268584f2.js"><link rel="prefetch" href="/assets/js/146.bac07533.js"><link rel="prefetch" href="/assets/js/147.9b5d8a01.js"><link rel="prefetch" href="/assets/js/148.c40adbd7.js"><link rel="prefetch" href="/assets/js/15.6d52c5f9.js"><link rel="prefetch" href="/assets/js/16.c1f27d77.js"><link rel="prefetch" href="/assets/js/17.02588c41.js"><link rel="prefetch" href="/assets/js/18.50bc4846.js"><link rel="prefetch" href="/assets/js/19.63659292.js"><link rel="prefetch" href="/assets/js/20.e91dc934.js"><link rel="prefetch" href="/assets/js/21.ab7433ef.js"><link rel="prefetch" href="/assets/js/22.f96f7f7f.js"><link rel="prefetch" href="/assets/js/23.9670a582.js"><link rel="prefetch" href="/assets/js/24.9b6f6c0e.js"><link rel="prefetch" href="/assets/js/25.f7468bea.js"><link rel="prefetch" href="/assets/js/26.2fa477e0.js"><link rel="prefetch" href="/assets/js/27.4dc6c393.js"><link rel="prefetch" href="/assets/js/28.4a449035.js"><link rel="prefetch" href="/assets/js/29.85d5bed9.js"><link rel="prefetch" href="/assets/js/30.1fd31f04.js"><link rel="prefetch" href="/assets/js/31.6ccde381.js"><link rel="prefetch" href="/assets/js/32.e0ed3466.js"><link rel="prefetch" href="/assets/js/33.b4dfd8c7.js"><link rel="prefetch" href="/assets/js/34.afe43169.js"><link rel="prefetch" href="/assets/js/35.4731079c.js"><link rel="prefetch" href="/assets/js/36.76e1a2c0.js"><link rel="prefetch" href="/assets/js/37.61937dee.js"><link rel="prefetch" href="/assets/js/38.ba75389a.js"><link rel="prefetch" href="/assets/js/39.f8ce8b8d.js"><link rel="prefetch" href="/assets/js/4.1546fae2.js"><link rel="prefetch" href="/assets/js/40.8bb1b7f0.js"><link rel="prefetch" href="/assets/js/41.2bb01b3f.js"><link rel="prefetch" href="/assets/js/42.86da7456.js"><link rel="prefetch" href="/assets/js/44.12420079.js"><link rel="prefetch" href="/assets/js/45.75fcde41.js"><link rel="prefetch" href="/assets/js/46.e4207871.js"><link rel="prefetch" href="/assets/js/47.5f7bc7e8.js"><link rel="prefetch" href="/assets/js/48.e13e8880.js"><link rel="prefetch" href="/assets/js/49.a3ecd5bb.js"><link rel="prefetch" href="/assets/js/5.a74a6229.js"><link rel="prefetch" href="/assets/js/50.9dd30f76.js"><link rel="prefetch" href="/assets/js/51.593ae5ef.js"><link rel="prefetch" href="/assets/js/52.a33c9e05.js"><link rel="prefetch" href="/assets/js/53.1f6ab5f6.js"><link rel="prefetch" href="/assets/js/54.a0b9a641.js"><link rel="prefetch" href="/assets/js/55.55e1ba42.js"><link rel="prefetch" href="/assets/js/56.03b715f9.js"><link rel="prefetch" href="/assets/js/57.5a89c1ff.js"><link rel="prefetch" href="/assets/js/58.ac90f180.js"><link rel="prefetch" href="/assets/js/59.b6a5fcdf.js"><link rel="prefetch" href="/assets/js/6.68e7d734.js"><link rel="prefetch" href="/assets/js/60.276cc185.js"><link rel="prefetch" href="/assets/js/61.e77e984a.js"><link rel="prefetch" href="/assets/js/62.872daaa3.js"><link rel="prefetch" href="/assets/js/63.6ecde522.js"><link rel="prefetch" href="/assets/js/64.1a6d4a06.js"><link rel="prefetch" href="/assets/js/65.3cca1278.js"><link rel="prefetch" href="/assets/js/66.d4482a48.js"><link rel="prefetch" href="/assets/js/67.ae4fddbc.js"><link rel="prefetch" href="/assets/js/68.dbef2405.js"><link rel="prefetch" href="/assets/js/69.72d93c34.js"><link rel="prefetch" href="/assets/js/7.cb937ed7.js"><link rel="prefetch" href="/assets/js/70.318cc874.js"><link rel="prefetch" href="/assets/js/71.92ec6bbe.js"><link rel="prefetch" href="/assets/js/72.e7ec6774.js"><link rel="prefetch" href="/assets/js/73.d56f83ff.js"><link rel="prefetch" href="/assets/js/74.23f1770f.js"><link rel="prefetch" href="/assets/js/75.7d20227b.js"><link rel="prefetch" href="/assets/js/76.3b779319.js"><link rel="prefetch" href="/assets/js/77.b0c0625b.js"><link rel="prefetch" href="/assets/js/78.60f92922.js"><link rel="prefetch" href="/assets/js/79.fac38026.js"><link rel="prefetch" href="/assets/js/8.fd308b1b.js"><link rel="prefetch" href="/assets/js/80.56204cb4.js"><link rel="prefetch" href="/assets/js/81.44fb497a.js"><link rel="prefetch" href="/assets/js/82.5de38cfa.js"><link rel="prefetch" href="/assets/js/83.a0b3a349.js"><link rel="prefetch" href="/assets/js/84.df0fd1e9.js"><link rel="prefetch" href="/assets/js/85.ccbb0b3c.js"><link rel="prefetch" href="/assets/js/86.7f2065b9.js"><link rel="prefetch" href="/assets/js/87.bd802144.js"><link rel="prefetch" href="/assets/js/88.96da43ec.js"><link rel="prefetch" href="/assets/js/89.aa52f4d2.js"><link rel="prefetch" href="/assets/js/9.aa2e6e65.js"><link rel="prefetch" href="/assets/js/90.b74e5f4f.js"><link rel="prefetch" href="/assets/js/91.07d6833c.js"><link rel="prefetch" href="/assets/js/92.8685f6b0.js"><link rel="prefetch" href="/assets/js/93.a4952ad9.js"><link rel="prefetch" href="/assets/js/94.02b8e4a4.js"><link rel="prefetch" href="/assets/js/95.4f092038.js"><link rel="prefetch" href="/assets/js/96.049a03db.js"><link rel="prefetch" href="/assets/js/97.85ab59fa.js"><link rel="prefetch" href="/assets/js/98.a6678c4d.js"><link rel="prefetch" href="/assets/js/99.f8cac5f9.js">
    <link rel="stylesheet" href="/assets/css/0.styles.acaf374f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">左小白的前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/nav.html" class="nav-link">
  前端网址导航
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><span class="title">前端进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端进阶" class="mobile-dropdown-title"><span class="title">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/daily/" class="nav-link router-link-active">
  技术日常记录
</a></li><li class="dropdown-item"><!----> <a href="/server/docker.html" class="nav-link">
  Docker 基础
</a></li><li class="dropdown-item"><h4>
          Vue.js
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/base/1.html" class="nav-link">
  Vue.js 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vue-router.html" class="nav-link">
  Vue Router 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vuex.html" class="nav-link">
  Vuex 笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          前端工程化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ts/base-1.html" class="nav-link">
  TypeScript 入门教程笔记
</a></li><li class="dropdown-subitem"><a href="/node/base/1.html" class="nav-link">
  Node.js 笔记
</a></li><li class="dropdown-subitem"><a href="/webpack/base.html" class="nav-link">
  webpack 基础
</a></li></ul></li><li class="dropdown-item"><h4>
          数据可视化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/visual/echarts.html" class="nav-link">
  Echarts 笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          JS/ES6
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/js-deep.html" class="nav-link">
  JavaScript 小记
</a></li><li class="dropdown-subitem"><a href="/js/es6/es6-1.html" class="nav-link">
  ES6标准入门(第三版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/ad3/js-ad4-diff.html" class="nav-link">
  JavaScript高级程序设计(第四版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/js-dom-art.html" class="nav-link">
  JavaScript DOM编程艺术(第二版)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          CSS/CSS3
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/css/less.html" class="nav-link">
  CSS 预处理器 Less.js
</a></li><li class="dropdown-subitem"><a href="/css/flex-grid.html" class="nav-link">
  Flex与Grid布局
</a></li><li class="dropdown-subitem"><a href="/css/html5-css-1.html" class="nav-link">
  HTML5权威指南(CSS部分)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          HTML/HTML5
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html5/html/1.html" class="nav-link">
  HTML5权威指南(HTML部分)笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/base/git.html" class="nav-link">
  Git 笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/markdown.html" class="nav-link">
  Markdown 基础语法
</a></li><li class="dropdown-item"><!----> <a href="/base/dbtheory/1.html" class="nav-link">
  数据库系统原理笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源项目" class="dropdown-title"><span class="title">开源项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="开源项目" class="mobile-dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://vuechart.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @guoqzuo/vue-chart
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://zuoblog.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zuo-blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="http://www.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zuoxiaobai/fenote" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><span class="title">指南</span> <span class="arrow down"></span></button> <button type="button" aria-label="指南" class="mobile-dropdown-title"><span class="title">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/nav.html" class="nav-link">
  前端网址导航
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><span class="title">前端进阶</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端进阶" class="mobile-dropdown-title"><span class="title">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/daily/" class="nav-link router-link-active">
  技术日常记录
</a></li><li class="dropdown-item"><!----> <a href="/server/docker.html" class="nav-link">
  Docker 基础
</a></li><li class="dropdown-item"><h4>
          Vue.js
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vue/base/1.html" class="nav-link">
  Vue.js 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vue-router.html" class="nav-link">
  Vue Router 笔记
</a></li><li class="dropdown-subitem"><a href="/vue/vuex.html" class="nav-link">
  Vuex 笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          前端工程化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/ts/base-1.html" class="nav-link">
  TypeScript 入门教程笔记
</a></li><li class="dropdown-subitem"><a href="/node/base/1.html" class="nav-link">
  Node.js 笔记
</a></li><li class="dropdown-subitem"><a href="/webpack/base.html" class="nav-link">
  webpack 基础
</a></li></ul></li><li class="dropdown-item"><h4>
          数据可视化
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/visual/echarts.html" class="nav-link">
  Echarts 笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          JS/ES6
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/js/js-deep.html" class="nav-link">
  JavaScript 小记
</a></li><li class="dropdown-subitem"><a href="/js/es6/es6-1.html" class="nav-link">
  ES6标准入门(第三版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/ad3/js-ad4-diff.html" class="nav-link">
  JavaScript高级程序设计(第四版)笔记
</a></li><li class="dropdown-subitem"><a href="/js/js-dom-art.html" class="nav-link">
  JavaScript DOM编程艺术(第二版)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          CSS/CSS3
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/css/less.html" class="nav-link">
  CSS 预处理器 Less.js
</a></li><li class="dropdown-subitem"><a href="/css/flex-grid.html" class="nav-link">
  Flex与Grid布局
</a></li><li class="dropdown-subitem"><a href="/css/html5-css-1.html" class="nav-link">
  HTML5权威指南(CSS部分)笔记
</a></li></ul></li><li class="dropdown-item"><h4>
          HTML/HTML5
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/html5/html/1.html" class="nav-link">
  HTML5权威指南(HTML部分)笔记
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/base/git.html" class="nav-link">
  Git 笔记
</a></li><li class="dropdown-item"><!----> <a href="/base/markdown.html" class="nav-link">
  Markdown 基础语法
</a></li><li class="dropdown-item"><!----> <a href="/base/dbtheory/1.html" class="nav-link">
  数据库系统原理笔记
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开源项目" class="dropdown-title"><span class="title">开源项目</span> <span class="arrow down"></span></button> <button type="button" aria-label="开源项目" class="mobile-dropdown-title"><span class="title">开源项目</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="http://vuechart.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  @guoqzuo/vue-chart
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-item"><!----> <a href="http://zuoblog.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  zuo-blog
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div><div class="nav-item"><a href="http://www.zuo11.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zuoxiaobai/fenote" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/daily/" aria-current="page" class="sidebar-link">技术日常记录</a></li><li><a href="/daily/2020-10.html" class="sidebar-link">2020年10月技术日常</a></li><li><a href="/daily/2020-09.html" aria-current="page" class="active sidebar-link">2020年09月技术日常</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#_2020-09-30-周三" class="sidebar-link">2020/09/30 周三</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#amd、umd、commonjs、es-modules的理解" class="sidebar-link">AMD、UMD、CommonJS、ES Modules的理解</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#script-error产生原因与解决方法、调试技巧" class="sidebar-link">Script error产生原因与解决方法、调试技巧</a></li></ul></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#_2020-09-26-周六" class="sidebar-link">2020/09/26 周六</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#为什么会有回流-重排-reflow-和重绘-repaint-怎么避免" class="sidebar-link">为什么会有回流/重排(Reflow)和重绘(Repaint)？怎么避免？</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#图片占位、懒加载、预览" class="sidebar-link">图片占位、懒加载、预览</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#chrome-devtools-network-waterfall各阶段详解" class="sidebar-link">Chrome DevTools Network Waterfall各阶段详解</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#append和apendchild的区别" class="sidebar-link">append和apendChild的区别</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#google-analytics、google-adsense、google-search-console分别是干什么的" class="sidebar-link">Google Analytics、Google AdSense、Google Search Console分别是干什么的?</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#google-adsense被拒理由网站已下线或无法访问怎么解决" class="sidebar-link">Google AdSense被拒理由网站已下线或无法访问怎么解决</a></li></ul></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#_2020-09-25-周五" class="sidebar-link">2020/09/25 周五</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#final-cut-pro-使用网易见外工作台自动生成字幕-免费" class="sidebar-link">Final Cut Pro 使用网易见外工作台自动生成字幕（免费）</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#final-cut-pro-将视频拖到时间线后不是全屏的问题" class="sidebar-link">Final Cut Pro 将视频拖到时间线后不是全屏的问题</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#final-cut-pro-导出7分钟视频就要40多g-视频太大怎么处理" class="sidebar-link">Final Cut Pro 导出7分钟视频就要40多G，视频太大怎么处理</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#final-cut-pro-怎么加音效-自带的声音效果变没了怎么处理" class="sidebar-link">Final Cut Pro 怎么加音效，自带的声音效果变没了怎么处理</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#使用git-ssh方式解决rpc-failed-http-413-curl-22-the-requested-url-returned-error-413" class="sidebar-link">使用git ssh方式解决RPC failed; HTTP 413 curl 22 The requested URL returned error: 413</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#ssh生成rsa-key时enter-passphrase加和不加有什么区别" class="sidebar-link">ssh生成rsa key时Enter passphrase加和不加有什么区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#_2020-09-24-周四" class="sidebar-link">2020/09/24 周四</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#xx-github-io打不开的问题" class="sidebar-link">xx.github.io打不开的问题</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#js生成二维码怎么实现" class="sidebar-link">js生成二维码怎么实现</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#什么是e2e-test-除了单元测试外还有什么测试" class="sidebar-link">什么是e2e test，除了单元测试外还有什么测试？</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#vue单元测试" class="sidebar-link">vue单元测试</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#涉及到状态code相关判断逻辑-建议使用常量" class="sidebar-link">涉及到状态code相关判断逻辑，建议使用常量</a></li></ul></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#_2020-09-21-周一" class="sidebar-link">2020/09/21 周一</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#mac下怎么截取屏幕gif图-gifox" class="sidebar-link">mac下怎么截取屏幕gif图：Gifox</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#不全局安装npm包-怎么在项目中执行对应的命令" class="sidebar-link">不全局安装npm包，怎么在项目中执行对应的命令</a></li></ul></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#_2020-09-13-周日" class="sidebar-link">2020/09/13 周日</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#keep-alive只在跳转到b组件页面时缓存当前路由数据-跳到其他页面不缓存路由数据" class="sidebar-link">keep-alive只在跳转到B组件页面时缓存当前路由数据，跳到其他页面不缓存路由数据</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#子组件名称与父组件name相同时死循环的问题" class="sidebar-link">子组件名称与父组件name相同时死循环的问题</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#eslintignore在不同vscode版本中的差异" class="sidebar-link">.eslintignore在不同vscode版本中的差异</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#父组件加载子组件时-父子组件钩子顺序" class="sidebar-link">父组件加载子组件时，父子组件钩子顺序</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#vue组件的封装性与可操作性-ref拿不到子组件实例以及vuex增加代码复杂度问题" class="sidebar-link">vue组件的封装性与可操作性：ref拿不到子组件实例以及vuex增加代码复杂度问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#_2020-09-12-周六" class="sidebar-link">2020/09/12 周六</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#npm-install-g或者npm-link需要sudo的问题" class="sidebar-link">npm install -g或者npm link需要sudo的问题</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#git-status中文乱码怎么解决" class="sidebar-link">git status中文乱码怎么解决</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#mac安装brew下载慢-安装异常-切换成ruby-china源" class="sidebar-link">mac安装brew下载慢，安装异常，切换成ruby-china源</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#mac安装svn-svn-error-the-subversion-command-line-tools-are-no-longer-provided-by-xcode" class="sidebar-link">mac安装svn，svn: error: The subversion command line tools are no longer provided by Xcode.</a></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#mac安装nginx在官网下载与使用brew下载的区别" class="sidebar-link">mac安装nginx在官网下载与使用brew下载的区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#_2020-09-02-周三" class="sidebar-link">2020/09/02 周三</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#guoqzuo-vue-chart实用echarts组件封装" class="sidebar-link">@guoqzuo/vue-chart实用echarts组件封装</a></li></ul></li><li class="sidebar-sub-header"><a href="/daily/2020-09.html#_2020-09-01-周二" class="sidebar-link">2020/09/01 周二</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/daily/2020-09.html#normalize-css浏览器样式差异抹平" class="sidebar-link">normalize.css浏览器样式差异抹平</a></li></ul></li></ul></li><li><a href="/daily/2020-08.html" class="sidebar-link">2020年08月技术日常</a></li><li><a href="/daily/2020-07.html" class="sidebar-link">2020年07月技术日常</a></li><li><a href="/daily/2020-06.html" class="sidebar-link">2020年06月技术日常</a></li><li><a href="/daily/2020-05.html" class="sidebar-link">2020年05月技术日常</a></li><li><a href="/daily/2020-04.html" class="sidebar-link">2020年04月技术日常</a></li><li><a href="/daily/2020-03.html" class="sidebar-link">2020年03月技术日常</a></li><li><a href="/daily/2020-02.html" class="sidebar-link">2020年02月技术日常</a></li><li><a href="/daily/2020-01.html" class="sidebar-link">2020年01月技术日常</a></li><li><a href="/daily/2019-12.html" class="sidebar-link">2019年12月技术日常</a></li><li><a href="/daily/2019-11.html" class="sidebar-link">2019年11月技术日常</a></li><li><a href="/daily/2019-10.html" class="sidebar-link">2019年10月技术日常</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_2020年09月技术日常"><a href="#_2020年09月技术日常" class="header-anchor">#</a> 2020年09月技术日常</h1> <h2 id="_2020-09-30-周三"><a href="#_2020-09-30-周三" class="header-anchor">#</a> 2020/09/30 周三</h2> <h3 id="amd、umd、commonjs、es-modules的理解"><a href="#amd、umd、commonjs、es-modules的理解" class="header-anchor">#</a> AMD、UMD、CommonJS、ES Modules的理解</h3> <p>在ES6之前，JS本身没有模块功能，社区出现了 CommonJS 和 AMD 等模块方案，ES6后, JS开始原生支持模块，一般称之为 ES Modules</p> <ul><li>CommonJS: 主要用于服务端，是 node 中使用的 require、module.exports。从 Node.js v13.2 版本开始，Node.js 已经默认打开了 ES6 模块支持。但需要采用 .mjs 后缀文件名。如果不希望将后缀名改成.mjs，可以在项目的package.json文件中，指定type字段为module。</li> <li>AMD: Asynchronous Module Definition，异步模块定义，主要用于客户端(浏览器)，以 RequireJS 为代表 define、require</li> <li>UMD: Universal Module Definition，通用模块定义模式，主要用来解决 CommonJS 模式和 AMD 模式代码不能通用的问题，并同时还支持老式的全局变量规范。</li> <li>ES Modules 是 ES 标准模块系统，import、export ，可以和 CommonJS混合使用</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/*
 * bundle.js  UMD webpack打包后的js
 * 判断define为函数，并且是否存在define.amd，来判断是否为AMD规范,
 * 判断module是否为一个对象，并且是否存在module.exports来判断是否为CommonJS规范
 * 如果以上两种都没有，设定为原始的代码规范。
 */</span>
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">global<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> module <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">?</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd <span class="token operator">?</span> <span class="token function">define</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token punctuation">(</span>global <span class="token operator">=</span> global <span class="token operator">||</span> self<span class="token punctuation">,</span> global<span class="token punctuation">.</span>myBundle <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token string">'use strict'</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> <span class="token function-variable function">main</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">'hello world'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> main<span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// index.html</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;bundle.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">myBundle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p>区别:</p> <ol><li>CommonJS 模块输出的是一个值的拷贝，ES6 模块输出的是值的引用。CommonJS一旦输出一个值，模块内部的变化就影响不到这个值。ES6 模块的运行机制与 CommonJS 不一样。JS 引擎对脚本静态分析的时候，遇到模块加载命令import，就会生成一个只读引用。等到脚本真正执行时，再根据这个只读引用，到被加载的那个模块里面去取值。</li> <li>CommonJS 模块是运行时加载，ES6 模块是编译时输出接口。因为 CommonJS 加载的是一个对象（即module.exports属性），该对象只有在脚本运行完才会生成。而 ES6 模块不是对象，它的对外接口只是一种静态定义，在代码静态解析阶段就会生成。</li> <li>CommonJS 模块的require()是同步加载模块，ES6 模块的import命令是异步加载，有一个独立的模块依赖的解析阶段。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// CommonJS模块</span>
<span class="token keyword">let</span> <span class="token punctuation">{</span> stat<span class="token punctuation">,</span> exists<span class="token punctuation">,</span> readfile <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 等同于</span>
<span class="token keyword">let</span> _fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'fs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> stat <span class="token operator">=</span> _fs<span class="token punctuation">.</span>stat<span class="token punctuation">;</span>
<span class="token keyword">let</span> exists <span class="token operator">=</span> _fs<span class="token punctuation">.</span>exists<span class="token punctuation">;</span>
<span class="token keyword">let</span> readfile <span class="token operator">=</span> _fs<span class="token punctuation">.</span>readfile<span class="token punctuation">;</span>

<span class="token comment">// ES6模块</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> stat<span class="token punctuation">,</span> exists<span class="token punctuation">,</span> readFile <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'fs'</span><span class="token punctuation">;</span>
</code></pre></div><p>参考</p> <ul><li><a href="https://zhuanlan.zhihu.com/p/108217164" target="_blank" rel="noopener noreferrer">《模块化系列》彻底理清 AMD,CommonJS,CMD,UMD,ES6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener noreferrer">Module 的语法 | ES6入门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://es6.ruanyifeng.com/#docs/module-loader" target="_blank" rel="noopener noreferrer">Module 的加载实现 | ES6入门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="script-error产生原因与解决方法、调试技巧"><a href="#script-error产生原因与解决方法、调试技巧" class="header-anchor">#</a> Script error产生原因与解决方法、调试技巧</h3> <p>一般为了安全起见，如果当前页面引入了跨域的 js 文件，当这个 js 文件出现错误，监听错误会无法获取对应的行号、message。仅会将 message 设置为 Script error.</p> <p>本地来做一个试验，重现该问题，用 koa 写两个服务，分别监听 5001/5002端口，同时开启服务</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * index_a.js
 * index_b.js 代码和下面的基本一致，只是将 5001 改为 5002
 */</span>
<span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-static'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'5001'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'server listen on 5001 port'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>public/index.html 测试页面中，我们引入 5001端口的 a.js 或 5002 端口的 a.js，看具体 error 信息</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onclick</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btnClick()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://127.0.0.1:5001/a.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- &lt;script src=&quot;http://127.0.0.1:5002/a.js&quot;&gt;&lt;/script&gt; --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token parameter">e</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> e<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
&lt;!-- 
// a.js代码
function btnClick() {
  console.logaaa('aaa') // 故意制造一个错误
}
-- &gt;
</code></pre></div><p>访问 <code>http://127.0.0.1:5001/index.html</code>，然后测试不同端口下执行情况，具体如下图</p> <p><img src="/images/daily/cross_origin_script_error.png" alt="cross_origin_script_error.png"></p> <p>知道问题后，我们可以通过使用同域的方式引入 js。如果一定要使用跨域的，需要设置下面两点</p> <ol><li>script引入时加入 crossorigin=&quot;anonymous&quot;，anonymous 即不发送 Cookie 和 HTTP 认证信息</li> <li>服务器对应的js，增加允许跨域</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// html里</span>
<span class="token comment">// &lt;script src=&quot;http://127.0.0.1:5002/a.js&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;</span>
<span class="token comment">// index_b.js 5002端口增加允许跨域</span>

<span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 允许跨域</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span>
    <span class="token string">'Access-Control-Allow-Headers'</span><span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span>
    <span class="token string">'Access-Control-Allow-Methods'</span><span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span>
    <span class="token string">'Access-Control-Allow-Credentials'</span><span class="token operator">:</span> <span class="token string">'true'</span><span class="token punctuation">,</span> <span class="token comment">// 允许携带cookie</span>
    <span class="token string">'Access-Control-Max-Age'</span><span class="token operator">:</span> <span class="token number">3600</span> <span class="token comment">// 对于相同的请求，仅在第一次发送options预检请求，之后1小时内不需要预检请求</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'koa-static'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string">'5002'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'server listen on 5002 port'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>设置好后，我们再测试就会发现可以正常显示跨域的信息了。如下图，完整demo参见 <a href="https://github.com/zuoxiaobai/fedemo/tree/master/src/DebugDemo/%E8%B7%A8%E5%9F%9FScript_error%E6%B5%8B%E8%AF%95" target="_blank" rel="noopener noreferrer">跨域Script_error测试demo | github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/images/daily/cross_origin_script_error_fix.png" alt="cross_origin_script_error_fix.png"></p> <p>参考：<a href="https://blog.fundebug.com/2017/04/05/understand-script-error/" target="_blank" rel="noopener noreferrer">Script error.全面解析 | Fundebug<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_2020-09-26-周六"><a href="#_2020-09-26-周六" class="header-anchor">#</a> 2020/09/26 周六</h2> <h3 id="为什么会有回流-重排-reflow-和重绘-repaint-怎么避免"><a href="#为什么会有回流-重排-reflow-和重绘-repaint-怎么避免" class="header-anchor">#</a> 为什么会有回流/重排(Reflow)和重绘(Repaint)？怎么避免？</h3> <p><strong>1. 什么是回流或重绘</strong></p> <ul><li>浏览器使用流式布局模型 (Flow Based Layout)</li> <li>浏览器把 HTML 解析成 DOM，把 CSS 解析为 CSDOM，DOM 和 CSDOM 合并就产生了 Render Tree(渲染树)</li> <li>根据Render Tree，计算各个元素在页面中的大小和位置，绘制到页面上。</li></ul> <p><strong>回流/重排（Reflow）</strong>：当 Render Tree 中部分或全部元素的尺寸、结构或位置发生改变时，浏览器会重新渲染部分或整个文档的过程就称为Reflow</p> <p><strong>重绘（RePaint）</strong>: 当页面中元素样式的改变并不影响它在文档中的位置时，浏览器会重绘该区域，这个过程称为重绘</p> <p><strong>2. 回流和重绘的比较</strong></p> <p>DOM、CSS style的改变会照成回流或者重绘，回流比重绘更消耗性能</p> <ul><li>回流：重新布局，会引起元素位置变化的就会reflow，比如修改 DOM 的宽高、字体大小、窗口大小改变、元素位置改变等</li> <li>重绘：重新绘制区域，不改变元素位置，比如修改背景、颜色，visibility等</li></ul> <p><strong>3. 如何避免回流或重绘</strong></p> <p>CSS：</p> <ul><li>尽可能在DOM树的最末端改变class</li> <li>避免设置多层内联样式，将动画效果应用到 position 属性为 absolute 或 fixed 的元素上</li> <li>避免使用CSS表达式（例如：calc())</li></ul> <p>JavaScript</p> <ul><li>避免频繁操作样式、DOM</li> <li>在 documentFragment 或 display 为 none 的元素上进行 dom 操作不会引起回流或重绘</li> <li>对复杂动画，使用绝对定位脱离文档流，避免整体回流</li></ul> <p>参考：</p> <ul><li><a href="https://juejin.im/post/6844903569087266823" target="_blank" rel="noopener noreferrer">浏览器的回流与重绘 (Reflow &amp; Repaint) | 掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.zhoulujun.cn/html/webfront/browser/webkit/2016_0506_7820.html" target="_blank" rel="noopener noreferrer">使用chrome对页面重绘和回流做优化<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="图片占位、懒加载、预览"><a href="#图片占位、懒加载、预览" class="header-anchor">#</a> 图片占位、懒加载、预览</h3> <p><strong>使用占位图片有什么好处?</strong></p> <ol><li>用户体验更好，标识此处有图片，但正在加载中的这一个状态，避免弱网或图片较大时，完全不显示的问题</li> <li>不阻塞其他资源加载，更快的整体文档加载速度，不阻塞其他请求。占位图片一般会和图片懒加载一起使用，当滚动到该区域时再加载图片，减少不必要的并发网络请求</li> <li>可以避免回流，让图片加载完成后不改变页面的整体布局，避免回流(重新布局)，只需要重绘，注意: 需要占位图片与实际图片宽高不变</li></ol> <p><strong>怎么实现图片懒加载</strong></p> <p>这里核心问题是怎么判断图片是否已滚动到当前视口。一般可以通过监听页面滚动事件，实时比较元素的 offsetTop 与页面的 scrollTop。另外还可以通过元素的 getBoundingClientRect() 获取当前元素距离视窗的距离，如果小于 window.innerHeight 就加载，下面来看一个简单的实现</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">height</span><span class="token punctuation">:</span>50px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>我是占位文本<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lazy-img<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://zuo11.com/images/blog/c/c_vim.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">height</span><span class="token punctuation">:</span>500px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>我是占位文本<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lazy-img<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://zuo11.com/images/blog/c/c_saolei_3.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> imgEls <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'.lazy-img'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> imgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    imgEls<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">imgEl</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      imgEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token string">'300px'</span>
      imgEl<span class="token punctuation">.</span>style<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token string">'300px'</span>
      imgEl<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;placeholder.png&quot;</span>
      <span class="token comment">// 存储信息用于监听滚动后比对</span>
      imgs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        offsetTop<span class="token operator">:</span> imgEl<span class="token punctuation">.</span>offsetTop<span class="token punctuation">,</span>
        el<span class="token operator">:</span> imgEl<span class="token punctuation">,</span>
        src<span class="token operator">:</span> imgEl<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>src<span class="token punctuation">,</span>
        isLoad<span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>imgs<span class="token punctuation">)</span>
    <span class="token comment">// 判断滚动位置，显示图片</span>
    <span class="token keyword">function</span> <span class="token function">showImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'&gt;&gt;&gt;&gt;&gt;&gt;'</span><span class="token punctuation">)</span>
      imgs<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 如果图片未加载</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>item<span class="token punctuation">.</span>isLoad<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">,</span> item<span class="token punctuation">.</span>src<span class="token punctuation">,</span> item<span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token keyword">let</span> elPos <span class="token operator">=</span> item<span class="token punctuation">.</span>el<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>elPos<span class="token punctuation">.</span>top <span class="token operator">&lt;</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 如果元素相对顶部的距离 &lt; 视窗高度，加载图片</span>
            item<span class="token punctuation">.</span>el<span class="token punctuation">.</span>src <span class="token operator">=</span> item<span class="token punctuation">.</span>src
            item<span class="token punctuation">.</span>isLoad <span class="token operator">=</span> <span class="token boolean">true</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">showImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onscroll</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">showImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>图片预览</strong></p> <p>可以参考Element UI el-image组件实现，<a href="https://element.eleme.cn/#/zh-CN/component/image#da-tu-yu-lan" target="_blank" rel="noopener noreferrer">Element UI 大图预览 | el-image<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>参考资料与扩展</p> <ul><li><a href="https://segmentfault.com/q/1010000007357371?_ea=1320000" target="_blank" rel="noopener noreferrer">前端为什么要使用占位图 | segmentfault<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.jianshu.com/p/4876a4fe7731" target="_blank" rel="noopener noreferrer">图片懒加载和预加载 | 简书<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.im/post/6844903725249609741" target="_blank" rel="noopener noreferrer">如何判断元素是否进入可视区域viewport？| 掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="chrome-devtools-network-waterfall各阶段详解"><a href="#chrome-devtools-network-waterfall各阶段详解" class="header-anchor">#</a> Chrome DevTools Network Waterfall各阶段详解</h3> <p>在Chrom调试工具Network tab下，每个请求都有一个Waterfal diagrams(瀑布图)，点击具体接口，Timming(时序)位置会有具体描述。它记录了网络请求各个阶段的耗时，可以用于分析页面加载性能。</p> <p><img src="/images/daily/waterfall-hover.png" alt="waterfall-hover.png"></p> <p>Timing breakdown phases explained（时序分解阶段明细）</p> <p>Here's more information about each of the phases you may see in the Timing tab:（下面是在Timing标签页中能看到的各个阶段的更多信息）</p> <p><strong>1. Resource Scheduling(资源调度)</strong></p> <ul><li><strong>Queueing(排队)</strong>. The browser queues requests when:（浏览器在以下情况会排队请求）
<ul><li>There are higher priority requests.（有更高优先级的请求）</li> <li>There are already six TCP connections open for this origin, which is the limit. Applies to HTTP/1.0 and HTTP/1.1 only. (当前请求的 origin/domain，已经有 6 个 TCP 连接打开，这是限制。仅应用于 HTTP/1.0 and HTTP/1.1)</li> <li>The browser is briefly allocating space in the disk cache（浏览器正在磁盘缓存中短暂分配空间）</li></ul></li></ul> <p><strong>2. Connecttion Start(连接开始)</strong></p> <ul><li><strong>Stalled(停滞/暂缓)</strong>. The request could be stalled for any of the reasons described in Queueing. （处于排队中描述的任何原因，请求都有可能停滞/暂缓）</li> <li><strong>DNS Lookup(DNS查询)</strong>. The browser is resolving the request's IP address. （域名解析成IP。在浏览器和服务器进行通信之前, 必须经过DNS查询, 将域名转换成IP地址. 在这个阶段, 你可以处理的东西很少. 但幸运的是, 并非所有的请求都需要经过这一阶段.）</li> <li><strong>Initial connection(初始化连接)</strong>. The browser is establishing a connection, including TCP handshakes/retries and negotiating an SSL.（浏览器正在创建一个连接，包括握手/重试）和 协商SSL。在浏览器发送请求之前, 必须建立TCP连接. 这个过程仅仅发生在瀑布图中的开头几行, 否则这就是性能问题.</li> <li><strong>SSL(SSL协商)</strong> SSL/TLS Negotiation  如果你的页面是通过SSL/TLS这类安全协议加载资源, 这段时间就是浏览器建立安全连接的过程.</li> <li><strong>Proxy negotiation(代理协商)</strong>. The browser is negotiating the request with a proxy server. （浏览器正在与代理服务器协商请求）</li></ul> <p><strong>3. Request/Response(请求/响应)</strong></p> <ul><li><p><strong>Request sent(请求发送)</strong>. The request is being sent. 请求开始发送</p></li> <li><p><strong>ServiceWorker Preparation(ServiceWorker准备)</strong>. The browser is starting up the service worker. （浏览器正在启动 Service Worker）</p></li> <li><p><strong>Request to ServiceWorker(请求到ServiceWorker)</strong>. The request is being sent to the service worker.（请求被发送到 service worker）</p></li> <li><p><strong>Waiting (TTFB) 等待</strong>. The browser is waiting for the first byte of a response. TTFB stands for <strong>Time To First Byte</strong>. This timing includes 1 round trip of latency and the time the server took to prepare the response.（浏览器正在等待响应的第一个字节。 TTFB代表到第一个字节的时间。 此时间包括一次往返延迟和服务器准备响应所花费的时间） TTFB 是浏览器请求发送到服务器的时间+服务器处理请求时间+响应报文的第一字节到达浏览器的时间. 我们用这个指标来判断你的web服务器是否性能不够, 或者说你是否需要使用CDN.</p></li> <li><p><strong>Content Download</strong>. The browser is receiving the response. （浏览器正在接收响应），这是浏览器用来下载资源所用的时间. 这段时间越长, 说明资源越大. 理想情况下, 你可以通过控制资源的大小来控制这段时间的长度.</p></li> <li><p><strong>Receiving Push</strong>. The browser is receiving data for this response via HTTP/2 Server Push.（浏览器正在通过HTTP / 2服务器推送接收此响应的数据）</p></li> <li><p><strong>Reading Push</strong>. The browser is reading the local data previously received.（浏览器正在读取先前接收的本地数据。）</p></li></ul> <p>参考资料及扩展：</p> <ul><li><a href="https://developers.google.com/web/tools/chrome-devtools/network/reference?utm_source=devtools#timing-explanation" target="_blank" rel="noopener noreferrer">Timing breakdown phases explained - Network Analysis Reference  |  Chrome DevTools<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.html.cn/doc/chrome-devtools/" target="_blank" rel="noopener noreferrer">Chrome 开发者工具中文文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/csdn_girl/article/details/54911632" target="_blank" rel="noopener noreferrer">教你读懂网络请求的瀑布图<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://moz.com/blog/the-seo-professional-s-guide-to-waterfall-diagrams" target="_blank" rel="noopener noreferrer">The SEO Professional's Guide to Waterfall Diagrams<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/xitu/gold-miner/blob/master/TODO/understanding-service-workers.md" target="_blank" rel="noopener noreferrer">理解 Service Workers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="append和apendchild的区别"><a href="#append和apendchild的区别" class="header-anchor">#</a> append和apendChild的区别</h3> <p>在JS高程3中，并没有讲到 append，基本都是用的 appendChild，所以有知识盲点，这里对比下 append 和 apendChiild的区别</p> <table><thead><tr><th>方法</th> <th>所属对象</th> <th>功能</th> <th>返回值</th> <th>兼容性</th></tr></thead> <tbody><tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/Node/appendChild" target="_blank" rel="noopener noreferrer">appendChild<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Node" target="_blank" rel="noopener noreferrer">Node<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>在元素内容里追加一个 Node 节点</td> <td>append的节点</td> <td>基本都兼容</td></tr> <tr><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/ParentNode/append" target="_blank" rel="noopener noreferrer">append<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td><a href="https://developer.mozilla.org/en-US/docs/Web/API/ParentNode" target="_blank" rel="noopener noreferrer">ParentNode<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td> <td>在元素内容里追加一个或多个 Node 节点或 String</td> <td>undefined</td> <td>实验性功能 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/ParentNode#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E6%80%A7" target="_blank" rel="noopener noreferrer">不支持 IE<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></td></tr></tbody></table> <p>注意，如果 append 或 appendChild 的元素是已经存在的，会移动该元素，如果需要保持原来的不移动，需要先 cloneNode, 下面来看一个例子</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>c1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>existDiv<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>我是一段已经存在的dom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>c2<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>c3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// 1.测试基本功能：创建节点，并 appendChild 到 c1元素</span>
    <span class="token keyword">let</span> p <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> text <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">'我是一段信息'</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> p<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span> <span class="token comment">// HTMLParagraphElement</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#c1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    <span class="token comment">// document.querySelector('#c1').appendChild('1212') // Error, Node</span>

    <span class="token comment">// 2.测试 appendChild 一个已存在的节点，移动节点，而不是copy</span>
    <span class="token keyword">let</span> existDiv <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#existDiv'</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>existDiv<span class="token punctuation">,</span> existDiv<span class="token punctuation">.</span>__proto__<span class="token punctuation">)</span>  <span class="token comment">// HTMLDivElement</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'测试appendChild 返回'</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#c2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>existDiv<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// console.log('测试append 返回', document.querySelector('#c2').append(existDiv))</span>

    <span class="token comment">// 4.测试append</span>
    <span class="token keyword">let</span> span <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">)</span>
    <span class="token comment">// 不要写成链式调用，它返回的是成功appendChild的节点</span>
    span<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">createTextNode</span><span class="token punctuation">(</span><span class="token string">'测试append'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#c3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">'&lt;span&gt;abc&lt;/span&gt;'</span><span class="token punctuation">)</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#c3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>span<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'&lt;div&gt;c&lt;/div&gt;'</span><span class="token punctuation">)</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>执行效果如下图</p> <p><img src="/images/daily/append_vs_appendChild.png" alt="append_vs_appendChild.png"></p> <p>关于Node节点Element元素对象的一些值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;myDiv&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;bg test&quot;</span> title<span class="token operator">=</span><span class="token string">&quot;body text&quot;</span> lang<span class="token operator">=</span><span class="token string">&quot;en&quot;</span> dir<span class="token operator">=</span><span class="token string">&quot;rtl&quot;</span><span class="token operator">&gt;</span>abcdefg<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token comment">// 3.测试节点类型、对象信息 HTMLDivElement =&gt; HTMLElement =&gt; Element =&gt; Node</span>
<span class="token comment">// 参考：DOM https://www.yuque.com/guoqzuo/js_es6/hoglme#6bbee863</span>
<span class="token keyword">var</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;myDiv&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// HTMLDivElement</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>nodeType<span class="token punctuation">)</span> <span class="token comment">// 1 Node.ELEMENT_NODE</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>nodeName<span class="token punctuation">)</span> <span class="token comment">// DIV</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// myDiv</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>className<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// bg test</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// body text</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>lang<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// en</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>div<span class="token punctuation">.</span>dir<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// rtl   </span>
</code></pre></div><h3 id="google-analytics、google-adsense、google-search-console分别是干什么的"><a href="#google-analytics、google-adsense、google-search-console分别是干什么的" class="header-anchor">#</a> Google Analytics、Google AdSense、Google Search Console分别是干什么的?</h3> <p>在站点管理这一块，Google的工具有好几个，我现在知道的有三个，他们分别对应不同的功能，下面来看看他们的介绍、区别</p> <table><thead><tr><th>平台</th> <th>功能</th></tr></thead> <tbody><tr><td><a href="https://search.google.com/search-console" target="_blank" rel="noopener noreferrer">Google Search Console<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>  搜索控制台</td> <td>站长工具、sitemap提交，展现量/点击量简单查看，死链提交等</td></tr> <tr><td><a href="https://analytics.google.com/analytics/" target="_blank" rel="noopener noreferrer">Google Analytics<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 分析</td> <td>偏数据分析，统计实时用户/累计用户/会话时长/跳出率等，受众群体、流量来源、转化率、页面价值等</td></tr> <tr><td><a href="https://www.google.com/adsense" target="_blank" rel="noopener noreferrer">Google AdSense<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 广告联盟</td> <td>用于在自己站点投放 Google 广告，赚取收益</td></tr></tbody></table> <p><img src="/images/daily/google_ad_3.png" alt="google站长工具对比"></p> <p>百度统计类似 Google Search Console 和 Google Analytics 的结合体，但 Google Analytics 的细分功能更加强大</p> <p>关于 Google AdSense，有一本书可以参考下：《Google AdSense 实战宝典》</p> <h3 id="google-adsense被拒理由网站已下线或无法访问怎么解决"><a href="#google-adsense被拒理由网站已下线或无法访问怎么解决" class="header-anchor">#</a> Google AdSense被拒理由网站已下线或无法访问怎么解决</h3> <p>在自己网站的 head 部分加入 AdSense 的校验代码后，会有一段审核的时间。在这个过程中，网站可能会有来自福建龙岩的 203.208.60.* IP段蜘蛛来爬取你的网页。蜘蛛会爬取JS渲染后的效果，可以触发百度统计等js代码。不用屏蔽，这属于 Google 蜘蛛正常爬取，Google Analytics 在计算访客时会忽略这一部分访客信息。</p> <p>蜘蛛爬完的第二天，就收到了邮件，说审核不通过，看了下原因：&quot;网站已下线或无法访问怎么解决&quot; ，如下图所示。但我的网站是确定可以正常访问的。</p> <p><img src="/images/daily/google_ad_1.png" alt="网站已下线或无法访问怎么解决"></p> <p>网上查了下，这种情况，需要在域名解析里增加两条解析记录，解析路线设置为境外。然后重新提交审核，等待即可。<strong>但我加了解析后，等了一段时间，又是同样的理由被拒绝，于是找到了官方的回复。首页不能重定向，比如 xx.com 不能重定向到 xx.com/home，或者 <code>www.xx.com</code></strong>，再次修改后，重新提交审核，大概5、6天后审核通过。参考 <a href="https://support.google.com/adsense/thread/43647550?hl=zh-Hans" target="_blank" rel="noopener noreferrer">为什么一直提示找不到adsense代码和网站已下线或无法访问？ - AdSense Community<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <table><thead><tr><th>主机记录</th> <th>记录类型</th> <th>解析路线</th> <th>记录值</th> <th>TTL</th></tr></thead> <tbody><tr><td>@</td> <td>A</td> <td>境外</td> <td>服务器IP地址</td> <td>10分钟(默认)</td></tr> <tr><td>www</td> <td>A</td> <td>境外</td> <td>服务器IP地址</td> <td>10分钟(默认)</td></tr></tbody></table> <p><img src="/images/daily/google_ad_2.png" alt="域名解析.png"></p> <p>www 和 @ 这样的主机记录是什么意思?</p> <ul><li>www：解析后的域名为 <code>www.xx.com</code>。</li> <li>@：直接解析主域名 xx.com。</li> <li>*：泛解析，匹配其他所有域名 *.xx.com。</li></ul> <p>关闭 zuo11.com 到 <code>www.zuo11.com</code> 的重定向，大概是09月27，再次提交后，10月02号收到审核通过邮件。如下图</p> <p><img src="/images/daily/google_ad.jpg" alt="google_ad.jpg"></p> <h2 id="_2020-09-25-周五"><a href="#_2020-09-25-周五" class="header-anchor">#</a> 2020/09/25 周五</h2> <h3 id="final-cut-pro-使用网易见外工作台自动生成字幕-免费"><a href="#final-cut-pro-使用网易见外工作台自动生成字幕-免费" class="header-anchor">#</a> Final Cut Pro 使用网易见外工作台自动生成字幕（免费）</h3> <p><strong>1.将视频的音频单独导出</strong></p> <p>在 Final Cut Pro 里导入视频素材，并拖入到时间线中。点击右上角分享按钮，导出 母版文件，一般默认是导出视频和音频。在设置里设置为仅音频，WAV格式。然后下一步，保存 .wav 格式文件</p> <p><img src="/images/daily/final_cut_export_wav.png" alt="final_cut_export_wav.png"></p> <p><strong>2.在网易见外工作台将音频生成.srt字幕文件</strong></p> <p>进入 <a href="https://jianwai.youdao.com/" target="_blank" rel="noopener noreferrer">网易见外工作台<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，如果没注册先注册。登录成功后，新建项目 =&gt; 选择语音转写 =&gt; 填写信息、上传之前导出的 wav 音频文件，提交后，一般等几分钟就好了(具体等待时间看音频时长)</p> <p><img src="/images/daily/final_cut_wav2caption.png" alt="final_cut_wav2caption.png"></p> <p>生成好后，点击进入详情页，可对生成的字幕进行修改，修改完成后点击导出，会生成 .srt 字幕文件</p> <p><img src="/images/daily/final_cut_edit_caption.png" alt="final_cut_edit_caption.png"></p> <p><strong>3.将字幕文件导入到Final Cut Pro项目中</strong></p> <p>点击 Final Cut Pro 顶部 文件 =&gt; 导入 =&gt; 字幕，选择上一步生成的 .srt 文件即可。<strong>注意：如果出现下图中 &quot;字幕文件包含不支持的数据或可能已损坏&quot; 的问题，那么就还需要使用 Aegisub 将字幕文件转一下格式</strong></p> <p><img src="/images/daily/final_cut_import_fail.png" alt="final_cut_import_fail.png"></p> <p>Aegisub 官网下载很慢，我找的是PC6.com下载的，<a href="http://www.pc6.com/mac/113232.html" target="_blank" rel="noopener noreferrer">Aegisub 下载地址 | PC6.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，下载完成后，打开该软件，点击顶部菜单 文件 =&gt; 打开字幕，打开后再点击 文件 =&gt; 导出，默认文字编码为 UTF-8 =&gt; 导出 =&gt; fileType 文件类型选择 .srt =&gt; 存储</p> <p>这样转换过的 .srt 文件，再重新导入到 Final Cut Pro，这样就大功告成了。</p> <p>如果字幕导入进去了，还是看不到字幕，要确保视频显示比例，是否是合适，可能放大了，字幕在最底部，显示区域正好看不到字幕。</p> <p><strong>4.每次导出时，一定要记得在角色-字幕那里勾选字幕</strong></p> <p><img src="/images/daily/final_cut_add_zimu.png" alt="final_cut_add_zimu.png"></p> <h3 id="final-cut-pro-将视频拖到时间线后不是全屏的问题"><a href="#final-cut-pro-将视频拖到时间线后不是全屏的问题" class="header-anchor">#</a> Final Cut Pro 将视频拖到时间线后不是全屏的问题</h3> <p>注意在资源库里点击导入的视频素材，预览时，显示的是视频本身的分辨率。<strong>而拖到流水线后，点击流水线上的视频，显示的是当前项目创建时预设的分辨率</strong>，如果你视频本身是 2800 * 1600 但最开始新建项目，选择的分辨率不是 2800 * 1600 就会出现非全屏的情况。</p> <p><img src="/images/daily/final_cut_not_fullscreen.png" alt="final_cut_not_fullscreen.png"></p> <h3 id="final-cut-pro-导出7分钟视频就要40多g-视频太大怎么处理"><a href="#final-cut-pro-导出7分钟视频就要40多g-视频太大怎么处理" class="header-anchor">#</a> Final Cut Pro 导出7分钟视频就要40多G，视频太大怎么处理</h3> <p>一般用 QuickTimer 录制屏幕后，生成的文件默认视频编解码器为 Apple ProRes 422，导出的视频预计有40多G，我的视频才7分钟，有点恐怖。</p> <p>一般这种情况，在导出母版文件时，将视频编解码器改为 H.264 即可。预计是4G多，实际导出700多M左右。清晰度给我的感觉是看不出差别。</p> <p><img src="/images/daily/final_cut_too_large.png" alt="final_cut_too_large.png"></p> <h3 id="final-cut-pro-怎么加音效-自带的声音效果变没了怎么处理"><a href="#final-cut-pro-怎么加音效-自带的声音效果变没了怎么处理" class="header-anchor">#</a> Final Cut Pro 怎么加音效，自带的声音效果变没了怎么处理</h3> <p>在 Final Cut Pro 的左上侧区域是浏览器区域，分别有三个模块：资源库、照片和音频、字幕和发生器</p> <ul><li>资源库用于导入和管理资源。</li> <li>照片和音频用于管理音视频，<strong>声音效果里有很多背景音乐，注意：如果这里的声音效果是空的列表，则需要点击左上角的 apple 标志，打开系统偏好设置 =&gt; 软件更新 =&gt; 升级需要升级的包 =&gt; 升级完成后再打开 Final Cut Pro 就能看到音效了</strong></li></ul> <p><img src="/images/daily/final_cut_audio.png" alt="final_cut_audio.png"></p> <ul><li>字幕用于手动添加各种类别的字幕，发生器用于添加剪短的背景、动画视频片段</li></ul> <h3 id="使用git-ssh方式解决rpc-failed-http-413-curl-22-the-requested-url-returned-error-413"><a href="#使用git-ssh方式解决rpc-failed-http-413-curl-22-the-requested-url-returned-error-413" class="header-anchor">#</a> 使用git ssh方式解决RPC failed; HTTP 413 curl 22 The requested URL returned error: 413</h3> <p>由于改了博客生成系统的生成方式，每个html都改了，导致文件相对较多，也不算大，才 4.57 M, 但 git push 一直push不了，提示如下</p> <div class="language-js extra-class"><pre class="language-js"><code>error<span class="token operator">:</span> <span class="token constant">RPC</span> failed<span class="token punctuation">;</span> <span class="token constant">HTTP</span> <span class="token number">413</span> curl <span class="token number">22</span> The requested <span class="token constant">URL</span> returned error<span class="token operator">:</span> <span class="token number">413</span>
fatal<span class="token operator">:</span> the remote end hung up unexpectedly
</code></pre></div><p><img src="/images/daily/git_push_hang_up.png" alt="git_push_hang_up.png"></p> <p>网上查了下，可以改用 ssh 的方式 push 代码，结合之前的经验，大文件 git clone 不下来，可以换 ssh 方式 git clone。这条路应该可行。找了下之前的笔记 <a href="http://www.zuo11.com/blog/2020/8/git_ssh.html" target="_blank" rel="noopener noreferrer">使用ssh方式拉取代码的步骤<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，下面来梳理下整个过程。</p> <p><strong>1.使用git平台(这里是github)邮箱账号生成公钥和私钥</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 先查看 github 对应的邮箱，user.email 就是git邮箱账号</span>
<span class="token function">git</span> config -l
<span class="token comment"># credential.helper=osxkeychain</span>
<span class="token comment"># user.name=guoqzuo</span>
<span class="token comment"># user.email=guoqzuo@gmail.com</span>
<span class="token comment"># core.quotepath=false</span>

<span class="token comment"># 开始生成秘钥</span>
ssh-keygen -t rsa -C <span class="token string">'guoqzuo@gmail.com'</span>
<span class="token comment"># 全部默认、回车，也可以输入密码，我这里输入了密码，后面每次pull, push都需要输入密码。</span>
<span class="token comment"># Generating public/private rsa key pair.</span>
<span class="token comment"># Enter file in which to save the key (/Users/guoqzuo/.ssh/id_rsa): </span>
<span class="token comment"># Enter passphrase (empty for no passphrase): </span>
<span class="token comment"># Enter same passphrase again: </span>
<span class="token comment"># Your identification has been saved in /Users/guoqzuo/.ssh/id_rsa.</span>
<span class="token comment"># Your public key has been saved in /Users/guoqzuo/.ssh/id_rsa.pub.</span>

<span class="token comment"># 查看公钥内容，copy后到github里设置ssh key</span>
<span class="token function">cat</span> ~/.ssh/id_rsa.pub 
</code></pre></div><p><strong>2.copy公钥，并配置到对应的git平台里（这里是github）</strong></p> <p>登录 github，在个人设置里找到 ssh key，添加 ssh key，内容为 <code>cat ~/.ssh/id_rsa.pub</code> 后显示的内容</p> <p><img src="/images/daily/githu_ssh_key.png" alt="githu_ssh_key.png"></p> <p><strong>3.测试是否配置成功</strong></p> <p>使用下面的命令，测试 github ssh key 是否配置成功，如果之前生成 key 时有输入 passphrase，这里就要输入</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">ssh</span> -T git@github.com
<span class="token comment"># Enter passphrase for key '/Users/guoqzuo/.ssh/id_rsa': </span>
<span class="token comment"># Hi zuoxiaobai! You've successfully authenticated, but GitHub does not provide shell access.</span>
</code></pre></div><p><strong>4.将仓库http的origin地址，替换为ssh的origin地址</strong></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 查看 remote 地址</span>
<span class="token function">git</span> remote -v
<span class="token comment"># origin  https://github.com.cnpmjs.org/zuoxiaobai/zuo11.com (fetch)</span>
<span class="token comment"># origin  https://github.com.cnpmjs.org/zuoxiaobai/zuo11.com (push)</span>

<span class="token comment"># 设置 remote 地址为对应仓库的 ssh 地址</span>
<span class="token function">git</span> remote set-url origin git@github.com:zuoxiaobai/zuo11.com.git

<span class="token comment"># 查看设置是否生效</span>
<span class="token function">git</span> remote -v                                                    
<span class="token comment"># origin  git@github.com:zuoxiaobai/zuo11.com.git (fetch)</span>
<span class="token comment"># origin  git@github.com:zuoxiaobai/zuo11.com.git (push)</span>
</code></pre></div><p>配置好后，再进行git pull, git push 就可以 push 成功了，虽然也有点慢，但至少不会报错。可以push成功</p> <div class="language-bash extra-class"><pre class="language-bash"><code>guoqzuo@zuomac zuo11.com % <span class="token function">git</span> pull
Enter passphrase <span class="token keyword">for</span> key <span class="token string">'/Users/guoqzuo/.ssh/id_rsa'</span><span class="token builtin class-name">:</span> 
Already up to date.

guoqzuo@zuomac zuo11.com % <span class="token function">git</span> push
Enter passphrase <span class="token keyword">for</span> key <span class="token string">'/Users/guoqzuo/.ssh/id_rsa'</span><span class="token builtin class-name">:</span> 
Enumerating objects: <span class="token number">685</span>, done.
Counting objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">685</span>/685<span class="token punctuation">)</span>, done.
Delta compression using up to <span class="token number">8</span> threads
Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">358</span>/358<span class="token punctuation">)</span>, done.
Writing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">360</span>/360<span class="token punctuation">)</span>, <span class="token number">4.57</span> MiB <span class="token operator">|</span> <span class="token number">150.00</span> KiB/s, done.
Total <span class="token number">360</span> <span class="token punctuation">(</span>delta <span class="token number">306</span><span class="token punctuation">)</span>, reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>
remote: Resolving deltas: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">306</span>/306<span class="token punctuation">)</span>, completed with <span class="token number">296</span> <span class="token builtin class-name">local</span> objects.
To github.com:zuoxiaobai/zuo11.com.git
   85b3d21<span class="token punctuation">..</span>bf8eab3  master -<span class="token operator">&gt;</span> master
guoqzuo@zuomac zuo11.com % 
</code></pre></div><h3 id="ssh生成rsa-key时enter-passphrase加和不加有什么区别"><a href="#ssh生成rsa-key时enter-passphrase加和不加有什么区别" class="header-anchor">#</a> ssh生成rsa key时Enter passphrase加和不加有什么区别</h3> <p>在使用ssh前，需要先生成公共/私有rsa密钥对。(Generating public/private rsa key pair.)，一般使用 <code>ssh-keygen -t rsa -C '邮箱@xx.com'</code> 命令，这个时候，会有下面的提示</p> <p>Enter passphrase (empty for no passphrase):</p> <p>输入通行码(密码、口令短语)，如果不输入，那么就是不使用密码。<strong>如果输入了密码，这个有什么用呢？</strong></p> <p>个人理解这个主要是安全方面的考虑，如果你私钥泄露了，还有一个保护机制。在你每次使用 ssh 做敏感操作时，就会提示你输入密码</p> <p>比如我们使用 ssh 方式拉取 git 仓库代码，远程 origin 源是 ssh 地址，那么提交代码时，每次 git pull, git push 时都需要输入对应的秘钥。相对会比较麻烦一点。</p> <h2 id="_2020-09-24-周四"><a href="#_2020-09-24-周四" class="header-anchor">#</a> 2020/09/24 周四</h2> <h3 id="xx-github-io打不开的问题"><a href="#xx-github-io打不开的问题" class="header-anchor">#</a> xx.github.io打不开的问题</h3> <p>xx.github.io 偶尔会出现打不开的问题，网上查原因是电信运营商 DNS 污染（域名解析不到正确的 IP 地址）</p> <p>只要本地手动设置 host 即可正常访问，假设我要访问 <code>https://zuoxiaobai.github.io/fedemo/</code> 那手动指定一下这个域名的解析ip即可</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 修改 /etc/hosts</span>
<span class="token function">sudo</span> <span class="token function">vi</span> /etc/hosts
<span class="token comment"># 添加如下host记录</span>
<span class="token number">185.199</span>.108.153 zuoxiaobai.github.io
<span class="token comment"># 查看host文件</span>
<span class="token function">cat</span> /etc/hosts    
<span class="token comment">##</span>
<span class="token comment"># Host Database</span>
<span class="token comment">#</span>
<span class="token comment"># localhost is used to configure the loopback interface</span>
<span class="token comment"># when the system is booting.  Do not change this entry.</span>
<span class="token comment">##</span>
<span class="token number">127.0</span>.0.1	localhost
<span class="token number">185.199</span>.108.153 zuoxiaobai.github.io
<span class="token number">255.255</span>.255.255	broadcasthost
::1             localhost
</code></pre></div><p>保存后，就可以打开 <code>https://zuoxiaobai.github.io/fedemo/</code> 了</p> <p>参考：</p> <ul><li><a href="https://blog.csdn.net/qq_43229056/article/details/108036569" target="_blank" rel="noopener noreferrer">github.io无法访问问题及解决<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/onelikeone/p/12791969.html" target="_blank" rel="noopener noreferrer">github无法访问的解决方法 --- 2020<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="js生成二维码怎么实现"><a href="#js生成二维码怎么实现" class="header-anchor">#</a> js生成二维码怎么实现</h3> <p>QRCode.js是一个生成二维码的js库，使用 HTML5 Canvas将二维码绘制到dom上，不依赖任何库。支持svg绘制方式</p> <blockquote><p>QRCode.js is javascript library for making QRCode. QRCode.js supports Cross-browser with HTML5 Canvas and table tag in DOM. QRCode.js has no dependencies.</p></blockquote> <p>QRCode.js使用很简单，下面来写一个自动生成二维码的工具，在线示例 <a href="https://zuoxiaobai.github.io/fedemo/src/DebugDemo/%E5%89%8D%E7%AB%AF%E7%94%9F%E6%88%90%E4%BA%8C%E7%BB%B4%E7%A0%81/" target="_blank" rel="noopener noreferrer">在线生成二维码工具<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/images/daily/qrcode_js.png" alt="qrcode_js.png"></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">margin-bottom</span><span class="token punctuation">:</span>20px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>btn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>生成二维码<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>qrcode<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 在 https://github.com/davidshimjs/qrcodejs 下载的文件 ---&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./qrcode.min.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">let</span> inputEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> btnEl <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'btn'</span><span class="token punctuation">)</span>
    btnEl<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;qrcode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">''</span>
      <span class="token comment">// new QRCode(document.getElementById(&quot;qrcode&quot;), inputEl.value);</span>
      <span class="token keyword">let</span> qrcode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QRCode</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;qrcode&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        text<span class="token operator">:</span> inputEl<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
        width<span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
        height<span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span>
        colorDark<span class="token operator">:</span> <span class="token string">&quot;#000000&quot;</span><span class="token punctuation">,</span>
        colorLight<span class="token operator">:</span> <span class="token string">&quot;#ffffff&quot;</span><span class="token punctuation">,</span>
        correctLevel<span class="token operator">:</span> QRCode<span class="token punctuation">.</span>CorrectLevel<span class="token punctuation">.</span><span class="token constant">H</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 上面使用清空dom，再重绘，也可以使用内置的方法来重绘</span>
      <span class="token comment">// qrcode.clear(); // clear the code.</span>
      <span class="token comment">// qrcode.makeCode(inputEl.value); // make another code.</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>注意：如果输入的是纯文本，那扫描后打开的就是纯文本，如果是 <code>http://</code> 开头的网址，会直接跳转到对应的 URL</p> <p>完整demo，参见: <a href="https://github.com/zuoxiaobai/fedemo/tree/master/src/DebugDemo/%E5%89%8D%E7%AB%AF%E7%94%9F%E6%88%90%E4%BA%8C%E7%BB%B4%E7%A0%81" target="_blank" rel="noopener noreferrer">前端生成二维码 | github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>参考</p> <ul><li><a href="https://github.com/davidshimjs/qrcodejs" target="_blank" rel="noopener noreferrer">QRCode.js | github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="什么是e2e-test-除了单元测试外还有什么测试"><a href="#什么是e2e-test-除了单元测试外还有什么测试" class="header-anchor">#</a> 什么是e2e test，除了单元测试外还有什么测试？</h3> <p>e2e 是 end to end 的缩写，翻译为端到端测试。单元测试只是整个测试金字塔中的一部分。其他类型的测试还包括 e2e(端到端)测试，快照比对测试等。</p> <ol><li><p>单元测试：最小巧、最简单、最有用的测试。它们通过隔离单个组件的每一个部分，来在最小工作单元上进行断言。能帮助开发者思考如何设计一个组件或重构一个现有组。通常每次代码发生变化的时候它们都会被运行。</p></li> <li><p>快照比对测试：会保存你的 Vue 组件的标记，然后比较每次新生成的测试运行结果。如果有些东西改变了，开发者就会得到通知，并决定这个改变是刻意为之 (组件更新时) 还是意外发生的 (组件行为不正确)。</p></li> <li><p>e2e(端到端)测试致力于确保组件的一系列交互是正确的。它们是更高级别的测试，例如可能会测试用户是否注册、登录以及更新他们的用户名。这种测试运行起来会比单元测试和快照比对测试慢一些。运行起来会更慢很多。这些测试通常只在部署前运行，来确保系统的每个部分都能够正常的协同工作。</p></li></ol> <p>更多测试 Vue 组件细节，可以参考 Edd Yerburgh 的书《Testing Vue.js Applications》，中文翻译版为《Vue.js应用测试》</p> <p>参考：<a href="https://cn.vuejs.org/v2/cookbook/unit-testing-vue-components.html#%E9%A2%9D%E5%A4%96%E7%9A%84%E4%B8%8A%E4%B8%8B%E6%96%87" target="_blank" rel="noopener noreferrer">额外的上下文 - Vue 组件的单元测试<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="vue单元测试"><a href="#vue单元测试" class="header-anchor">#</a> vue单元测试</h3> <p>在 Vue.js 官网 学习 =&gt; CookBook 下有一个 <code>Vue 组件的单元测试</code> 文档。</p> <p>为什么要测试？组件的单元测试的好处:</p> <ul><li>提供描述组件行为的文档</li> <li>节省手动测试的时间</li> <li>减少研发新特性时产生的 bug</li> <li>改进设计</li> <li>促进重构</li> <li>自动化测试使得大团队中的开发者可以维护复杂的基础代码</li></ul> <p>Vue Test Utils 是 Vue 组件单元测试的官方库。推荐使用 Jest 或 mocha-webpack</p> <p>相关参考文档</p> <ul><li><a href="https://cn.vuejs.org/v2/cookbook/unit-testing-vue-components.html" target="_blank" rel="noopener noreferrer">Vue 组件的单元测试 | Vue.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://vue-test-utils.vuejs.org/zh/" target="_blank" rel="noopener noreferrer">Vue Test Utils | 文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/vuejs/vue-test-utils" target="_blank" rel="noopener noreferrer">Vue Test Utils | Github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.im/post/6865477717220851720#heading-15" target="_blank" rel="noopener noreferrer">学习Vue应用测试，让你的项目更加健壮和稳定 Jest | 掘金<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="涉及到状态code相关判断逻辑-建议使用常量"><a href="#涉及到状态code相关判断逻辑-建议使用常量" class="header-anchor">#</a> 涉及到状态code相关判断逻辑，建议使用常量</h3> <p>对于一些状态较多的场景，当我们需要进行一些逻辑时，如果我们用状态的code来写判断逻辑。当后端提供的这个状态文案、code变更或调整，改动可能会很麻烦，特别是功能较多时。</p> <p><strong>对于状态相关的判断逻辑，尽量把状态定义为容易识别的常量。这样状态名或状态code变更后，就不需要做大量修改了。</strong></p> <p>来看一个实例，假设项目的状态有几种：待审核 0 、待跟进 1、已立项 2、落地成功 3、落地失败 4、 关闭 5 ，有些组件只有待审核可以看到，有些功能只有已立项才能看到</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">PROJ_STATUS</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">PENDING_AUDIT</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token constant">PENDING_FOLLOW</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token constant">ALREADY_SET_UP</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token constant">LAND_SUCCESS</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
  <span class="token constant">LAND_FAILURE</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token constant">CLOSE</span><span class="token operator">:</span> <span class="token number">5</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token constant">PROJ_LABEL_MAP</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">PROJ_STATUS</span><span class="token punctuation">.</span><span class="token constant">PENDING_AUDIT</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'待审核'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token constant">PROJ_STATUS</span><span class="token punctuation">.</span><span class="token constant">PENDING_FOLLOW</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'待跟进'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token constant">PROJ_STATUS</span><span class="token punctuation">.</span><span class="token constant">ALREADY_SET_UP</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'已立项'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token constant">PROJ_STATUS</span><span class="token punctuation">.</span><span class="token constant">LAND_SUCCESS</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'落地成功'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token constant">PROJ_STATUS</span><span class="token punctuation">.</span><span class="token constant">LAND_FAILURE</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'落地失败'</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token constant">PROJ_STATUS</span><span class="token punctuation">.</span><span class="token constant">CLOSE</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'关闭'</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>status <span class="token operator">===</span> <span class="token constant">PROJ_STATUS</span><span class="token punctuation">.</span><span class="token constant">PENDING_AUDIT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// xxx</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token constant">PROJ_STATUS</span><span class="token punctuation">.</span><span class="token constant">LAND_SUCCESS</span><span class="token punctuation">,</span><span class="token constant">PROJ_STATUS</span><span class="token punctuation">.</span><span class="token constant">LAND_FAILURE</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>status<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// xxx</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这样虽然看起来麻烦一点，但不管你状态文案、code怎么变，前端的改动都会很小。项目越大，变动后维护的成本相对会越低</p> <h2 id="_2020-09-21-周一"><a href="#_2020-09-21-周一" class="header-anchor">#</a> 2020/09/21 周一</h2> <h3 id="mac下怎么截取屏幕gif图-gifox"><a href="#mac下怎么截取屏幕gif图-gifox" class="header-anchor">#</a> mac下怎么截取屏幕gif图：Gifox</h3> <p>最开始做gif图是使用QuickTime录制屏幕后，再搜索在线视频转gif图的网站进行转换，比较麻烦。</p> <p><img src="/images/daily/Gifox_logo.png" alt="Gifox_logo.png"></p> <p>最近发现一个比较好的软件 <a href="https://gifox.io/" target="_blank" rel="noopener noreferrer">Gifox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，我使用的是免费版的，有水印，最大长度限制为10s。升级付费的版本可以去水印(watermark)，且没有10s限制。它功能强大，录制gif很方便</p> <p><img src="/images/daily/Gifox_opt.png" alt="Gifox_opt.png"></p> <ol><li>shift + command + 6 即可录制选中区域进行录制。</li> <li>录制完成后，可以像剪辑视频一样剪辑gif图，操作简单</li> <li>导出时，可以调整参数，压缩文件大小</li> <li>可以直接把QuickTime录制的视频转为gif，并可以剪辑</li></ol> <p><img src="/images/daily/Gifox_edit.png" alt="Gifox_edit.png"></p> <h3 id="不全局安装npm包-怎么在项目中执行对应的命令"><a href="#不全局安装npm包-怎么在项目中执行对应的命令" class="header-anchor">#</a> 不全局安装npm包，怎么在项目中执行对应的命令</h3> <p>一般在vue开发中，vue命令可以执行，是因为全局安装了 <code>@vue/cli</code> npm包，那假设你无法使用 npm install -g 全局安装，那怎么在当前项目所在的目录运行命令呢？这里我们使用 zuo-util 这么npm包来介绍3种在项目种运行npm包命令的方法</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 随便创建一个文件夹，并使用terminal进入到该目录，执行 npm init 创建 package.json</span>
<span class="token function">npm</span> init
<span class="token comment"># 输入项目名，英文，这里用 npm_cmd_test，其他全部默认回车</span>
<span class="token comment"># 运行 zuo 这个命令</span>
zuo
<span class="token comment"># 找不到这个命令，说明全局没有安装 zsh: command not found: zuo</span>
</code></pre></div><p>我们再局部安装下</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 项目里局部安装 zuo-util，非全局安装</span>
<span class="token function">npm</span> <span class="token function">install</span> zuo-util --save
<span class="token comment"># 再运行 zuo，还是不行</span>
zuo
</code></pre></div><p><img src="/images/daily/npm_zuo_1.png" alt="npm_zuo_1.png"></p> <p>我们可以使用下面三种方法来运行局部安装的npm包对应的命令</p> <h4 id="npx-命令"><a href="#npx-命令" class="header-anchor">#</a> npx 命令</h4> <p>可以使用npx 命令名，执行项目中的，非全局的命令</p> <div class="language-bash extra-class"><pre class="language-bash"><code>npx zuo
</code></pre></div><h4 id="node-modules-bin-命令"><a href="#node-modules-bin-命令" class="header-anchor">#</a> ./node_modules/.bin/命令</h4> <p>一般局部安装的命令都会放到 <code>./node_modules/.bin/</code> 目录下，可以通过 . 语法直接运行</p> <div class="language-bash extra-class"><pre class="language-bash"><code>./node_modules/.bin/zuo
</code></pre></div><p><img src="/images/daily/npm_zuo_2.png" alt="npm_zuo_2.png"></p> <h4 id="npm-run-xxx"><a href="#npm-run-xxx" class="header-anchor">#</a> npm run xxx</h4> <p>在 package.json 里的 scripts 里面，我们可以设置运行的命令</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// package.json</span>
  <span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;zuo&quot;</span><span class="token operator">:</span> <span class="token string">&quot;zuo&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>按照上面的代码设置后，npm run zuo 即可执行当前目录下的zuo命令</p> <p><img src="/images/daily/npm_zuo_3.png" alt="npm_zuo_3.png"></p> <h2 id="_2020-09-13-周日"><a href="#_2020-09-13-周日" class="header-anchor">#</a> 2020/09/13 周日</h2> <h3 id="keep-alive只在跳转到b组件页面时缓存当前路由数据-跳到其他页面不缓存路由数据"><a href="#keep-alive只在跳转到b组件页面时缓存当前路由数据-跳到其他页面不缓存路由数据" class="header-anchor">#</a> keep-alive只在跳转到B组件页面时缓存当前路由数据，跳到其他页面不缓存路由数据</h3> <p>一般情况下，我们可以使用路由meta参数里传keepAlive为true或false来对某个路由页面做缓存</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$route.meta.keepAlive<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!$route.meta.keepAlive<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>假设有A、B、C三个页面组件。B页面只有跳到C页面才缓存数据，跳到其他页面不缓存页面数据</p> <p>这里 router-view 组件会切换三个组件的显示类似与component is切换组件。我们需要动态的去判断是否缓存B页面组件，可以使用keep-alive的include参数来指定需要缓存的页面组件数据</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 逗号分隔字符串 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span> <span class="token attr-name">include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>a,b<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">:is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>view<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>component</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>假设B页面组件的name为 'PageB'，那么默认情况下include为'PageB'，就表示缓存该页面，如果设置include为''就是不缓存页面数据，核心问题是怎么动态的改变这个include的值。</p> <p>我们可以在B页面组件路由离开之前的钩子函数里，来修改这个值，<strong>注意，需要单独弄一个变量，使用$route.meta.include参数来修改这个值是没有用的，因为$route.meta这个值并不像data里面的数据是双向绑定的，他在进入页面时就固定了。中间修这个值不会触发template里面的模板重新渲染</strong></p> <p>来看看具体实例</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- index.vue 入口页面 http://localhost:8081/keepAlive/ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    我是主页面
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/keepAlive/a<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>A组件页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/keepAlive/b<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>B组件页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/keepAlive/c<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>C组件页面<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
    include{{ include }}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span> <span class="token attr-name">:include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>include<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$route.meta.keepAlive<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!$route.meta.keepAlive<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 测试 $route.meta 的值是否是双向绑定的 --&gt;</span>
    $route.meta.include {{$route.meta.include}}
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      include<span class="token operator">:</span> <span class="token string">&quot;PageB&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 这里修改值后数据，页面的$route.meta.include值并没有刷新，因此不能为了节省变量使用$route.meta来做include的控制</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>include <span class="token operator">=</span> <span class="token string">&quot;test&quot;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'this.$route.meta.include'</span><span class="token punctuation">,</span> <span class="token string">'test'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>/keepAlive/a、/keepAlive/c只是单独的页面，没有任何逻辑，只是用来测试跳转。主要逻辑是在/keepAlive/b页面</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    我是B组件页面
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>input<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入B组件内容<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-radio-group</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>radio<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-radio</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>备选项<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-radio</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-radio</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>备选项<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-radio</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-radio</span> <span class="token attr-name">:label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>9<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>备选项<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-radio</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-radio-group</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;PageB&quot;</span><span class="token punctuation">,</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      input<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
      radio<span class="token operator">:</span> <span class="token string">&quot;&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">beforeRouteLeave</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> <span class="token keyword">from</span><span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">&quot;keepAliveC&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果跳转的页面C组件，缓存页面数据</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span>include <span class="token operator">=</span> <span class="token string">&quot;PageB&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 如果跳转的页面不是C组件，不缓存数据</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>$parent<span class="token punctuation">.</span>include <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>以上就可以实现我们的目的了，完整demo参见 <a href="https://github.com/zuoxiaobai/fedemo/tree/master/src/vuecli-demo/src/views/keepAlive" target="_blank" rel="noopener noreferrer">keepalive测试demo｜ github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>参考：</p> <ul><li><a href="https://cn.vuejs.org/v2/api/#keep-alive" target="_blank" rel="noopener noreferrer">keep-alive | Vue.js API<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/agonie201218/article/details/82151457" target="_blank" rel="noopener noreferrer">keep-alive的深入理解与使用(配合router-view缓存整个路由页面)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="子组件名称与父组件name相同时死循环的问题"><a href="#子组件名称与父组件name相同时死循环的问题" class="header-anchor">#</a> 子组件名称与父组件name相同时死循环的问题</h3> <p>在vue项目中，假设父组件name与子组件名称一致，会造成死循环，出现 <code>Error in nextTick: &quot;RangeError: Maximum call stack size exceeded&quot;</code>的错误，template在编译时，不会去找components引入的组件，而是直接引入自己，形成一个递归组件。要特别注意</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>我是index组件<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>test<span class="token operator">-</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>test<span class="token operator">-</span>a<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>

<span class="token operator">&lt;</span>script<span class="token operator">&gt;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">TestA</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./TestA&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// name: &quot;testA&quot;,</span>
  name<span class="token operator">:</span> <span class="token string">&quot;TestA&quot;</span><span class="token punctuation">,</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;index comp created&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><p><img src="/images/daily/subcomp_samename.png" alt="subcomp_samename.png"></p> <p>完成demo地址，参考 <a href="https://github.com/zuoxiaobai/fedemo/tree/master/src/vuecli-demo/src/views/subcomp_samename" target="_blank" rel="noopener noreferrer">subcomp_samename demo| github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="eslintignore在不同vscode版本中的差异"><a href="#eslintignore在不同vscode版本中的差异" class="header-anchor">#</a> .eslintignore在不同vscode版本中的差异</h3> <p>.eslintignore文件的作用是，当不想对项目的某个目录进行eslint检查时，可以在这个文件中声明，类似.gitignore文件的效果。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// .eslintignore</span>
mock
</code></pre></div><p>上面表示忽略mock文件夹下的代码检查。这样eslint插件就不会显示warning、不会保存后自动fix该文件。在这个文件中去掉mock后，mock下的文件就又可以保存后fix了。</p> <p>但有一个问题，不同vscode版本的行为可能有差异，有可能把目录加入到了.eslintignore后，保存时还是会fix这个目录下的eslint错误。建议升级到最新版本。</p> <h3 id="父组件加载子组件时-父子组件钩子顺序"><a href="#父组件加载子组件时-父子组件钩子顺序" class="header-anchor">#</a> 父组件加载子组件时，父子组件钩子顺序</h3> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- index.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>comp-a</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>comp-a</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>在 index.vue 以及 compA.vue 子组件里面都加了对应的钩子函数console，具体顺序如下，<strong>父组件mounted好后，才会create子组件</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>index beforeCreate
index<span class="token punctuation">.</span>vue index created
index<span class="token punctuation">.</span>vue index beforeMount
index<span class="token punctuation">.</span>vue index mounted
index<span class="token punctuation">.</span>vue index beforeUpdate
<span class="token constant">A</span><span class="token punctuation">.</span>vue <span class="token constant">A</span> beforeCreate
<span class="token constant">A</span><span class="token punctuation">.</span>vue <span class="token constant">A</span> created
<span class="token constant">A</span><span class="token punctuation">.</span>vue <span class="token constant">A</span> beforeMount
<span class="token constant">A</span><span class="token punctuation">.</span>vue <span class="token constant">A</span> mounted
index<span class="token punctuation">.</span>vue index updated
</code></pre></div><p>如下图，完整demo参见 <a href="https://github.com/zuoxiaobai/fedemo/tree/master/src/vuecli-demo/src/views/vuehooks" target="_blank" rel="noopener noreferrer">父子组件钩子函数demo ｜ github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><img src="/images/daily/sub_comp_hooks.png" alt="sub_comp_hooks.png"></p> <h3 id="vue组件的封装性与可操作性-ref拿不到子组件实例以及vuex增加代码复杂度问题"><a href="#vue组件的封装性与可操作性-ref拿不到子组件实例以及vuex增加代码复杂度问题" class="header-anchor">#</a> vue组件的封装性与可操作性：ref拿不到子组件实例以及vuex增加代码复杂度问题</h3> <p>一般在封装vue组件时，怎么把组件封装的更好，更容易维护理解是值得思考的问题</p> <p>来看一个实际场景：一个组件里有高级查询和列表，他们东西都比较多，需要拆分成两个子组件</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- index.vue --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project-search</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project-search</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project-list</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project-list</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>查询的条件参数比较多，假设表单数据变量为 searchForm。</p> <p>按照封装的完整性原则，自己的组件的数据放到自己的组件中，那么 searchForm 就需要放到 project-search 组件里。</p> <p>但在index.vue中，我们需要查询列表，依赖searchForm的值，涉及到父组件取子组件的值的问题，一般有四种方法可以选择</p> <ul><li>searchForm变量放到父组件，通过props传递到子组件（这样有点违背组件的封装性）</li> <li>vuex 个人认为，能不使用vuex的场景，尽量不要使用，除非真的需要使用，他会影响代码的简单性。</li> <li>bus 使用 bus 来通信，但和vuex类似，尽量少使用</li> <li>使用ref直接取。但由于副组件加载子组件时，在mounted钩子里 ref 拿对应的子组件可能会拿不到，需要加 setTiemout，也是一种比较怪的操作</li></ul> <p>对比这几种情况。我一般使用props，把值直接放到index.vue里，再传递给子组件。这样算是比较好理解的一种方法，虽然封装性不强。但涉及到数据需要交互的场景，必须要做一些妥协。</p> <h2 id="_2020-09-12-周六"><a href="#_2020-09-12-周六" class="header-anchor">#</a> 2020/09/12 周六</h2> <h3 id="npm-install-g或者npm-link需要sudo的问题"><a href="#npm-install-g或者npm-link需要sudo的问题" class="header-anchor">#</a> npm install -g或者npm link需要sudo的问题</h3> <p>在mac下，安装node后，会出现两个命令 npm 和 node，再使用 npm install -g 时，默认需要管理员权限，可以再前面加 sudo 以管理源方式运行即可。</p> <p>如果在开发 npm 包的时候。如果开发对应的命令程序，测试时需要在当前目录执行 npm link，这里也需要加 sudo。</p> <h3 id="git-status中文乱码怎么解决"><a href="#git-status中文乱码怎么解决" class="header-anchor">#</a> git status中文乱码怎么解决</h3> <p>git status时，如果中问乱码，可以对git进行一个配置即可 <code>git config --global core.quotepath false</code></p> <p>具体效果如下图</p> <p><img src="/images/daily/git_chinese_show.png" alt="git_chinese_show.png"></p> <h3 id="mac安装brew下载慢-安装异常-切换成ruby-china源"><a href="#mac安装brew下载慢-安装异常-切换成ruby-china源" class="header-anchor">#</a> mac安装brew下载慢，安装异常，切换成ruby-china源</h3> <p>mac下使用brew可以很方便的安装svn、nginx等常用的工具。</p> <p>什么是brew [bruː]，它的全称是 <a href="https://brew.sh/" target="_blank" rel="noopener noreferrer">Homebrew<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，The Missing Package Manager for macOS (or Linux)。它可以安装macOS或linux下没有的包(Package)。</p> <p>一般使用ruby来安装</p> <div class="language-bash extra-class"><pre class="language-bash"><code>ruby -e <span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install<span class="token variable">)</span></span>&quot;</span>
</code></pre></div><p>mac自带ruby，但如果直接安装，他会比较慢，直接卡死，安装不上。</p> <p><img src="/images/daily/ruby_brew_1.png" alt="ruby_brew_1.png"></p> <p>这就需要使用国内的 ruby 源了。类似与npm与cnpm的概念，这里使用ruby-china的源，具体参考：<a href="https://gems.ruby-china.com/" target="_blank" rel="noopener noreferrer">RubyGems - Ruby China<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 设置ruby源</span>
gem sources --add https://gems.ruby-china.com/ --remove https://rubygems.org/
<span class="token comment"># 查看ruby源</span>
gem sources -l
</code></pre></div><p><img src="/images/daily/ruby_brew_2.png" alt="ruby_brew_2.png"></p> <p><strong>这样，再重新运行安装brew的命令就可以安装成功了，虽然也慢，但至少可以安装成功。安装包就快了。</strong></p> <p>参考：</p> <ul><li><a href="https://zhuanlan.zhihu.com/p/59805070" target="_blank" rel="noopener noreferrer">Mac必备神器Homebrew<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://ruby-china.org/topics/29250" target="_blank" rel="noopener noreferrer">taobao Gems 源已停止维护，现由 ruby-china 提供镜像服务<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="mac安装svn-svn-error-the-subversion-command-line-tools-are-no-longer-provided-by-xcode"><a href="#mac安装svn-svn-error-the-subversion-command-line-tools-are-no-longer-provided-by-xcode" class="header-anchor">#</a> mac安装svn，svn: error: The subversion command line tools are no longer provided by Xcode.</h3> <p>在新的macos系统中，xcode不再集成svn，需要自己安装。可以使用 <code>brew install svn</code> 进行安装</p> <h3 id="mac安装nginx在官网下载与使用brew下载的区别"><a href="#mac安装nginx在官网下载与使用brew下载的区别" class="header-anchor">#</a> mac安装nginx在官网下载与使用brew下载的区别</h3> <p>nginx官网直接下载的包，mac下可以直接进入该目录使用，但没有加到环境变量，不能在Terminal的任何目录下直接使用。</p> <p><img src="/images/daily/nginx_down.png" alt="nginx_down.png"></p> <p>如果使用 <code>brew install nginx</code> 安装，他会直接都安装好，并修改环境变量。可以使用which nginx来看具体的地址</p> <h2 id="_2020-09-02-周三"><a href="#_2020-09-02-周三" class="header-anchor">#</a> 2020/09/02 周三</h2> <h3 id="guoqzuo-vue-chart实用echarts组件封装"><a href="#guoqzuo-vue-chart实用echarts组件封装" class="header-anchor">#</a> @guoqzuo/vue-chart实用echarts组件封装</h3> <p>vue中使用echarts可以自己封装一个简单的组件。实现每次更新数据只需要修改options的值即可，并自带loading、暂时数据slot。先来看看使用demo</p> <p><img src="/images/daily/z-echart.gif" alt="z-echart.gif"></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// main.js 全局引入</span>
<span class="token keyword">import</span> VueChart <span class="token keyword">from</span> <span class="token string">&quot;@guoqzuo/vue-chart&quot;</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueChart<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>然后在任意组件里可以直接使用 z-echart</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- 固定宽柱状图，不自动resize --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span>300px<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 300px</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>z-chart</span> <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>bar<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:loading</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:autoResize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>z-chart</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 宽高自适应，resize后自动渲染，当hasData为false时显示暂无数据的slot内容--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">=&quot;</span><span class="token attr-value"><span class="token property">width</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span> <span class="token property">height</span><span class="token punctuation">:</span> 50vh</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>z-chart</span> <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pie<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:hasData</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hasData<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    暂无数据
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>z-chart</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>来看看z-chart组件的实现细节，这里把echart单独用一个组件处理，在z-echart组件里引入，并加入loading、无数据的slot显示处理</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- z-chart --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>z-chart-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base-chart</span>
      <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!loading &amp;&amp; hasData<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">:options</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>options<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">v-on</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$listeners<span class="token punctuation">&quot;</span></span>
      <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span>
    <span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>base-chart</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>base-loading</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>loading<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>base-loading</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- no data slot --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>!loading &amp;&amp; !hasData<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>base-chart代码如下，它主要做了三个操作</p> <ul><li>使用options初始化图表</li> <li>如果是百分比大小的图，resize时，自动重绘</li> <li>使用watch监听options改动，如果有改动为了防止渲染异常，直接dispose销毁echart实例，重新加载</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- base chart --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>z-chart<span class="token punctuation">&quot;</span></span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>z-echart<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> echarts <span class="token keyword">from</span> <span class="token string">&quot;echarts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> addListener<span class="token punctuation">,</span> removeListener <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;resize-detector&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> debounce <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;lodash-es&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&quot;BaseChart&quot;</span><span class="token punctuation">,</span>

  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Object<span class="token punctuation">,</span>
      required<span class="token operator">:</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    autoResize<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
      required<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
      <span class="token keyword">default</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 监听 options 改动，改动后重绘数据</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$watch</span><span class="token punctuation">(</span>
      <span class="token string">&quot;options&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> deep<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> chart <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">[</span><span class="token string">&quot;z-echart&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      chart<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>chart <span class="token operator">=</span> chart<span class="token punctuation">;</span>

      <span class="token comment">// 当元素宽高改变时resize执行重绘</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>autoResize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>__resizeHanlder <span class="token operator">=</span> <span class="token function">debounce</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            chart<span class="token punctuation">.</span><span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token number">100</span><span class="token punctuation">,</span>
          <span class="token punctuation">{</span> leading<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">addListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__resizeHanlder<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 销毁实例，防止 柱状图 动态切换到 饼图 时，柱状图部分属性依旧留存的问题</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>chart<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>chart <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>autoResize <span class="token operator">&amp;&amp;</span> <span class="token function">removeListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$el<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__resizeHanlder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    <span class="token comment">// 销毁后重绘，用于options变更后刷新图表</span>
    <span class="token function">refresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span> <span class="token attr-name">scoped</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.z-chart</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li><a href="https://github.com/zuoxiaobai/vue-chart/tree/master/examples/src/views/zchart" target="_blank" rel="noopener noreferrer">完整测试demo地址 | github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/zuoxiaobai/vue-chart/packages/z-chart/" target="_blank" rel="noopener noreferrer">z-chart组件源码 | github<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>更加高级的封装，可以查看<a href="https://github.com/vueblocks/ve-charts" target="_blank" rel="noopener noreferrer">ve-charts源码<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="_2020-09-01-周二"><a href="#_2020-09-01-周二" class="header-anchor">#</a> 2020/09/01 周二</h2> <h3 id="normalize-css浏览器样式差异抹平"><a href="#normalize-css浏览器样式差异抹平" class="header-anchor">#</a> normalize.css浏览器样式差异抹平</h3> <p><a href="https://github.com/necolas/normalize.css" target="_blank" rel="noopener noreferrer">normalize.css<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> A modern alternative to CSS resets 一个用于CSS重置的现代替代方法</p> <p>主要用于解决不同浏览器默认样式之间的差异</p> <p>What does it do?</p> <ul><li>Preserves useful defaults, unlike many CSS resets. 保留有用的默认样式，重置许多不一样的CSS</li> <li>Normalizes styles for a wide range of elements. 为许多各种各样的元素标准化样式</li> <li>Corrects bugs and common browser inconsistencies. 修正bug和常见的浏览器不一致样式</li> <li>Improves usability with subtle modifications. 通细微的修改提高可用性</li> <li>Explains what code does using detailed comments. 使用详细的注释来解释代码的作用</li></ul> <p>下面来看看 Chrome、Safari、Firefox 三个浏览器之间的差异</p> <p><img src="/images/daily/before_normalize.png" alt="before_normalize.png"></p> <p>使用 normalize.css 后的效果</p> <p><img src="/images/daily/after_normalize.png" alt="after_normalize.png"></p> <p>现有的UI框架也抹平了这些差异</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">10/30/2020, 11:32:56 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/daily/2020-10.html" class="prev">
        2020年10月技术日常
      </a></span> <span class="next"><a href="/daily/2020-08.html">
        2020年08月技术日常
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.1896936c.js" defer></script><script src="/assets/js/2.4b3539f1.js" defer></script><script src="/assets/js/43.b71e8ebe.js" defer></script><script src="/assets/js/3.e6a4dd76.js" defer></script>
  </body>
</html>
